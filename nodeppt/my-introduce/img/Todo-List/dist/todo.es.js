/**
 * @license
 *
 * DHTMLX ToDo v.1.3.1
 *
 * This software is covered by DHTMLX Evaluation License and purposed only for evaluation.
 * Contact sales@dhtmlx.com to get Commercial or Enterprise license.
 * Usage without proper license is prohibited.
 *
 * (c) XB Software.
 */
function t(t,e){const n=["click","contextmenu"],s=n=>{!t||t.contains(n.target)||n.defaultPrevented||e(n)};return n.forEach((t=>document.addEventListener(t,s,!0))),{destroy(){n.forEach((t=>document.removeEventListener(t,s,!0)))}}}function e(t){return t&&"object"==typeof t&&!Array.isArray(t)}function n(t,s){for(const i in s){const o=s[i];e(t[i])&&e(o)?t[i]=n({...t[i]},s[i]):t[i]=s[i]}return t}function s(t){return{getGroup(e){const n=t[e];return t=>n&&n[t]||t},getRaw:()=>t,extend(e,i){if(!e)return this;let o;return o=i?n({...e},t):n({...t},e),s(o)}}}function i(){}function o(t,e){for(const n in e)t[n]=e[n];return t}function r(t){return t()}function a(){return Object.create(null)}function c(t){t.forEach(r)}function l(t){return"function"==typeof t}function d(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function u(t,...e){if(null==t)return i;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function p(t,e,n){t.$$.on_destroy.push(u(e,n))}function h(t,e,n,s){if(t){const i=f(t,e,n,s);return t[0](i)}}function f(t,e,n,s){return t[1]&&s?o(n.ctx.slice(),t[1](s(e))):n.ctx}function m(t,e,n,s){if(t[2]&&s){const i=t[2](s(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let s=0;s<n;s+=1)t[s]=e.dirty[s]|i[s];return t}return e.dirty|i}return e.dirty}function g(t,e,n,s,i,o){if(i){const r=f(e,n,s,o);t.p(r,i)}}function $(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function k(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function y(t,e){const n={};e=new Set(e);for(const s in t)e.has(s)||"$"===s[0]||(n[s]=t[s]);return n}function v(t){return null==t?"":t}function x(t){return t&&l(t.destroy)?t.destroy:i}(new Date).valueOf();const b="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function w(t,e){t.appendChild(e)}function _(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode&&t.parentNode.removeChild(t)}function j(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function T(t){return document.createElement(t)}function C(t){return document.createTextNode(t)}function I(){return C(" ")}function M(){return C("")}function D(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function P(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function E(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function N(t,e){e=""+e,t.data!==e&&(t.data=e)}function A(t,e){t.value=null==e?"":e}function H(t,e,n,s){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}function L(t,e,n){t.classList[n?"add":"remove"](e)}class R{constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){var s;this.e||(this.is_svg?this.e=(s=e.nodeName,document.createElementNS("http://www.w3.org/2000/svg",s)):this.e=T(11===e.nodeType?"TEMPLATE":e.nodeName),this.t="TEMPLATE"!==e.tagName?e:e.content,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from("TEMPLATE"===this.e.nodeName?this.e.content.childNodes:this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)_(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(S)}}function F(t,e){return new t(e)}let O;function z(t){O=t}function q(){if(!O)throw new Error("Function called outside component initialization");return O}function B(t){q().$$.on_mount.push(t)}function Y(t){q().$$.after_update.push(t)}function J(){const t=q();return(e,n,{cancelable:s=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=function(t,e,{bubbles:n=!1,cancelable:s=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,s,e),i}(e,n,{cancelable:s});return i.slice().forEach((e=>{e.call(t,o)})),!o.defaultPrevented}return!0}}function W(t,e){return q().$$.context.set(t,e),e}function G(t){return q().$$.context.get(t)}function V(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const U=[],X=[];let Z=[];const Q=[],K=Promise.resolve();let tt=!1;function et(t){Z.push(t)}function nt(t){Q.push(t)}const st=new Set;let it=0;function ot(){if(0!==it)return;const t=O;do{try{for(;it<U.length;){const t=U[it];it++,z(t),rt(t.$$)}}catch(t){throw U.length=0,it=0,t}for(z(null),U.length=0,it=0;X.length;)X.pop()();for(let t=0;t<Z.length;t+=1){const e=Z[t];st.has(e)||(st.add(e),e())}Z.length=0}while(U.length);for(;Q.length;)Q.pop()();tt=!1,st.clear(),z(t)}function rt(t){if(null!==t.fragment){t.update(),c(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(et)}}const at=new Set;let ct;function lt(){ct={r:0,c:[],p:ct}}function dt(){ct.r||c(ct.c),ct=ct.p}function ut(t,e){t&&t.i&&(at.delete(t),t.i(e))}function pt(t,e,n,s){if(t&&t.o){if(at.has(t))return;at.add(t),ct.c.push((()=>{at.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}else s&&s()}function ht(t,e){t.d(1),e.delete(t.key)}function ft(t,e){pt(t,1,1,(()=>{e.delete(t.key)}))}function mt(t,e,n,s,i,o,r,a,l,d,u,p){let h=t.length,f=o.length,m=h;const g={};for(;m--;)g[t[m].key]=m;const $=[],k=new Map,y=new Map,v=[];for(m=f;m--;){const t=p(i,o,m),a=n(t);let c=r.get(a);c?s&&v.push((()=>c.p(t,e))):(c=d(a,t),c.c()),k.set(a,$[m]=c),a in g&&y.set(a,Math.abs(m-g[a]))}const x=new Set,b=new Set;function w(t){ut(t,1),t.m(a,u),r.set(t.key,t),u=t.first,f--}for(;h&&f;){const e=$[f-1],n=t[h-1],s=e.key,i=n.key;e===n?(u=e.first,h--,f--):k.has(i)?!r.has(s)||x.has(s)?w(e):b.has(i)?h--:y.get(s)>y.get(i)?(b.add(s),w(e)):(x.add(i),h--):(l(n,r),h--)}for(;h--;){const e=t[h];k.has(e.key)||l(e,r)}for(;f;)w($[f-1]);return c(v),$}function gt(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function $t(t){t&&t.c()}function kt(t,e,n,s){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),s||et((()=>{const e=t.$$.on_mount.map(r).filter(l);t.$$.on_destroy?t.$$.on_destroy.push(...e):c(e),t.$$.on_mount=[]})),o.forEach(et)}function yt(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];Z.forEach((s=>-1===t.indexOf(s)?e.push(s):n.push(s))),n.forEach((t=>t())),Z=e}(n.after_update),c(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function vt(t,e){-1===t.$$.dirty[0]&&(U.push(t),tt||(tt=!0,K.then(ot)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function xt(t,e,n,s,o,r,l,d=[-1]){const u=O;z(t);const p=t.$$={fragment:null,ctx:[],props:r,update:i,not_equal:o,bound:a(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:a(),dirty:d,skip_bound:!1,root:e.target||u.$$.root};l&&l(p.root);let h=!1;if(p.ctx=n?n(t,e.props||{},((e,n,...s)=>{const i=s.length?s[0]:n;return p.ctx&&o(p.ctx[e],p.ctx[e]=i)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](i),h&&vt(t,e)),n})):[],p.update(),h=!0,c(p.before_update),p.fragment=!!s&&s(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(S)}else p.fragment&&p.fragment.c();e.intro&&ut(t.$$.fragment),kt(t,e.target,e.anchor,e.customElement),ot()}z(u)}class bt{$destroy(){yt(this,1),this.$destroy=i}$on(t,e){if(!l(e))return i;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function wt(t,e="data-id"){let n=t;for(!n.tagName&&t.target&&(n=t.target);n;){if(n.getAttribute){if(n.getAttribute(e))return n}n=n.parentNode}return null}function _t(t){if("string"==typeof t){const e=1*t;if(!isNaN(e))return e}return t}function St(t,e){let n=null;t.addEventListener("click",(function(t){const s=wt(t);if(!s)return;const i=_t(s.dataset.id);let o,r=t.target;for(;r!=s;){if(o=r.dataset?r.dataset.action:null,o){e[o]&&e[o](i,t),n=(new Date).valueOf();break}r=r.parentNode}e.click&&!o&&e.click(i,t)})),t.addEventListener("dblclick",(function(t){if(n&&(new Date).valueOf()-n<200)return;const s=function(t,e="data-id"){const n=wt(t,e);return n?_t(n.getAttribute(e)):null}(t);s&&e.dblclick&&e.dblclick(s,t)}))}function jt(t){return t&&"object"==typeof t&&!Array.isArray(t)}function Tt(t,e){for(const n in e){const s=e[n];jt(t[n])&&jt(s)?t[n]=Tt({...t[n]},e[n]):t[n]=e[n]}return t}function Ct(t){return{getGroup(e){const n=t[e];return t=>n&&n[t]||t},getRaw:()=>t,extend(e,n){if(!e)return this;let s;return s=n?Tt({...e},t):Tt({...t},e),Ct(s)}}}(new Date).valueOf();const{document:It}=b;function Mt(t){let e,n,s,i,o,r;const a=t[8].default,c=h(a,t,t[7],null);return{c(){e=I(),n=T("div"),c&&c.c(),E(n,"class",s=`dropdown ${t[0]}-${t[1]} svelte-1iqv09v`),H(n,"width",t[2])},m(s,a){_(s,e,a),_(s,n,a),c&&c.m(n,null),t[9](n),i=!0,o||(r=D(It.body,"click",t[4]),o=!0)},p(t,[e]){c&&c.p&&(!i||128&e)&&g(c,a,t,t[7],i?m(a,t[7],e,null):$(t[7]),null),(!i||3&e&&s!==(s=`dropdown ${t[0]}-${t[1]} svelte-1iqv09v`))&&E(n,"class",s),(!i||4&e)&&H(n,"width",t[2])},i(t){i||(ut(c,t),i=!0)},o(t){pt(c,t),i=!1},d(s){s&&S(e),s&&S(n),c&&c.d(s),t[9](null),o=!1,r()}}}function Dt(t,e,n){let s,{$$slots:i={},$$scope:o}=e,{position:r="bottom"}=e,{align:a="start"}=e,{autoFit:c=!0}=e,{cancel:l=null}=e,{width:d="100%"}=e;Y((()=>{if(c){const t=s.getBoundingClientRect(),e=document.body.getBoundingClientRect();return t.right>=e.right&&n(1,a="end"),t.bottom>=e.bottom&&n(0,r="top"),`${r}-${a}`}}));const u=new Date;return t.$$set=t=>{"position"in t&&n(0,r=t.position),"align"in t&&n(1,a=t.align),"autoFit"in t&&n(5,c=t.autoFit),"cancel"in t&&n(6,l=t.cancel),"width"in t&&n(2,d=t.width),"$$scope"in t&&n(7,o=t.$$scope)},[r,a,d,s,function(t){new Date-u<200||s.contains(t.target)||l&&l(t)},c,l,o,i,function(t){X[t?"unshift":"push"]((()=>{s=t,n(3,s)}))}]}class Pt extends bt{constructor(t){super(),xt(this,t,Dt,Mt,d,{position:0,align:1,autoFit:5,cancel:6,width:2})}}function Et(t){let e;return{c(){e=T("span"),E(e,"class","spacer svelte-sd1wqc")},m(t,n){_(t,e,n)},p:i,d(t){t&&S(e)}}}function Nt(t){let e,n,s;return{c(){e=T("i"),E(e,"class","pager wxi-angle-left svelte-sd1wqc")},m(i,o){_(i,e,o),n||(s=D(e,"click",t[8]),n=!0)},p:i,d(t){t&&S(e),n=!1,s()}}}function At(t){let e;return{c(){e=T("span"),E(e,"class","spacer svelte-sd1wqc")},m(t,n){_(t,e,n)},p:i,d(t){t&&S(e)}}}function Ht(t){let e,n,s;return{c(){e=T("i"),E(e,"class","pager wxi-angle-right svelte-sd1wqc")},m(i,o){_(i,e,o),n||(s=D(e,"click",t[9]),n=!0)},p:i,d(t){t&&S(e),n=!1,s()}}}function Lt(t){let e,n,s,o,r,a,c;function l(t,e){return"right"!=t[1]?Nt:Et}let d=l(t),u=d(t);function p(t,e){return"left"!=t[1]?Ht:At}let h=p(t),f=h(t);return{c(){e=T("div"),u.c(),n=I(),s=T("span"),o=C(t[2]),r=I(),f.c(),E(s,"class","label svelte-sd1wqc"),E(e,"class","header svelte-sd1wqc")},m(i,l){_(i,e,l),u.m(e,null),w(e,n),w(e,s),w(s,o),w(e,r),f.m(e,null),a||(c=D(s,"click",t[4]),a=!0)},p(t,[s]){d===(d=l(t))&&u?u.p(t,s):(u.d(1),u=d(t),u&&(u.c(),u.m(e,n))),4&s&&N(o,t[2]),h===(h=p(t))&&f?f.p(t,s):(f.d(1),f=h(t),f&&(f.c(),f.m(e,null)))},i:i,o:i,d(t){t&&S(e),u.d(),f.d(),a=!1,c()}}}function Rt(t,e,n){const s=J(),i=G("wx-i18n").getRaw().calendar.monthFull;let o,r,a,{date:c}=e,{type:l}=e,{part:d}=e;return t.$$set=t=>{"date"in t&&n(5,c=t.date),"type"in t&&n(0,l=t.type),"part"in t&&n(1,d=t.part)},t.$$.update=()=>{if(225&t.$$.dirty)switch(n(6,o=c.getMonth()),n(7,r=c.getFullYear()),l){case"month":n(2,a=`${i[o]} ${r}`);break;case"year":n(2,a=r);break;case"duodecade":{const t=r-r%10;n(2,a=`${t} - ${t+9}`);break}}},[l,d,a,s,function(){s("shift",{diff:0,type:l})},c,o,r,()=>s("shift",{diff:-1,type:l}),()=>s("shift",{diff:1,type:l})]}class Ft extends bt{constructor(t){super(),xt(this,t,Rt,Lt,d,{date:5,type:0,part:1})}}function Ot(t){let e,n,s,i;const o=t[2].default,r=h(o,t,t[1],null);return{c(){e=T("button"),r&&r.c(),E(e,"class","svelte-1tj7yhm")},m(o,a){_(o,e,a),r&&r.m(e,null),n=!0,s||(i=D(e,"click",(function(){l(t[0])&&t[0].apply(this,arguments)})),s=!0)},p(e,[s]){t=e,r&&r.p&&(!n||2&s)&&g(r,o,t,t[1],n?m(o,t[1],s,null):$(t[1]),null)},i(t){n||(ut(r,t),n=!0)},o(t){pt(r,t),n=!1},d(t){t&&S(e),r&&r.d(t),s=!1,i()}}}function zt(t,e,n){let{$$slots:s={},$$scope:i}=e,{click:o}=e;return t.$$set=t=>{"click"in t&&n(0,o=t.click),"$$scope"in t&&n(1,i=t.$$scope)},[o,i,s]}class qt extends bt{constructor(t){super(),xt(this,t,zt,Ot,d,{click:0})}}function Bt(t,e,n){const s=t.slice();return s[17]=e[n],s}function Yt(t,e,n){const s=t.slice();return s[17]=e[n],s}function Jt(t){let e,n,s=t[17]+"";return{c(){e=T("div"),n=C(s),E(e,"class","weekday svelte-1al976d")},m(t,s){_(t,e,s),w(e,n)},p:i,d(t){t&&S(e)}}}function Wt(t,e){let n,s,i,o,r,a=e[17].day+"";return{key:t,first:null,c(){n=T("div"),s=C(a),i=I(),E(n,"class",o="day "+e[17].css+" svelte-1al976d"),E(n,"data-id",r=e[17].date),L(n,"out",!e[17].in),this.first=n},m(t,e){_(t,n,e),w(n,s),w(n,i)},p(t,i){e=t,1&i&&a!==(a=e[17].day+"")&&N(s,a),1&i&&o!==(o="day "+e[17].css+" svelte-1al976d")&&E(n,"class",o),1&i&&r!==(r=e[17].date)&&E(n,"data-id",r),1&i&&L(n,"out",!e[17].in)},d(t){t&&S(n)}}}function Gt(t){let e,n,s,o,r,a,c=[],l=new Map,d=t[1],u=[];for(let e=0;e<d.length;e+=1)u[e]=Jt(Yt(t,d,e));let p=t[0];const h=t=>t[17].date;for(let e=0;e<p.length;e+=1){let n=Bt(t,p,e),s=h(n);l.set(s,c[e]=Wt(s,n))}return{c(){e=T("div"),n=T("div");for(let t=0;t<u.length;t+=1)u[t].c();s=I(),o=T("div");for(let t=0;t<c.length;t+=1)c[t].c();E(n,"class","weekdays svelte-1al976d"),E(o,"class","days svelte-1al976d")},m(i,l){_(i,e,l),w(e,n);for(let t=0;t<u.length;t+=1)u[t]&&u[t].m(n,null);w(e,s),w(e,o);for(let t=0;t<c.length;t+=1)c[t]&&c[t].m(o,null);r||(a=x(St.call(null,o,t[2])),r=!0)},p(t,[e]){if(2&e){let s;for(d=t[1],s=0;s<d.length;s+=1){const i=Yt(t,d,s);u[s]?u[s].p(i,e):(u[s]=Jt(i),u[s].c(),u[s].m(n,null))}for(;s<u.length;s+=1)u[s].d(1);u.length=d.length}1&e&&(p=t[0],c=mt(c,e,h,1,t,p,l,o,ht,Wt,null,Bt))},i:i,o:i,d(t){t&&S(e),j(u,t);for(let t=0;t<c.length;t+=1)c[t].d();r=!1,a()}}}function Vt(t){const e=t.getDay();return 0===e||6===e}function Ut(t,e,n){let{value:s}=e,{current:i}=e,{cancel:o}=e,{select:r}=e,{part:a}=e,{markers:c=null}=e;const l=G("wx-i18n").getRaw().calendar,d=(l.weekStart||7)%7,u=l.dayShort.slice(d).concat(l.dayShort.slice(0,d));let p,h;const f=(t,e,n)=>new Date(t.getFullYear(),t.getMonth()+(e||0),t.getDate()+(n||0));let m="normal"!==a;const g={click:function(t,e){r&&(e.stopPropagation(),r(new Date(new Date(t))));o&&o()}};return t.$$set=t=>{"value"in t&&n(3,s=t.value),"current"in t&&n(4,i=t.current),"cancel"in t&&n(5,o=t.cancel),"select"in t&&n(6,r=t.select),"part"in t&&n(7,a=t.part),"markers"in t&&n(8,c=t.markers)},t.$$.update=()=>{if(921&t.$$.dirty){n(9,h="normal"==a?[s?f(s).valueOf():0]:s?[s.start?f(s.start).valueOf():0,s.end?f(s.end).valueOf():0]:[0,0]);const t=function(){const t=f(i,0,1-i.getDate());return t.setDate(t.getDate()-(t.getDay()-(d-7))%7),t}(),e=function(){const t=f(i,1,-i.getDate());return t.setDate(t.getDate()+(6-t.getDay()+d)%7),t}(),o=i.getMonth();n(0,p=[]);for(let n=t;n<=e;n.setDate(n.getDate()+1)){const t={day:n.getDate(),in:n.getMonth()===o,date:n.valueOf()};let e="";if(e+=t.in?"":" inactive",e+=h.indexOf(t.date)>-1?" selected":"",m){const n=t.date==h[0],s=t.date==h[1];n&&!s?e+=" left":s&&!n&&(e+=" right"),t.date>h[0]&&t.date<h[1]&&(e+=" inrange")}if(e+=Vt(n)?" weekend":"",c){const t=c(n);t&&(e+=" "+t)}p.push({...t,css:e})}}},[p,u,g,s,i,o,r,a,c,h]}function Xt(t,e,n){const s=t.slice();return s[9]=e[n],s[11]=n,s}function Zt(t){let e,n,s,i=t[9]+"";return{c(){e=T("div"),n=C(i),s=I(),E(e,"class","month svelte-zfj0z0"),E(e,"data-id",t[11]),L(e,"current",t[1]===t[11])},m(t,i){_(t,e,i),w(e,n),w(e,s)},p(t,n){2&n&&L(e,"current",t[1]===t[11])},d(t){t&&S(e)}}}function Qt(t){let e,n=t[2].done+"";return{c(){e=C(n)},m(t,n){_(t,e,n)},p:i,d(t){t&&S(e)}}}function Kt(t){let e,n,s,i,o,r,a,c=t[3],l=[];for(let e=0;e<c.length;e+=1)l[e]=Zt(Xt(t,c,e));return i=new qt({props:{click:t[0],$$slots:{default:[Qt]},$$scope:{ctx:t}}}),{c(){e=T("div");for(let t=0;t<l.length;t+=1)l[t].c();n=I(),s=T("div"),$t(i.$$.fragment),E(e,"class","months svelte-zfj0z0"),E(s,"class","buttons svelte-zfj0z0")},m(c,d){_(c,e,d);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(e,null);_(c,n,d),_(c,s,d),kt(i,s,null),o=!0,r||(a=x(St.call(null,e,t[4])),r=!0)},p(t,[n]){if(10&n){let s;for(c=t[3],s=0;s<c.length;s+=1){const i=Xt(t,c,s);l[s]?l[s].p(i,n):(l[s]=Zt(i),l[s].c(),l[s].m(e,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=c.length}const s={};1&n&&(s.click=t[0]),4096&n&&(s.$$scope={dirty:n,ctx:t}),i.$set(s)},i(t){o||(ut(i.$$.fragment,t),o=!0)},o(t){pt(i.$$.fragment,t),o=!1},d(t){t&&S(e),j(l,t),t&&S(n),t&&S(s),yt(i),r=!1,a()}}}function te(t,e,n){let{value:s}=e,{current:i}=e,{cancel:o}=e,{part:r}=e;const a=G("wx-i18n").getRaw().calendar,c=a.monthShort;let l;const d={click:function(t){(t||0===t)&&(i.setMonth(t),n(6,i));"normal"===r&&n(5,s=new Date(i));o()}};return t.$$set=t=>{"value"in t&&n(5,s=t.value),"current"in t&&n(6,i=t.current),"cancel"in t&&n(0,o=t.cancel),"part"in t&&n(7,r=t.part)},t.$$.update=()=>{224&t.$$.dirty&&("normal"!==r&&s?"left"===r&&s.start?n(1,l=s.start.getMonth()):"right"===r&&s.end?n(1,l=s.end.getMonth()):n(1,l=i.getMonth()):n(1,l=i.getMonth()))},[o,l,a,c,d,s,i,r]}function ee(t,e,n){const s=t.slice();return s[9]=e[n],s[11]=n,s}function ne(t){let e,n,s,i,o=t[9]+"";return{c(){e=T("div"),n=C(o),s=I(),E(e,"class","year svelte-ia304r"),E(e,"data-id",i=t[9]),L(e,"current",t[2]==t[9]),L(e,"prev-decade",0===t[11]),L(e,"next-decade",11===t[11])},m(t,i){_(t,e,i),w(e,n),w(e,s)},p(t,s){2&s&&o!==(o=t[9]+"")&&N(n,o),2&s&&i!==(i=t[9])&&E(e,"data-id",i),6&s&&L(e,"current",t[2]==t[9])},d(t){t&&S(e)}}}function se(t){let e,n=t[3].done+"";return{c(){e=C(n)},m(t,n){_(t,e,n)},p:i,d(t){t&&S(e)}}}function ie(t){let e,n,s,i,o,r,a,c=t[1],l=[];for(let e=0;e<c.length;e+=1)l[e]=ne(ee(t,c,e));return i=new qt({props:{click:t[0],$$slots:{default:[se]},$$scope:{ctx:t}}}),{c(){e=T("div");for(let t=0;t<l.length;t+=1)l[t].c();n=I(),s=T("div"),$t(i.$$.fragment),E(e,"class","years svelte-ia304r"),E(s,"class","buttons svelte-ia304r")},m(c,d){_(c,e,d);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(e,null);_(c,n,d),_(c,s,d),kt(i,s,null),o=!0,r||(a=x(St.call(null,e,t[4])),r=!0)},p(t,[n]){if(6&n){let s;for(c=t[1],s=0;s<c.length;s+=1){const i=ee(t,c,s);l[s]?l[s].p(i,n):(l[s]=ne(i),l[s].c(),l[s].m(e,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=c.length}const s={};1&n&&(s.click=t[0]),4096&n&&(s.$$scope={dirty:n,ctx:t}),i.$set(s)},i(t){o||(ut(i.$$.fragment,t),o=!0)},o(t){pt(i.$$.fragment,t),o=!1},d(t){t&&S(e),j(l,t),t&&S(n),t&&S(s),yt(i),r=!1,a()}}}function oe(t,e,n){const s=G("wx-i18n").getRaw().calendar;let i,o,{value:r}=e,{current:a}=e,{cancel:c}=e,{part:l}=e;const d={click:function(t){t&&(a.setFullYear(t),n(5,a));"normal"===l&&n(6,r=new Date(a));c()}};return t.$$set=t=>{"value"in t&&n(6,r=t.value),"current"in t&&n(5,a=t.current),"cancel"in t&&n(0,c=t.cancel),"part"in t&&n(7,l=t.part)},t.$$.update=()=>{if(38&t.$$.dirty){n(2,o=a.getFullYear());const t=o-o%10-1,e=t+12;n(1,i=[]);for(let n=t;n<e;++n)i.push(n)}},[c,i,o,s,d,a,r,l]}const re={month:{component:class extends bt{constructor(t){super(),xt(this,t,Ut,Gt,d,{value:3,current:4,cancel:5,select:6,part:7,markers:8})}},next:function(t){return(t=new Date(t)).setMonth(t.getMonth()+1),t},prev:function(t){let e=new Date(t);e.setMonth(t.getMonth()-1);for(;t.getMonth()===e.getMonth();)e.setDate(e.getDate()-1);return e}},year:{component:class extends bt{constructor(t){super(),xt(this,t,te,Kt,d,{value:5,current:6,cancel:0,part:7})}},next:function(t){return(t=new Date(t)).setFullYear(t.getFullYear()+1),t},prev:function(t){return(t=new Date(t)).setFullYear(t.getFullYear()-1),t}},duodecade:{component:class extends bt{constructor(t){super(),xt(this,t,oe,ie,d,{value:6,current:5,cancel:0,part:7})}},next:function(t){return(t=new Date(t)).setFullYear(t.getFullYear()+10),t},prev:function(t){return(t=new Date(t)).setFullYear(t.getFullYear()-10),t}}};function ae(t){let e,n,s,i,o,r,a,c,l=t[2]&&ce(t);return i=new qt({props:{click:t[14],$$slots:{default:[de]},$$scope:{ctx:t}}}),a=new qt({props:{click:t[15],$$slots:{default:[ue]},$$scope:{ctx:t}}}),{c(){e=T("div"),l&&l.c(),n=I(),s=T("div"),$t(i.$$.fragment),o=I(),r=T("div"),$t(a.$$.fragment),E(s,"class","button-item svelte-14q6rsg"),E(r,"class","button-item svelte-14q6rsg"),E(e,"class","buttons svelte-14q6rsg")},m(t,d){_(t,e,d),l&&l.m(e,null),w(e,n),w(e,s),kt(i,s,null),w(e,o),w(e,r),kt(a,r,null),c=!0},p(t,s){t[2]?l?(l.p(t,s),4&s&&ut(l,1)):(l=ce(t),l.c(),ut(l,1),l.m(e,n)):l&&(lt(),pt(l,1,1,(()=>{l=null})),dt());const o={};131072&s&&(o.$$scope={dirty:s,ctx:t}),i.$set(o);const r={};131072&s&&(r.$$scope={dirty:s,ctx:t}),a.$set(r)},i(t){c||(ut(l),ut(i.$$.fragment,t),ut(a.$$.fragment,t),c=!0)},o(t){pt(l),pt(i.$$.fragment,t),pt(a.$$.fragment,t),c=!1},d(t){t&&S(e),l&&l.d(),yt(i),yt(a)}}}function ce(t){let e,n,s;return n=new qt({props:{click:t[13],$$slots:{default:[le]},$$scope:{ctx:t}}}),{c(){e=T("div"),$t(n.$$.fragment),E(e,"class","button-item svelte-14q6rsg")},m(t,i){_(t,e,i),kt(n,e,null),s=!0},p(t,e){const s={};131072&e&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&S(e),yt(n)}}}function le(t){let e,n=t[7]("done")+"";return{c(){e=C(n)},m(t,n){_(t,e,n)},p:i,d(t){t&&S(e)}}}function de(t){let e,n=t[7]("clear")+"";return{c(){e=C(n)},m(t,n){_(t,e,n)},p:i,d(t){t&&S(e)}}}function ue(t){let e,n=t[7]("today")+"";return{c(){e=C(n)},m(t,n){_(t,e,n)},p:i,d(t){t&&S(e)}}}function pe(t){let e,n,s,i,o,r,a,c,l;s=new Ft({props:{date:t[1],part:t[3],type:t[6]}}),s.$on("shift",t[12]);var d=re[t[6]].component;function u(t){return{props:{value:t[0],current:t[1],part:t[3],markers:t[4],select:t[11],cancel:t[9]}}}d&&(r=F(d,u(t)));let p="month"===t[6]&&t[5]&&ae(t);return{c(){e=T("div"),n=T("div"),$t(s.$$.fragment),i=I(),o=T("div"),r&&$t(r.$$.fragment),a=I(),p&&p.c(),E(n,"class","wrap svelte-14q6rsg"),E(e,"class",c="calendar "+("normal"!==t[3]?"part":"")+" svelte-14q6rsg")},m(t,c){_(t,e,c),w(e,n),kt(s,n,null),w(n,i),w(n,o),r&&kt(r,o,null),w(o,a),p&&p.m(o,null),l=!0},p(t,[n]){const i={};2&n&&(i.date=t[1]),8&n&&(i.part=t[3]),64&n&&(i.type=t[6]),s.$set(i);const h={};if(1&n&&(h.value=t[0]),2&n&&(h.current=t[1]),8&n&&(h.part=t[3]),16&n&&(h.markers=t[4]),64&n&&d!==(d=re[t[6]].component)){if(r){lt();const t=r;pt(t.$$.fragment,1,0,(()=>{yt(t,1)})),dt()}d?(r=F(d,u(t)),$t(r.$$.fragment),ut(r.$$.fragment,1),kt(r,o,a)):r=null}else d&&r.$set(h);"month"===t[6]&&t[5]?p?(p.p(t,n),96&n&&ut(p,1)):(p=ae(t),p.c(),ut(p,1),p.m(o,null)):p&&(lt(),pt(p,1,1,(()=>{p=null})),dt()),(!l||8&n&&c!==(c="calendar "+("normal"!==t[3]?"part":"")+" svelte-14q6rsg"))&&E(e,"class",c)},i(t){l||(ut(s.$$.fragment,t),r&&ut(r.$$.fragment,t),ut(p),l=!0)},o(t){pt(s.$$.fragment,t),r&&pt(r.$$.fragment,t),pt(p),l=!1},d(t){t&&S(e),yt(s),r&&yt(r),p&&p.d()}}}function he(t,e,n){const s=J(),i=G("wx-i18n").getGroup("calendar");let{value:o}=e,{current:r}=e,{done:a=!1}=e,{part:c="normal"}=e,{markers:l=null}=e,{buttons:d=!0}=e,u="month";function p(t,e){t.preventDefault(),s("change",{value:e})}function h(t){0==t.diff?"month"===u?n(6,u="year"):"year"===u&&n(6,u="duodecade"):s("shift",t)}return t.$$set=t=>{"value"in t&&n(0,o=t.value),"current"in t&&n(1,r=t.current),"done"in t&&n(2,a=t.done),"part"in t&&n(3,c=t.part),"markers"in t&&n(4,l=t.markers),"buttons"in t&&n(5,d=t.buttons)},[o,r,a,c,l,d,u,i,p,function(){"duodecade"===u?n(6,u="year"):"year"===u&&n(6,u="month")},h,function(t){s("change",{select:!0,value:t})},t=>h(t.detail),t=>p(t,-1),t=>p(t,null),t=>p(t,new Date)]}class fe extends bt{constructor(t){super(),xt(this,t,he,pe,d,{value:0,current:1,done:2,part:3,markers:4,buttons:5})}}function me(t){let e,n;return e=new fe({props:{value:t[0],current:t[1],markers:t[2],buttons:t[3]}}),e.$on("shift",t[6]),e.$on("change",t[7]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,[n]){const s={};1&n&&(s.value=t[0]),2&n&&(s.current=t[1]),4&n&&(s.markers=t[2]),8&n&&(s.buttons=t[3]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ge(t,e,n){const s=J();let{value:i}=e,{current:o}=e,{markers:r=null}=e,{buttons:a=!0}=e;function c({diff:t,type:e}){const s=re[e];n(1,o=t>0?s.next(o):s.prev(o))}function l(t){const e=t.value;e?(n(1,o=new Date(e)),n(0,i=new Date(e))):n(0,i=null),s("change",{value:i})}return t.$$set=t=>{"value"in t&&n(0,i=t.value),"current"in t&&n(1,o=t.current),"markers"in t&&n(2,r=t.markers),"buttons"in t&&n(3,a=t.buttons)},t.$$.update=()=>{1&t.$$.dirty&&(o||n(1,o=i||new Date))},[i,o,r,a,c,l,t=>c(t.detail),t=>l(t.detail)]}class $e extends bt{constructor(t){super(),xt(this,t,ge,me,d,{value:0,current:1,markers:2,buttons:3})}}const{document:ke}=b;function ye(t){let e,n,s,i,o;const r=t[8].default,a=h(r,t,t[7],null);return{c(){e=I(),n=T("div"),a&&a.c(),E(n,"class","popup svelte-3iw5hi"),H(n,"top",t[1]+"px"),H(n,"left",t[0]+"px")},m(r,c){_(r,e,c),_(r,n,c),a&&a.m(n,null),t[9](n),s=!0,i||(o=D(ke.body,"mousedown",t[3]),i=!0)},p(t,[e]){a&&a.p&&(!s||128&e)&&g(a,r,t,t[7],s?m(r,t[7],e,null):$(t[7]),null),(!s||2&e)&&H(n,"top",t[1]+"px"),(!s||1&e)&&H(n,"left",t[0]+"px")},i(t){s||(ut(a,t),s=!0)},o(t){pt(a,t),s=!1},d(s){s&&S(e),s&&S(n),a&&a.d(s),t[9](null),i=!1,o()}}}function ve(t,e,n){let s,{$$slots:i={},$$scope:o}=e,{left:r=0}=e,{top:a=0}=e,{area:c=null}=e,{cancel:l}=e,{mount:d}=e;function u(){if(!s)return;const t=document.body.getBoundingClientRect(),e=s.getBoundingClientRect();e.right>=t.right&&n(0,r=t.right-e.width),e.bottom>=t.bottom&&n(1,a=t.bottom-e.height-12)}return c&&(d&&d(u),Y((()=>u()))),t.$$set=t=>{"left"in t&&n(0,r=t.left),"top"in t&&n(1,a=t.top),"area"in t&&n(4,c=t.area),"cancel"in t&&n(5,l=t.cancel),"mount"in t&&n(6,d=t.mount),"$$scope"in t&&n(7,o=t.$$scope)},t.$$.update=()=>{16&t.$$.dirty&&c&&(n(1,a=c.top+c.height),n(0,r=c.left))},[r,a,s,function(t){s.contains(t.target)||l&&l(t)},c,l,d,o,i,function(t){X[t?"unshift":"push"]((()=>{s=t,n(2,s)}))}]}class xe extends bt{constructor(t){super(),xt(this,t,ve,ye,d,{left:0,top:1,area:4,cancel:5,mount:6})}}const be=t=>({}),we=t=>({mount:t[1]});function _e(t){let e,n,s,i;const o=t[5].default,r=h(o,t,t[4],we);return{c(){e=T("div"),n=T("div"),r&&r.c(),E(n,"class",s="wx-"+t[0]+"-theme svelte-nejz1p"),E(e,"class","wx-clone svelte-nejz1p")},m(s,o){_(s,e,o),w(e,n),r&&r.m(n,null),t[6](n),i=!0},p(t,[e]){r&&r.p&&(!i||16&e)&&g(r,o,t,t[4],i?m(o,t[4],e,be):$(t[4]),we),(!i||1&e&&s!==(s="wx-"+t[0]+"-theme svelte-nejz1p"))&&E(n,"class",s)},i(t){i||(ut(r,t),i=!0)},o(t){pt(r,t),i=!1},d(n){n&&S(e),r&&r.d(n),t[6](null)}}}function Se(t,e,n){let s,{$$slots:i={},$$scope:o}=e,{theme:r=""}=e,{target:a}=e,c=[];var l;return""===r&&(r=G("wx-theme")),B((()=>{(a||function(t){for(;;){if(t===document.body||t.getAttribute("data-wx-portal-root"))return t;t=t.parentNode}}(s)).appendChild(s),c&&c.forEach((t=>t()))})),l=()=>{s&&s.parentNode&&s.parentNode.removeChild(s)},q().$$.on_destroy.push(l),t.$$set=t=>{"theme"in t&&n(0,r=t.theme),"target"in t&&n(3,a=t.target),"$$scope"in t&&n(4,o=t.$$scope)},[r,t=>{c&&c.push(t)},s,a,o,i,function(t){X[t?"unshift":"push"]((()=>{s=t,n(2,s)}))}]}class je extends bt{constructor(t){super(),xt(this,t,Se,_e,d,{theme:0,target:3,mount:1})}get mount(){return this.$$.ctx[1]}}function Te(t){let e,n;return{c(){e=new R(!1),n=M(),e.a=n},m(t,s){e.m("<style>\n@font-face {\nfont-family: 'Roboto';\nfont-style: normal;\nfont-weight: 400;\nsrc: local(''),\n    url('https://cdn.webix.com/fonts/roboto/regular.woff2') format('woff2'),\n    url('https://cdn.webix.com/fonts/roboto/regular.woff') format('woff');\n}\n@font-face {\nfont-family: 'Roboto';\nfont-style: normal;\nfont-weight: 500;\nsrc: local(''),\n    url('https://cdn.webix.com/fonts/roboto/500.woff2') format('woff2'),\n    url('https://cdn.webix.com/fonts/roboto/500.woff') format('woff');\n}</style>",t,s),_(t,n,s)},p:i,i:i,o:i,d(t){t&&S(n),t&&e.d()}}}class Ce extends bt{constructor(t){super(),xt(this,t,null,Te,d,{})}}function Ie(t){let e,n,s,i,o,r;return s=new Ce({}),{c(){e=T("link"),n=I(),$t(s.$$.fragment),i=I(),o=T("link"),E(e,"rel","preconnect"),E(e,"href","https://cdn.webix.com"),E(e,"crossorigin",""),E(o,"rel","stylesheet"),E(o,"href","https://webix.io/dev/fonts/wxi/wx-icons.css")},m(t,a){_(t,e,a),_(t,n,a),kt(s,t,a),_(t,i,a),_(t,o,a),r=!0},i(t){r||(ut(s.$$.fragment,t),r=!0)},o(t){pt(s.$$.fragment,t),r=!1},d(t){t&&S(e),t&&S(n),yt(s,t),t&&S(i),t&&S(o)}}}function Me(t){let e,n,s,i=t[1]&&t[1].default&&function(t){let e,n;const s=t[3].default,i=h(s,t,t[2],null);return{c(){e=T("div"),i&&i.c(),E(e,"class","wx-material-theme"),H(e,"height","100%")},m(t,s){_(t,e,s),i&&i.m(e,null),n=!0},p(t,e){i&&i.p&&(!n||4&e)&&g(i,s,t,t[2],n?m(s,t[2],e,null):$(t[2]),null)},i(t){n||(ut(i,t),n=!0)},o(t){pt(i,t),n=!1},d(t){t&&S(e),i&&i.d(t)}}}(t),o=t[0]&&Ie();return{c(){i&&i.c(),e=I(),o&&o.c(),n=M()},m(t,r){i&&i.m(t,r),_(t,e,r),o&&o.m(document.head,null),w(document.head,n),s=!0},p(t,[e]){t[1]&&t[1].default&&i.p(t,e),t[0]?o?1&e&&ut(o,1):(o=Ie(),o.c(),ut(o,1),o.m(n.parentNode,n)):o&&(lt(),pt(o,1,1,(()=>{o=null})),dt())},i(t){s||(ut(i),ut(o),s=!0)},o(t){pt(i),pt(o),s=!1},d(t){i&&i.d(t),t&&S(e),o&&o.d(t),S(n)}}}function De(t,e,n){let{$$slots:s={},$$scope:i}=e,{fonts:r=!0}=e;const a=e.$$slots;return W("wx-theme","material"),t.$$set=t=>{n(4,e=o(o({},e),k(t))),"fonts"in t&&n(0,r=t.fonts),"$$scope"in t&&n(2,i=t.$$scope)},e=k(e),[r,a,i,s]}class Pe extends bt{constructor(t){super(),xt(this,t,De,Me,d,{fonts:0})}}const Ee={core:{ok:"OK",cancel:"Cancel"},calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today",am:["am","AM"],pm:["pm","PM"],weekStart:7,timeFormat:24}};function Ne(t){let e;const n=t[3].default,s=h(n,t,t[2],null);return{c(){s&&s.c()},m(t,n){s&&s.m(t,n),e=!0},p(t,[i]){s&&s.p&&(!e||4&i)&&g(s,n,t,t[2],e?m(n,t[2],i,null):$(t[2]),null)},i(t){e||(ut(s,t),e=!0)},o(t){pt(s,t),e=!1},d(t){s&&s.d(t)}}}function Ae(t,e,n){let{$$slots:s={},$$scope:i}=e,{words:o=null}=e,{optional:r=!1}=e,a=G("wx-i18n");return a||(a=Ct(Ee)),a=a.extend(o,r),W("wx-i18n",a),t.$$set=t=>{"words"in t&&n(0,o=t.words),"optional"in t&&n(1,r=t.optional),"$$scope"in t&&n(2,i=t.$$scope)},[o,r,i,s]}class He extends bt{constructor(t){super(),xt(this,t,Ae,Ne,d,{words:0,optional:1})}}function Le(t){let e,n;const s=t[1].default,i=h(s,t,t[2],null);return{c(){e=T("div"),i&&i.c(),E(e,"class","wx-material-theme"),H(e,"height","100%"),H(e,"width","100%")},m(t,s){_(t,e,s),i&&i.m(e,null),n=!0},p(t,e){i&&i.p&&(!n||4&e)&&g(i,s,t,t[2],n?m(s,t[2],e,null):$(t[2]),null)},i(t){n||(ut(i,t),n=!0)},o(t){pt(i,t),n=!1},d(t){t&&S(e),i&&i.d(t)}}}function Re(t){let e,n,s=t[0]&&t[0].default&&function(t){let e,n;return e=new Pe({props:{$$slots:{default:[Le]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}(t);return{c(){s&&s.c(),e=M()},m(t,i){s&&s.m(t,i),_(t,e,i),n=!0},p(t,[e]){t[0]&&t[0].default&&s.p(t,e)},i(t){n||(ut(s),n=!0)},o(t){pt(s),n=!1},d(t){s&&s.d(t),t&&S(e)}}}function Fe(t,e,n){let{$$slots:s={},$$scope:i}=e;const r=e.$$slots;return t.$$set=t=>{n(3,e=o(o({},e),k(t))),"$$scope"in t&&n(2,i=t.$$scope)},e=k(e),[r,s,i]}class Oe extends bt{constructor(t){super(),xt(this,t,Fe,Re,d,{})}}const ze={core:{ok:"OK",cancel:"Cancel"},calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today",am:["am","AM"],pm:["pm","PM"],weekStart:7,timeFormat:24}};var qe={todo:{"No project":"No project","Search project":"Search project","Add project":"Add project","Rename project":"Rename project","Delete project":"Delete project","Completed tasks":"Completed tasks",Show:"Show",Hide:"Hide","Sort by":"Sort by","Text (a-z)":"Text (a-z)","Text (z-a)":"Text (z-a)","Due date (new to old)":"Due date (new to old)","Due date (old to new)":"Due date (old to new)","Completion date (new to old)":"Completion date (new to old)","Completion date (old to new)":"Completion date (old to new)","Created (new to old)":"Created (new to old)","Created (old to new)":"Created (old to new)","Edited (new to old)":"Edited (new to old)","Edited (old to new)":"Edited (old to new)","Priority (high to low)":"Priority (high to low)","Priority (low to high)":"Priority (low to high)","Add task below":"Add task below","Add subtask":"Add subtask","Set due date":"Set due date","Set priority":"Set priority","Reset priority":"Reset priority",Indent:"Indent",Unindent:"Unindent","Assign to":"Assign to","Move to":"Move to",Duplicate:"Duplicate",Copy:"Copy",Paste:"Paste",Delete:"Delete",Enter:"Enter",Tab:"Tab","Shift+Tab":"Shift+Tab","Ctrl+D":"Ctrl+D","Ctrl+C":"Ctrl+C","Ctrl+V":"Ctrl+V","CMD+D":"CMD+D","CMD+C":"CMD+C","CMD+V":"CMD+V","Type what you want":"Type what you want",Search:"Search","Add task":"Add task","New project":"New project",High:"High",Medium:"Medium",Low:"Low"}};let Be=(new Date).valueOf();const Ye=()=>Be++;class Je{constructor(t,e,n){this._setter=t,this._routes=e,this._parsers=n,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach((t=>{t.in.forEach((e=>{const n=this._triggers.get(e)||[];n.push(t),this._triggers.set(e,n)})),t.out.forEach((e=>{const n=this._sources.get(e)||{};t.in.forEach((t=>n[t]=!0)),this._sources.set(e,n)}))})),this._routes.forEach((t=>{t.length=Math.max(...t.in.map((t=>We(t,this._sources,1))))}))}init(t){const e={};for(const n in t)if(this._prev[n]!==t[n]){const s=this._parsers[n];e[n]=s?s(t[n]):t[n]}this._prev=this._prev?{...this._prev,...t}:{...t},this.setState(e)}setState(t,e){this._setter(t);const n=!e;e=e||[];for(const n in t){const t=this._triggers.get(n);t&&t.forEach((t=>{-1==e.indexOf(t)&&e.push(t)}))}n&&this._execNext(e)}_execNext(t){for(;t.length;){t.sort(((t,e)=>t.length<e.length?1:-1));const e=t[t.length-1];t.splice(t.length-1),e.exec(t)}}}function We(t,e,n){const s=e.get(t);if(!s)return n;const i=Object.keys(s).map((t=>We(t,e,n+1)));return Math.max(...i)}class Ge{constructor(t){this._writable=t,this._values={},this._state={}}setState(t){const e=this._state;for(const n in t)e[n]?e[n].set(t[n]):this._state[n]=this._wrapWritable(n,t[n])}getState(){return this._values}getReactive(){return this._state}_wrapWritable(t,e){const n=this._writable(e);return n.subscribe((e=>{this._values[t]=e})),n}}class Ve{constructor(){this._nextHandler=()=>null,this._handlers={},this.exec=this.exec.bind(this)}on(t,e){const n=this._handlers[t];this._handlers[t]=n?function(t){Ue(n,t)(e(t))}:n=>{Ue(this._nextHandler,n,t)(e(n))}}exec(t,e){const n=this._handlers[t];n?n(e):this._nextHandler(t,e)}setNext(t){this._nextHandler=t}}function Ue(t,e,n){return s=>{!1!==s&&(s&&s.then?s.then(Ue(t,e,n)):n?t(n,e):t(e))}}class Xe{constructor(t){this._nextHandler=()=>null,this._dispatch=t,this.exec=this.exec.bind(this)}exec(t,e){this._dispatch(t,e),this._nextHandler&&this._nextHandler(t,e)}setNext(t){this._nextHandler=t}}let Ze=(new Date).valueOf();function Qe(){return Ze+=1,"temp://"+Ze}function Ke(t,e){return t==e}function tn(t){return null!=t}function en(t){return null===t}function nn(t,e){const n=t.length;for(let s=0;s<n;s++)if(e(t[s]))return s;return-1}function sn(t){return/\s/g.test(t)}function on(){return navigator.userAgent.indexOf("Mac")>-1}function rn(t){if(!t)return t;const e=Array.isArray(t)?[]:{};for(const n in t){const s=t[n];s instanceof Date?e[n]=new Date(s):e[n]="object"==typeof s?rn(s):s}return e}function an(t){return t.flatMap((({children:t,...e})=>[e,...an(t||[])]))}function cn(){(function(){if("undefined"==typeof window)return!0;const t=location.hostname,e=["ZGh0bWx4LmNvbQ==","ZGh0bWx4Y29kZS5jb20=","d2ViaXhjb2RlLmNvbQ==","d2ViaXguaW8=","cmVwbC5jbw==","Y3NiLmFwcA=="];for(let n=0;n<e.length;n++){const s=window.atob(e[n]);if(s===t||t.endsWith("."+s))return!0}return!1})()||setTimeout((()=>{var t,e;setInterval((()=>{if("undefined"!=typeof window&&new Date>1772585103000){!function(t){const e=document.createElement("div");e.setAttribute("style","\n\t\tdisplay:block!important;\n\t\tbackground: #ff5252 !important;\n\t\tcolor: white !important;\n\t\tpadding: 12px;\n\t\tposition: absolute !important;\n\t\tmax-width: 260px;top: 2% !important;\n\t\tright: 2% !important;\n\t\tfont-size: 14px !important;\n\t\tbox-shadow: 0 1px 6px rgba(0,0,0,.1), 0 10px 20px rgba(0,0,0,.1);\n\t\tcursor: pointer;\n\t\tborder-radius: 2px;\n\t\tfont-family: Roboto, Arial, Helvetica, sans-serif;\n\t\tz-index: 999999;"),e.innerText=t,e.addEventListener("click",(function(){document.body.removeChild(e),window.open("https://dhtmlx.com/docs/products/licenses.shtml","_blank")})),document.body.appendChild(e)}(window.atob("WW91ciB0cmlhbCBoYXMgZXhwaXJlZC4gUGxlYXNlIHB1cmNoYXNlIHRoZSBjb21tZXJjaWFsIGxpY2Vuc2UgZm9yIHRoZSBUb0RvIExpc3Qgd2lkZ2V0IGF0IGh0dHBzOi8vZGh0bWx4LmNvbQ=="))}}),(t=6e4,e=18e4,Math.floor(Math.random()*(e-t+1))+t))}))}const ln=["#607D8B","#00C7B5","#03A9F4","#9575CD","#F06292","#FF9800"],dn=["#ff5252","#ffc975","#0ab169","#607D8B","#00C7B5","#03A9F4","#9575CD","#F06292","#FF9800"],un={counter:{type:"number"},date:{format:"%d %M %Y",validate:!0},completed:{behavior:"auto",taskHide:!1},priority:{label:!0,cover:!0}},pn={expand:!0},hn=[{id:1,label:"High",color:"#ff5252",hotkey:"Alt+1"},{id:2,label:"Medium",color:"#ffc975",hotkey:"Alt+2"},{id:3,label:"Low",color:"#0ab169",hotkey:"Alt+3"}],fn=t=>new RegExp(String.raw`(?:^|)${t}(?:\s|$)`,"gm"),mn=t=>new RegExp(String.raw`\B[${t}]\w\S+`,"gm");function gn(t,e,n){if(n){const n=fn(e);return!!t.match(n)?.length}return t.toLowerCase().includes(e.toLowerCase())}function $n(t=[],e){return t.map((t=>({...t,children:$n(t.children,e)}))).filter((t=>function(t,{match:e,by:n,strict:s}){return gn(n?t[n]||"":t.text||"",e,s)}(t,e)||t?.children?.length))}function kn(t){return an(function(t){const e={},n=[],s={};for(let n=0;n<t.length;n++)s[t[n].id]=n,e[t[n].id]=[],t[n].children=[];for(let i=0;i<t.length;i++){const o=t[i];o.parent&&e[o.parent]?(t[s[o.parent]].children.push(o),e[o.parent].push(o)):tn(o.parent)||n.push(o)}return n}(t))}function yn(t,e,n){if(t?.children?.length)for(let s=0;s<t.children.length;s++)yn(t.children[s],e,n);t.counter={type:n?.counter?.type||"number",total:e[t.id].length,done:e[t.id].filter((t=>!0===t.checked)).length}}function vn(t,e){const n=[];for(let s=0;s<e.assigned.length;s++){const i=t[e.assigned[s]];i.type="user",i&&n.push(i)}return n}function xn(t){const{menuState:e,stateEditableItem:n,stateDueDate:s,stateCombo:i}=t.getState();e&&t.in.exec("close-menu",{...e}),n&&t.in.exec("close-inline-editor",{id:n.id,save:!0}),s?.open&&t.in.exec("set-state-due-date",{...s,open:!1}),i?.open&&t.in.exec("set-state-due-date",{...s,open:!1})}function bn({store:t,id:e}){const n=tn(t.getState()?.filter),s=t.getState()?.taskShape?.completed?.taskHide,i=t.getTask(e),o=t.getChildrenIds({id:i?.parent,tree:!0,filtered:n,hideCompleted:s});let r=null;return r=(!tn(i?.parent)||1!==o.length&&o.at(-1)!==i.id)&&t.getNearId({id:i.id,flat:!0,filtered:n,hideCompleted:s})||t.getNearId({id:i.id,dir:"prev",flat:!0,filtered:n,hideCompleted:s}),r}function wn(t,{id:e,project:n,parent:s,targetId:i,task:o={},reverse:r}){if(t.existsTask(e))return;const a=t.getState(),{activeProject:c,tasksMap:l}=a;o.id=e??o.id??Qe().toString(),void 0!==n?o.project=n:void 0===o.project&&tn(c)&&(o.project=c),void 0!==s&&(o.parent=s),o.creation_date||(o.creation_date=new Date),void 0===o.text&&(o.text="");let{tasks:d}=a;l[e]=o,d=[...d,o];const{treeTasks:u,childrenMap:p,filteredChildrenMap:h,usersMap:f,tags:m}=t.getInnerState(d,c);return t.setState({tasks:d,treeTasks:u,childrenMap:p,filteredChildrenMap:h,usersMap:f,tags:m,tasksMap:l}),(tn(i)||r)&&t.moveTask({id:o.id,parent:o.parent,project:o.project,targetId:i,reverse:r,silent:!0}),()=>{const n=t.getState().stateEditableItem;n&&t.in.exec("close-inline-editor",{id:n.id,save:!1});const s=bn({store:t,id:e});t.in.exec("delete-task",{id:e,$meta:{skipHistory:!0}}),t.in.exec("select-task",{id:s})}}function _n(t,e){const{task:n,batch:s}=e,i=t.updateTask(e),o={};if(i)for(let t in n)n[t]!==i[t]&&(o[t]=i[t]);if(i){for(let t in n)void 0===i[t]&&(i[t]="boolean"!=typeof n[t]&&null);i.selected&&delete i.selected}return()=>{const n=[];o&&s&&s.forEach((t=>{const e={...t};for(let t in o)e[t]=o[t];n.push(e)})),t.in.exec("update-task",{...e,task:i,batch:n,$meta:{skipHistory:!0}})}}function Sn(t,e){const{id:n,parent:s,targetId:i,reverse:o,project:r}=e,a=t.getNearId({id:n,dir:"prev"});let c=!1;a||(c=!0),xn(t);const l=t.moveTask({id:n,parent:s,targetId:i,reverse:o,project:r});return()=>{l&&t.in.exec("move-task",{...e,parent:l.parent,targetId:a,project:l.project,reverse:c,$meta:{skipHistory:!0}})}}function jn(t,{id:e,targetId:n,parent:s,reverse:i,project:o,join:r=!1}){if(!t.existsTask(e))return;let a=[];if(r){const n=t.getState().copiedTasksId,s=t.getParentIds(e);if(n.some((t=>Ke(t,e)||s.some((e=>Ke(t,e))))))return;const i=t.getChildrenIds({id:e});for(let t=0;t<n.length;t++)i.some((e=>Ke(e,n[t])))&&n.splice(t,1);a=[...n]}a.push(e),t.setState({copiedTasksId:a}),(t.existsTask(n)||t.existsTask(s)||en(s))&&t.pasteTask({targetId:n,parent:s,project:o,reverse:i})}function Tn(t,{targetId:e,parent:n,project:s,reverse:i}){const o=t.pasteTask({targetId:e,parent:n,project:s,reverse:i});return()=>{for(let e=0;e<o.length;e++)0===e?t.in.exec("delete-task",{id:o[e],batch:o,$meta:{skipHistory:!0}}):t.in.exec("delete-task",{id:o[e],skipProvider:!0,$meta:{skipHistory:!0}})}}function Cn(t,{id:e}){if(!t.existsTask(e))return;const n=t.getState();let{selected:s,tasks:i}=n;const o=n.tasksMap,r=t.getChildrenIds({id:e,tree:!0}),a=[e,...r],c={...o[e]};c.selected=!1;const l=t.getNearId({id:e,dir:"prev"});let d=!1;l||(d=!0);const u=[];for(const t of a)s=s.filter((e=>!Ke(e,t))),i=i.filter((n=>{const s=Ke(n.id,t);return s&&n.id!==e&&u.push(n),!s})),delete o[t];const{treeTasks:p,childrenMap:h,filteredChildrenMap:f,usersMap:m,tags:g}=t.getInnerState(i,n.activeProject);return t.setState({tasks:i,treeTasks:p,childrenMap:h,filteredChildrenMap:f,usersMap:m,tags:g,selected:s,tasksMap:o}),()=>{const n={id:c.id,task:c,reverse:d,$meta:{skipHistory:!0,restore:e}};l&&(n.targetId=l),c.project&&(n.project=c.project),c.parent&&(n.parent=c.parent),t.in.exec("add-task",n),u.forEach((e=>{const n={id:e.id,task:e,parent:e.parent,$meta:{skipHistory:!0,restore:e.id}};e.project&&(n.project=e.project),t.in.exec("add-task",n)}))}}function In(t,{id:e}){const n=t.getTask(e);n?.collapsed&&t.in.exec("update-task",{id:e,task:{...n,collapsed:!1},skipProvider:!0})}function Mn(t,{id:e}){const n=t.getTask(e);n?.collapsed||t.in.exec("update-task",{id:e,task:{...n,collapsed:!0},skipProvider:!0})}function Dn(t,e){const{id:n,manual:s=!1,skipStateCalc:i=!1}=e,o=t.getTask(n);if(o?.checked)return;const r=[],a=t.getState().taskShape?.completed?.behavior||"auto";e.$meta||(e.$meta={}),e.$meta.batch||(e.$meta.batch=Ye());const c=e.$meta.batch;if(!s&&"manual"!==a&&!i){t.hasChildren(n)&&t.getChildren({id:n,tree:!0}).forEach((n=>{n.checked||(t.in.exec("check-task",{id:n.id,skipStateCalc:!0,$meta:{batch:c,skipHistory:!!e.$meta?.skipHistory}}),r.push({...t.getTask(n.id)}))}));t.getParentIds(n).forEach((s=>{const i=t.getChildren({id:s}).every((e=>!!Ke(e.id,n)||t.getTask(e.id).checked));if(i){t.getTask(s).checked||(t.in.exec("check-task",{id:s,skipStateCalc:!0,$meta:{batch:c,skipHistory:!!e.$meta?.skipHistory}}),r.push({...t.getTask(s)}))}}))}return t.in.exec("update-task",{id:n,task:{...o,checked:!0,completion_date:new Date},skipStateCalc:i,skipProvider:i&&!s,batch:r,$meta:{skipHistory:!0}}),()=>{t.in.exec("uncheck-task",{...e,$meta:{...e.$meta,skipHistory:!0}})}}function Pn(t,e){const{id:n,manual:s=!1,skipStateCalc:i=!1}=e,o=t.getTask(n);if(!o?.checked)return;const r=[],a=t.getState().taskShape?.completed?.behavior||"auto";e.$meta||(e.$meta={}),e.$meta.batch||(e.$meta.batch=Ye());const c=e.$meta.batch;return s||"manual"===a||i||(tn(o.parent)&&t.getParentIds(n).forEach((n=>{t.getTask(n).checked&&(t.in.exec("uncheck-task",{id:n,skipStateCalc:!0,$meta:{batch:c,skipHistory:!!e.$meta?.skipHistory}}),r.push({...t.getTask(n)}))})),t.hasChildren(n)&&t.getChildren({id:n,tree:!0}).forEach((n=>{n.checked&&(t.in.exec("uncheck-task",{id:n.id,skipStateCalc:!0,$meta:{batch:c,skipHistory:!!e.$meta?.skipHistory}}),r.push({...t.getTask(n.id)}))}))),t.in.exec("update-task",{id:n,task:{...o,checked:!1,completion_date:null},skipStateCalc:i,skipProvider:i&&!s,batch:r,$meta:{skipHistory:!0}}),()=>{t.in.exec("check-task",{...e,$meta:{...e.$meta,skipHistory:!0}})}}function En(t,{id:e,batchID:n,$meta:s}){const i=t.getTask(e),o=t.getTask(i?.parent),r=t.getState(),a=tn(r.filter?.match),c=r?.taskShape?.completed?.taskHide,l=t.getChildren({id:o?.id,tree:!1,filtered:a,hideCompleted:c}),d=t.getTreeIndex(e,a,c);if(d>0){const i=t.getTask(l[d-1]?.id);t.in.exec("move-task",{id:e,parent:i?.id,targetId:i?.id,operation:"indent",batchID:n,$meta:s}),i.collapsed&&t.in.exec("expand-task",{id:i?.id})}}function Nn(t,{id:e,batchID:n,$meta:s}){const i=t.getTask(e),o=t.getTask(i?.parent);tn(o?.id)&&t.in.exec("move-task",{id:e,parent:o.parent??null,targetId:o.id,operation:"unindent",batchID:n,$meta:s})}function An(t){const{taskShape:e}=t.getState();e.completed.taskHide=!1,t.setState({taskShape:e})}function Hn(t){const{taskShape:e}=t.getState();e.completed.taskHide=!0,t.setState({taskShape:e})}function Ln(t,{id:e,join:n=!1}){let{selected:s}=t.getState();if(!(!t.existsTask(e)||n&&s.some((t=>Ke(t,e))))){if(n)s.push(e);else{for(const n of s)Ke(n,e)||t.in.exec("unselect-task",{id:n});s=[e]}t.updateTask({id:e,task:{selected:!0}}),t.setState({selected:s})}}function Rn(t,{id:e}){let{selected:n}=t.getState();if(n.length&&(!tn(e)||n.some((t=>Ke(t,e))))){if(tn(e))t.updateTask({id:e,task:{selected:!1}});else{for(const e of n)t.in.exec("unselect-task",{id:e});n=[]}n=n.filter((t=>!Ke(t,e))),xn(t),t.setState({selected:n})}}function Fn(t,e){const{id:n,project:s}=e;if(t.existsProject(n))return;e.$meta||(e.$meta={}),e.$meta.branchId="$allBranches";const i=[...t.getState().projects,{id:n??Ye().toString(),label:"New project",...s}];return t.setState({projects:i}),()=>{t.in.exec("delete-project",{id:n,$meta:{skipHistory:!0,branchId:"$allBranches"}})}}function On(t,e){const{id:n,project:s}=e;if(!t.existsProject(n))return;let i;const o=t.getState().projects.map((t=>Ke(n,t.id)?(i={...t},{...t,...s,id:t.id}):t));for(let t in s)void 0===i[t]&&(i[t]=null);return t.setState({projects:o}),()=>{t.in.exec("update-project",{...e,project:i,$meta:{skipHistory:!0}})}}function zn(t,{id:e}){if(!t.existsProject(e)&&!en(e)||void 0===e)return;xn(t);const{treeTasks:n,childrenMap:s,filteredChildrenMap:i}=t.getInnerState(t.getState().tasks,e);t.setState({activeProject:e,treeTasks:n,childrenMap:s,filteredChildrenMap:i})}function qn(t,e){const n=e.id;if(!t.existsProject(n))return;const s=t.getState();e.$meta||(e.$meta={}),e.$meta.branchId="$allBranches";let i,o=null;const r=s.projects.filter(((t,e)=>{const r=Ke(t.id,n);return r&&(i={...t},o=e>0?s.projects[e-1].id:s.projects[e+1]?.id||null),!r})),a=[];s.tasks.forEach((e=>(Ke(e.project,n)&&(a.push(e),t.in.exec("update-task",{id:e.id,task:{...e,project:null},skipProvider:!0,skipStateCalc:!0,$meta:{skipHistory:!0}})),e)));const c=s.tasks,{treeTasks:l,childrenMap:d,filteredChildrenMap:u}=t.getInnerState(c,s.activeProject);return t.setState({projects:r,treeTasks:l,tasks:c,childrenMap:d,filteredChildrenMap:u}),Ke(s.activeProject,n)&&t.in.exec("set-project",{id:o}),()=>{t.in.exec("add-project",{id:i.id,project:i,$meta:{skipHistory:!0,restore:n}});for(let e=0;e<a.length;e++)0===e?t.in.exec("update-task",{id:a[e].id,task:a[e],batch:a.slice(1),$meta:{skipHistory:!0}}):t.in.exec("update-task",{id:a[e].id,task:a[e],skipProvider:!0,$meta:{skipHistory:!0}});t.in.exec("set-project",{id:i.id})}}let Bn={monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};const Yn={"%d":t=>{const e=t.getDate();return e<10?"0"+e:e},"%j":t=>t.getDate(),"%l":t=>Bn.dayFull[t.getDay()],"%D":t=>Bn.dayShort[t.getDay()],"%m":t=>{const e=t.getMonth()+1;return e<10?"0"+e:e},"%n":t=>t.getMonth()+1,"%M":t=>Bn.monthShort[t.getMonth()],"%F":t=>Bn.monthFull[t.getMonth()],"%y":t=>t.getFullYear().toString().slice(2),"%Y":t=>t.getFullYear()},Jn={"%d":(t,e)=>{/(^([0-9][0-9])$)/i.test(e)?t.setDate(Number(e)):t.setDate(Number(1))},"%j":(t,e)=>{/(^([0-9]?[0-9])$)/i.test(e)?t.setDate(Number(e)):t.setDate(Number(1))},"%m":(t,e)=>{const n=/(^([0-9][0-9])$)/i.test(e);n?t.setMonth(Number(e)-1):t.setMonth(Number(0)),n&&t.getMonth()!==Number(e)-1&&t.setMonth(Number(e)-1)},"%n":(t,e)=>{const n=/(^([0-9]?[0-9])$)/i.test(e);n?t.setMonth(Number(e)-1):t.setMonth(Number(0)),n&&t.getMonth()!==Number(e)-1&&t.setMonth(Number(e)-1)},"%M":(t,e)=>{const n=nn(Bn.monthShort,(t=>t===e));-1===n?t.setMonth(0):t.setMonth(n),-1!==n&&t.getMonth()!==n&&t.setMonth(n)},"%F":(t,e)=>{const n=nn(Bn.monthFull,(t=>t===e));-1===n?t.setMonth(0):t.setMonth(n),-1!==n&&t.getMonth()!==n&&t.setMonth(n)},"%y":(t,e)=>{/(^([0-9][0-9])$)/i.test(e)?t.setFullYear(Number("20"+e)):t.setFullYear(Number("2000"))},"%Y":(t,e)=>{/(^([0-9][0-9][0-9][0-9])$)/i.test(e)?t.setFullYear(Number(e)):t.setFullYear(Number("2000"))}};var Wn;function Gn(t){const e=[];let n="";for(let s=0;s<t.length;s++)"%"===t[s]?(n.length>0&&(e.push({type:Wn.separator,value:n}),n=""),e.push({type:Wn.datePart,value:t[s]+t[s+1]}),s++):n+=t[s];return n.length>0&&e.push({type:Wn.separator,value:n}),e}function Vn(t,e,n){return n&&(Bn=n),Gn(e).reduce(((e,n)=>n.type===Wn.separator?e+n.value:Yn[n.value]?e+Yn[n.value](t):e),"")}function Un(t,e,n=!1,s){if("string"!=typeof t)return;s&&(Bn=s);const i=Gn(e),o=[];let r,a=0,c=null;for(const e of i)if(e.type===Wn.separator){const s=t.indexOf(e.value,a);if(-1===s){if(n)return!1;if(Xn(t))return new Date(t);throw new Error("Incorrect Date or date format")}c&&(o.push({formatter:c,value:t.slice(a,s)}),c=null),a=s+e.value.length}else e.type===Wn.datePart&&(c=e.value);"%A"===c||"%a"===c?o.unshift({formatter:c,value:t.slice(a)}):c&&o.push({formatter:c,value:t.slice(a)}),o.reverse();for(const t of o)"%A"!==t.formatter&&"%a"!==t.formatter||(r=t.value);const l=new Date(0);for(const t of o)Jn[t.formatter]&&Jn[t.formatter](l,t.value,r);return l}function Xn(t){if("string"==typeof t){return new RegExp("^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?(Z)?$").test(t)}return t instanceof Date}function Zn({store:t,type:e,id:n,source:s}){switch(e){case"task":return function(t,e=[]){const{filter:n,projects:s,users:i,taskShape:o,priorities:r}=t.getState(),a=e.at(0),c=o?.date?.format,l=[];let d=t.getTask(a)?.due_date;"string"==typeof d&&(d=Un(d,c));tn(n)||1!==e.length||l.push({type:"item",icon:"plus",label:"Add task below",hotkey:"Enter",id:"addBelow"},{type:"item",icon:"subtask",label:"Add subtask",id:"addSubtask"},{type:"separator"});l.push({type:"item",icon:"indent",label:"Indent",hotkey:"Tab",id:"indent"},{type:"item",icon:"unindent",label:"Unindent",hotkey:"Shift+Tab",id:"unindent"},{type:"item",icon:"calendar",label:"Set due date",id:"setDate",data:[{type:"datepicker",id:"dueDate",value:1===e.length&&d?d:null,store:t}]}),Array.isArray(r)&&r.length&&l.push({type:"item",icon:"alert",label:"Set priority",data:ts(t,a,r),id:"setPriority"});1===e.length&&i?.length&&l.push({type:"item",icon:"assign",label:"Assign to",data:Qn(t,a,"assign"),id:"assign"});s?.length&&l.push({type:"item",icon:"content-paste",label:"Move to",data:Kn(t,"moveProject"),id:"moveProject"});return[...l,{type:"item",icon:"duplicate",label:"Duplicate",hotkey:on()?"CMD+D":"Ctrl+D",id:"duplicate"},{type:"item",icon:"content-copy",label:"Copy",hotkey:on()?"CMD+C":"Ctrl+C",id:"copy"},{type:"item",icon:"paste",label:"Paste",hotkey:on()?"CMD+V":"Ctrl+V",id:"paste"},{type:"separator"},{type:"item",icon:"delete",label:"Delete",hotkey:"Delete",id:"delete"}]}(t,s);case"toolbar":return function(t,e){const{taskShape:n,readonly:s}=t.getState(),i=n?.completed?.taskHide||!1,o=[{id:"sort",type:"item",label:"Sort by",icon:"sort",data:[{id:"sort:text-asc",type:"item",label:"Text (a-z)",icon:"asc"},{id:"sort:text-desc",type:"item",label:"Text (z-a)",icon:"desc"},{type:"separator"},{id:"sort:priority-asc",type:"item",label:"Priority (high to low)",icon:"asc"},{id:"sort:priority-desc",type:"item",label:"Priority (low to high)",icon:"desc"},{type:"separator"},{id:"sort:due-date-desc",type:"item",label:"Due date (new to old)",icon:"asc"},{id:"sort:due-date-asc",type:"item",label:"Due date (old to new)",icon:"desc"},{type:"separator"},{id:"sort:completion-date-desc",type:"item",label:"Completion date (new to old)",icon:"asc"},{id:"sort:completion-date-asc",type:"item",label:"Completion date (old to new)",icon:"desc"},{type:"separator"},{id:"sort:created-date-desc",type:"item",label:"Created (new to old)",icon:"asc"},{id:"sort:created-date-asc",type:"item",label:"Created (old to new)",icon:"desc"},{type:"separator"},{id:"sort:edited-date-desc",type:"item",label:"Edited (new to old)",icon:"asc"},{id:"sort:edited-date-asc",type:"item",label:"Edited (old to new)",icon:"desc"}]},{id:"completed",icon:"check",label:"Completed tasks",type:"item",data:[{id:"completed:show",label:"Show",type:"item",icon:i?"empty":"check"},{id:"completed:hide",label:"Hide",type:"item",icon:i?"check":"empty"}]}];s||(o.push({type:"separator"},{id:"add",icon:"plus",label:"Add project",type:"item"}),tn(e)&&o.push({id:"rename",icon:"edit",label:"Rename project",type:"item"},{id:"delete",icon:"delete",label:"Delete project",type:"item"}));return o}(t,n);case"user":return!0}}function Qn(t,e,n){const s=rn(t.getState().users),i=t.getTask(e),o=[];if(s.length)for(let t=0;t<s.length;t++){const e=s[t],r=i?.assigned?.some((t=>Ke(t,e.id)));o.push({...e,id:n+":"+e.id,color:e.color||ln[t%ln.length],icon:r?"check":"empty",type:"user",clickable:!0,checked:r})}return o}function Kn(t,e){const n=t.getState().activeProject;let s=rn(t.getState().projects);s.every((t=>tn(t.id)))&&(s=[{id:null,label:"No project"},...s]);const i=[];if(s.length)for(let t=0;t<s.length;t++){const o=s[t],r=Ke(o.id,n);i.push({...o,id:e+":"+o.id,type:"item",icon:r?"check":"empty",checked:r})}return i}function ts(t,e,n){const s=t.getTask(e),i=[];for(let t=0;t<n.length;t++){const e=n[t];i.push({...e,id:"priority:"+e.id,type:"priority",hotkey:e.hotkey,color:e.color||dn[t%dn.length],icon:Ke(s?.priority,e.id)?"check":"empty"})}return[...i,{type:"separator"},{type:"item",icon:"refresh",label:"Reset priority",hotkey:"Alt+0",id:"priority:reset"}]}function es(t,{id:e,type:n,source:s}){if(!tn(n))return;let{menu:i}=t.getState();if(!0===i&&(i=Zn),!i)return;let o=i({store:t,type:n,id:e,source:s});!o||Array.isArray(o)&&!o.length||(1==o&&(o=Zn({store:t,type:n,id:e,source:s})),t.setState({menuState:{id:e,type:n,source:s,options:o}}))}function ns(t){t.setState({menuState:null})}function ss(t,e,n,s,i,o){const r=t.getTask(n);Ke(e,r?.project)||void 0===e||(t.in.exec("select-task",{id:bn({store:t,id:n})}),t.in.exec("move-task",{id:n,project:e,parent:null,operation:"project",skipProvider:i,batch:s,$meta:{batch:o}}))}function is({store:t,task:e,reverse:n=!1}){const s=Qe().toString();t.in.exec("add-task",{id:s,targetId:e?.id,parent:e?.parent,project:t.getState()?.activeProject,reverse:n}),t.in.exec("select-task",{id:s}),t.in.exec("open-inline-editor",{id:s,type:"task"})}function os({store:t}){const e=t.getState().selected;if(!e.length)return;let n,s=bn({store:t,id:e.at(-1)});t.getTask(s)?.selected&&(s=bn({store:t,id:e.at(0)}));let i=e;e.length>1&&(n={batch:Ye()}),t.eachSelected(((e,s)=>{t.existsTask(e)&&(s?t.in.exec("delete-task",{id:e,skipProvider:!0,batch:i,$meta:n}):t.in.exec("delete-task",{id:e,batch:i,$meta:n}))}),!0),t.in.exec("select-task",{id:s})}function rs({store:t,id:e}){const n=t.getState().copiedTasksId;e=e||n.at(-1),t.in.exec("paste-task",{targetId:e,parent:t.getTask(e)?.parent??null})}function as({store:t}){const{selected:e}=t.getState();t.eachSelected(((n,s)=>{t.in.exec("copy-task",{id:n,join:!!s}),e.length-1===s&&rs({store:t})}),!0)}function cs({store:t}){t.eachSelected(((e,n)=>{t.in.exec("copy-task",{id:e,join:!!n})}),!0)}function ls({store:t}){let e;t.getState().selected.length>1&&(e={batch:Ye()});const n=Qe();t.eachSelected((s=>{const i=t.getTask(t.getTask(s).parent);i?.selected||t.in.exec("indent-task",{id:s,batchID:n,$meta:e})}),!0)}function ds({store:t}){let e;t.getState().selected.length>1&&(e={batch:Ye()});const n=Qe();t.eachSelected((s=>{const i=t.getTask(t.getTask(s).parent);i?.selected||t.in.exec("unindent-task",{id:s,batchID:n,$meta:e})}),!0)}function us({store:t,priority:e}){const n=t.getState().selected;if(!n.length)return;let s;e="null"===e||"0"==e?null:+e,n.length>1&&(s={batch:Ye()}),t.eachSelected((n=>{const i=t.getTask(n);t.in.exec("update-task",{id:n,task:{...i,priority:e},$meta:s})}))}function ps(t,e,n){if(!n)return;const{menuState:s}=t.getState();let i=n;const o=n.indexOf(":");if(o>0&&(i=n.substring(0,o)),i){const s=t.getTask(e);let r=n.substring(o+1);switch(i){case"addBelow":is({store:t,task:s});break;case"addSubtask":is({store:t,task:{...s,parent:e,targetId:e}}),s?.collapsed&&t.hasChildren(e)&&t.in.exec("expand-task",{id:e});break;case"duplicate":as({store:t});break;case"delete":os({store:t});break;case"indent":ls({store:t});break;case"unindent":ds({store:t});break;case"copy":cs({store:t});break;case"paste":rs({store:t,id:e});break;case"priority":us({store:t,priority:r});break;case"assign":s?.assigned?.some((t=>Ke(t,r)))?t.in.exec("unassign-user",{id:e,userId:r}):t.in.exec("assign-user",{id:e,userId:r});let{menuState:n,menu:i}=t.getState();!0===i&&(i=Zn);let o=i({store:t,type:"task",source:n.source});!0===o&&(o=Zn({store:t,type:"task",source:n.source})),t.setState({menuState:{...n,options:o}});break;case"moveProject":"null"===r&&(r=null),function({store:t,id:e}){const n=t.getSelection({sorted:!0}),s=n.filter((e=>{const s=t.getTask(e);return!n.some((e=>Ke(t.getTask(e).id,s.parent)))})),i=Ye();for(let o=0;o<n.length;o++){const r=n[o];ss(t,e,r,s,!!o,i)}}({store:t,id:r})}}"assign"!==i&&t.in.exec("close-menu",{...s})}function hs(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return t.replace(/[&<>"]/g,(t=>e[t]))}function fs(t,e){if(!t)return"";let n=hs(t);return e?.highlight?n=function(t,e){const n=e?.strict?fn(e.match):new RegExp(e.match,"gi"),s=e?.strict?"wx-todo_filter--strict":"wx-todo_filter";return t.replace(n,(t=>`<mark class="${s}">${t}</mark>`))}(n,e):(n=function(t){return t.replace(mn("#"),(t=>`<span class="wx-todo_tag" data-tag="${t}">${t}</span>`))}(n),n=function(t){const e=new RegExp(/!\((.+?)\)/gm);return t.replace(e,(t=>{const e=t.substring(2,t.length-1);return`<span class="wx-todo_date" data-date="${e}">${e}</span>`}))}(n)),n}function ms(t,e,n){const s=e.filter((e=>e.label.includes(n(t))));if(!s.length)return n(t);const i=new RegExp(/\d+(?=\))/gm);let o=0;for(const{label:t}of s){const e=t.match(i);e&&+e[0]>o&&(o=+e[0])}return`${n(t)} (${o+1})`}function gs(t,{action:e,id:n,locale:s}){if(!e)return;const{projects:i,menuState:o}=t.getState(),r=e.split(":"),a=r.at(0),c=r.at(1);switch(a){case"sort":!function(t,e){switch(e){case"text-asc":t.in.exec("set-sort",{by:"text",dir:"asc",tree:!0});break;case"text-desc":t.in.exec("set-sort",{by:"text",dir:"desc",tree:!0});break;case"due-date-asc":t.in.exec("set-sort",{by:"due_date",dir:"asc",tree:!0});break;case"due-date-desc":t.in.exec("set-sort",{by:"due_date",dir:"desc",tree:!0});break;case"completion-date-asc":t.in.exec("set-sort",{by:"completion_date",dir:"asc",tree:!0});break;case"completion-date-desc":t.in.exec("set-sort",{by:"completion_date",dir:"desc",tree:!0});break;case"created-date-asc":t.in.exec("set-sort",{by:"creation_date",dir:"asc",tree:!0});break;case"created-date-desc":t.in.exec("set-sort",{by:"creation_date",dir:"desc",tree:!0});break;case"edited-date-asc":t.in.exec("set-sort",{by:"edited_date",dir:"asc",tree:!0});break;case"edited-date-desc":t.in.exec("set-sort",{by:"edited_date",dir:"desc",tree:!0});break;case"priority-asc":t.in.exec("set-sort",{by:"priority",dir:"asc",tree:!0});break;case"priority-desc":t.in.exec("set-sort",{by:"priority",dir:"desc",tree:!0})}}(t,c);break;case"completed":!function(t,e){switch(e){case"show":t.in.exec("show-completed-tasks",{});break;case"hide":t.in.exec("hide-completed-tasks",{})}}(t,c);break;case"add":!function(t,e){const n=e?.id||Qe().toString();t.in.exec("add-project",{id:n,project:{label:e?.label||"New project"}}),t.in.exec("set-project",{id:n}),t.in.exec("open-inline-editor",{id:n,type:"project"})}(t,{id:"temp://"+Ye(),label:ms("New project",i,s)});break;case"rename":t.in.exec("open-inline-editor",{id:n,type:"project"});break;case"delete":t.in.exec("delete-project",{id:n})}t.in.exec("close-menu",{...o})}function $s(t,{id:e,action:n,type:s,params:i}){switch(s){case"task":return void ps(t,e,n);case"toolbar":return void gs(t,{id:e,action:n,locale:i.locale})}}function ks(t,{id:e,userId:n}){if(!t.getState().usersMap[n?.toString()])return;const s=t.getTask(e);s?.assigned?.some((t=>Ke(t,n)))||t.in.exec("update-task",{id:e,task:{...s,assigned:s?.assigned?.length?[...s.assigned,n]:[n]}})}function ys(t,{id:e,userId:n}){const s=t.getTask(e);s?.assigned?.some((t=>Ke(t,n)))&&t.in.exec("update-task",{id:e,task:{...s,assigned:s?.assigned?.filter((t=>t!=n))}})}function vs(t,{id:e,type:n="task",targetDate:s}){const{stateDueDate:i}=t.getState();if(i?.open||!tn(e)||!t.existsTask(e)&&"task"===n||!t.existsProject(e)&&"project"===n)return;let o=null;"task"===n?o=t.getTask(e)?.text:"project"===n&&(o=t.getProject(e)?.label),t.setState({stateEditableItem:{id:e,type:n,initValue:o,currentValue:o,targetDate:s}})}function xs(t,{save:e=!0}){const{stateEditableItem:n}=t.getState();if(!tn(n?.id))return;const s=n.id,i=n.currentValue;if(e){if("task"===n.type){const e=t.getTask(s);if(!e)return;i!==e.text&&t.in.exec("update-task",{id:s,task:{...e,text:i,edited_date:new Date}})}if("project"===n.type){const e=t.getProject(s);i!==e?.label&&t.in.exec("update-project",{id:s,project:{label:i}})}}t.setState({stateEditableItem:null})}function bs(t,{currentValue:e,dropdown:n,targetDate:s}){const{stateEditableItem:i}=t.getState();t.setState({stateEditableItem:{...i,currentValue:e,dropdown:n,targetDate:s}})}function ws(t,e="data-id"){let n=t;if(t?.changedTouches){const{clientX:e,clientY:s}=t.changedTouches[0];n=document.elementFromPoint(e,s)}else!t.tagName&&t.target&&(n=t.target);for(;n;){if(n.getAttribute){if(n.getAttribute(e))return n}n=n.parentNode}return null}function _s(t,e="data-id"){const n=ws(t,e);return n?function(t,e="data-id"){const n=t.getAttribute(e),s=parseInt(n);return isNaN(s)||s.toString()!=n?n:s}(n,e):null}function Ss(t,e){if(t){if(t?.childNodes[0]){const n=document.createRange(),s=window.getSelection();let i=t?.childNodes[t?.childNodes.length-1];const o=i?.textContent?.length;let r=o;if("number"==typeof e){const n=t.childNodes;for(let t=0;t<n.length;t++){const s=n[t],o=s.textContent.length;if(o>=e){r=e,i=s;break}e-=o}}n.setStart(i,r),n.collapse(!0),s.removeAllRanges(),s.addRange(n)}setTimeout((()=>t.focus()))}}function js({store:t,id:e,$meta:n}){const s=t.getTask(e);if(!s||s.checked)return;const{taskShape:i}=t.getState();if(i?.completed?.taskHide){let s=null;const i=t.getParentIds(e),o=i[i.length-1],r=t.getChildren({filtered:!0,hideCompleted:!0}),a=r.findIndex((t=>Ke(t.id,o)));if(s=bn({store:t,id:e}),t.in.exec("check-task",{id:e,$meta:n}),t.getTask(o)?.checked){const t=r[a+1]?.id,e=r[a-1]?.id;s=tn(t)?t:e}else t.getTask(s)?.checked&&(s=bn({store:t,id:s}));tn(s)&&t.in.exec("select-task",{id:s})}else t.in.exec("check-task",{id:e,$meta:n})}function Ts({store:t}){let e;t.getState().selected.length>1&&(e={batch:Ye()}),t.eachSelected((n=>{const s=t.getTask(t.getTask(n).parent);!s?.selected&&function(t,e,n){const{treeTasks:s,filter:i,taskShape:o}=t.getState(),r=o?.completed?.taskHide,a=tn(i?.match),c=t.getNearId({id:e,dir:"next",flat:!0,filtered:a,hideCompleted:r}),l=t.getTask(c),d=t.getTask(e);if(Ke(s.at(-1).id,e)||!Ke(l?.parent,d?.parent))return;t.in.exec("move-task",{id:e,parent:d?.parent,targetId:c,$meta:n})}(t,n,e)}),!0,!0)}function Cs({store:t}){let e;t.getState().selected.length>1&&(e={batch:Ye()}),t.eachSelected((n=>{const s=t.getTask(t.getTask(n).parent);!s?.selected&&function(t,e,n){const{treeTasks:s,filter:i,taskShape:o}=t.getState(),r=o?.completed?.taskHide,a=tn(i?.match),c=t.getNearId({id:e,dir:"prev",flat:!0,filtered:a,hideCompleted:r}),l=t.getTask(c),d=t.getTask(e);if(Ke(s[0].id,e)||!Ke(l?.parent,d?.parent))return;t.in.exec("move-task",{id:e,targetId:c,parent:d?.parent,reverse:!0,$meta:n})}(t,n,e)}),!0)}function Is(t,{code:e,event:n}){const{selected:s,stateEditableItem:i,filter:o,stateSearch:r,menuState:a,stateDueDate:c,stateCombo:l}=t.getState(),d=tn(i?.id);switch(!tn(s.at(-1))||r?.focus||l?.open||function(t,e,n){const{selected:s,stateEditableItem:i,readonly:o,filter:r}=t.getState(),a=tn(i?.id),c=s.at(-1),l=t.getTask(c);if(i?.dropdown)return;if(!o)switch(e){case"shift+arrowup":Ds(t,"prev");break;case"shift+arrowdown":Ds(t,"next");break;case"shift+tab":n.preventDefault(),ds({store:t});break;case"tab":n.preventDefault(),ls({store:t});break;case"delete":case"backspace":a||os({store:t});break;case"enter":n.preventDefault(),a?!i?.currentValue&&tn(l.parent)?(t.in.exec("unindent-task",{id:i.id}),t.in.exec("open-inline-editor",{id:i.id,type:"task"})):t.in.exec("close-inline-editor",{id:i.id}):tn(r?.match)||is({store:t,task:l});break;case"ctrl+enter":!a&&t.in.exec("open-inline-editor",{id:c,type:"task"});break;case"ctrl+d":n.preventDefault(),as({store:t});break;case"ctrl+c":!window.getSelection().toString()?.length&&cs({store:t});break;case"ctrl+v":!a&&rs({store:t,id:c});break;case"ctrl+arrowup":Cs({store:t});break;case"ctrl+arrowdown":Ts({store:t});break;case"alt+0":us({store:t,priority:null});break;case"alt+1":us({store:t,priority:1});break;case"alt+2":us({store:t,priority:2});break;case"alt+3":us({store:t,priority:3})}switch(e){case"arrowup":Ms(t,"up");break;case"arrowdown":Ms(t,"down");break;case"arrowleft":Ms(t,"left");break;case"arrowright":Ms(t,"right");break;case"space":a||(n.preventDefault(),l?.checked?function({store:t}){let e;t.getState().selected.length>1&&(e={batch:Ye()}),t.eachSelected((n=>{t.getTask(n)?.checked&&t.in.exec("uncheck-task",{id:n,$meta:e})}),!0)}({store:t}):function({store:t}){let e;t.getState().selected.length>1&&(e={batch:Ye()}),t.eachSelected((n=>{js({store:t,id:n,$meta:e})}),!0)}({store:t}))}}(t,e,n),"project"===i?.type&&function(t,e,n){const{stateEditableItem:s,readonly:i}=t.getState(),o=tn(s?.id);if(!i&&"enter"===e)n.preventDefault(),o&&t.in.exec("close-inline-editor",{id:s.id})}(t,e,n),e){case"escape":a?t.in.exec("close-menu",{...a}):d?t.in.exec("close-inline-editor",{...i,save:!1}):c?.open||l?.open?(t.in.exec("set-state-due-date",{...c,open:!1}),t.in.exec("set-state-combo",{open:!1})):(o&&t.in.exec("set-filter",{match:null}),r?.open&&t.in.exec("set-state-search",{...r,value:null,open:!1,dropdown:{open:!1}}));break;case"ctrl+z":n.preventDefault(),t.undo();break;case"ctrl+shift+z":case"ctrl+y":n.preventDefault(),t.redo()}}function Ms(t,e){const{selected:n,treeTasks:s,stateEditableItem:i,filter:o,taskShape:r}=t.getState(),a=n.at(-1);if(tn(i?.id))return;if(!tn(a))return void t.in.exec("select-task",{id:s.at(0)?.id});const c=r?.completed?.taskHide,l=t.getTask(a),d=tn(o);let u;switch(e){case"up":u=t.getNearId({id:a,dir:"prev",filtered:d,hideCompleted:c});break;case"down":u=t.getNearId({id:a,filtered:d,hideCompleted:c});break;case"left":t.hasChildren(l.id,d,c)&&!l.collapsed?t.in.exec("collapse-task",{id:l.id}):u=l?.parent;break;case"right":t.hasChildren(l.id,d,c)&&l.collapsed&&t.in.exec("expand-task",{id:l.id})}tn(u)&&t.in.exec("select-task",{id:u})}function Ds(t,e="next"){const{selected:n,filter:s,taskShape:i}=t.getState(),o=i?.completed?.taskHide,r=tn(s),a=n.at(-1),c=t.getNearId({id:a,dir:e,filtered:r,hideCompleted:o});if(tn(c))if(n.length>1&&t.getTask(c)?.selected)t.in.exec("unselect-task",{id:a});else if(t.in.exec("select-task",{id:c,join:!0}),"next"===e){const e=t.getChildrenIds({id:c});for(const n of e)t.getTask(n)?.selected||t.in.exec("select-task",{id:n,join:!0})}}function Ps(t,e){const n="string"==typeof e?.match?e.match.trim():null;let s={match:n,by:"string"==typeof e?.by?e.by.trim():null,...e};e&&n?.length||(s=null),t.setState({filter:s})}function Es(t,e){if(!e)return;const n={by:e.by||"text",dir:e.dir||"asc",...e},{tasks:s,activeProject:i}=t.getState(),{treeTasks:o}=t.getInnerState(s,i,n);t.setState({treeTasks:o})}function Ns(t,{value:e,open:n,dropdown:s,focus:i}){const o=t.getState().stateSearch;t.setState({stateSearch:{value:e,open:tn(n)?n:o?.open,dropdown:tn(s)?s:o?.dropdown,focus:tn(i)?i:o?.focus}})}function As(t,e){t.setState({stateDueDate:e})}function Hs(t,e){t.setState({stateCombo:e})}function Ls(t,{start:e,mode:n}){if(!t.existsTask(e))return;const s=[];t.getTask(e).selected||t.in.exec("select-task",{id:e}),t.eachSelected((e=>{s.push(e);const n=t.getChildrenIds({id:e});for(const e of n){const n=t.getTask(e);n?.selected||s.push(e)}}),!0);for(let e=0;e<s.length;e++)t.updateTask({id:s[e],task:{draggable:!0},skipStateCalc:e!==s.length-1});t.setState({draggableIds:s,dragInfo:{mode:n}})}function Rs(t,{target:e,dropPosition:n,mode:s}){if(t.existsTask(e)){const i=t.getTask(e),o="move"===s?"move-task":"copy-task";if(!i.draggable&&"move"===s||"copy"===s){const s="bottom"===n,r=t.getSelection({sorted:!0}),a=r.filter((e=>{const n=t.getTask(e);return!r.some((e=>Ke(t.getTask(e).id,n.parent)))}));let c;r.length>1&&(c={batch:Ye()}),t.eachSelected(((s,r)=>{const l=t.getTask(t.getTask(s).parent);!l?.selected&&t.in.exec(o,{id:s,parent:"in"===n?e:i.parent,targetId:e,reverse:"top"===n,skipProvider:!!r,batch:!r&&a.length>1?a:null,$meta:c})}),!0,s)}}const{draggableIds:i}=t.getState();for(let e=0;e<i.length;e++)t.updateTask({id:i[e],task:{draggable:!1},skipStateCalc:e!==i.length-1});t.setState({draggableIds:[],dragInfo:null})}function Fs(t,{start:e,target:n,dropPosition:s}){const i=t.getState().drag?.expand;i&&t.getTask(n)?.collapsed&&t.in.exec("expand-task",{id:n});const o=t.getState().dragInfo;t.setState({dragInfo:{...o,start:e,target:n,dropPosition:s}})}function Os(t,e){return`${"function"==typeof e?e(t):t[e]}`}function zs(t,e){if(e.tree)for(const n of t)n.children?.length&&zs(n.children,e);t.sort(function({dir:t,by:e}){return(n,s)=>{const i=Os(n,e),o=Os(s,e);return"undefined"===i||"null"===i?1:"undefined"===o||"null"==o?-1:"desc"===t?o.localeCompare(i,void 0,{numeric:!0}):i.localeCompare(o,void 0,{numeric:!0})}}(e))}function qs(t,e){const n={};for(let t=0;t<e.length;t++){const s=e[t];n[s.id]={...s,color:s.color||dn[t%dn.length]}}t.setState({priorityMap:n})}!function(t){t[t.separator=0]="separator",t[t.datePart=1]="datePart"}(Wn||(Wn={}));class Bs extends Ge{constructor(t,e){super(t),cn(),this.in=new Ve,this.out=new Ve,this.in.setNext(this.out.exec),this.config={history:!0,...e||{}},this._router=new Je(super.setState.bind(this),[],{}),this._initStructure();const n={"add-task":wn,"update-task":_n,"move-task":Sn,"copy-task":jn,"paste-task":Tn,"delete-task":Cn,"clone-task":()=>{},"expand-task":In,"collapse-task":Mn,"check-task":Dn,"uncheck-task":Pn,"indent-task":En,"unindent-task":Nn,"add-project":Fn,"update-project":On,"set-project":zn,"delete-project":qn,"show-completed-tasks":An,"hide-completed-tasks":Hn,"select-task":Ln,"unselect-task":Rn,"open-menu":es,"close-menu":ns,"click-menu-item":$s,"assign-user":ks,"unassign-user":ys,"open-inline-editor":vs,"close-inline-editor":xs,"edit-item":bs,"keypress-on-todo":Is,"set-filter":Ps,"set-sort":Es,"set-state-search":Ns,"set-state-due-date":As,"set-state-combo":Hs,"start-drag":Ls,"end-drag":Rs,drag:Fs};this.in.on("set-filter",(()=>{const{tasks:t,activeProject:e,filter:n}=this.getState(),{treeTasks:s,childrenMap:i,filteredChildrenMap:o,tags:r}=this.getInnerState(t,e);n?.match&&xn(this),this.setState({treeTasks:s,childrenMap:i,filteredChildrenMap:o,tags:r})})),this._setHandlers(n)}init(t){this._router.init({id:null,selected:[],projects:[],tasks:[],users:[],tags:[],readonly:!1,taskShape:un,drag:pn,priorities:[],menu:null,treeTasks:[],copiedTasksId:[],defaultTags:[],tasksMap:null,usersMap:null,childrenMap:null,priorityMap:null,filteredChildrenMap:null,stateEditableItem:null,stateSearch:null,stateDueDate:null,stateCombo:null,draggableIds:[],dragInfo:null,filter:null,menuState:null,historyState:{undo:[],redo:[],batches:{}},...t});const{tasks:e,users:n,projects:s,tags:i,priorities:o}=this.getState();this.parse({tasks:e,users:n,projects:s,activeProject:t?.activeProject,tags:i}),qs(this,o)}undo(){const{historyState:t,activeProject:e}=this.getState(),n=this._findLastChange(t.undo,t.batches,e);if(n)if("object"==typeof n)n.undo(),t.redo.push({ev:n.ev,key:n.key,branchId:n.branchId});else if("number"==typeof n){const e=t.batches[n];for(let t=e.length-1;t>=0;t--)e[t].undo();t.redo.push(n)}this.setState({historyState:t})}redo(){const{historyState:t,activeProject:e}=this.getState(),n=[...t.redo],s=this._findLastChange(n,t.batches,e);if(s)if("object"==typeof s){const{ev:e,key:i}=s;this.in.exec(i,e),this.setState({historyState:{...t,redo:n}})}else if("number"==typeof s){const e=t.batches[s];delete t.batches[s],e.forEach((t=>{const{ev:e,key:n}=t;this.in.exec(n,e)})),this.setState({historyState:{...t,redo:n}})}}_findLastChange(t,e,n){const s=this.config.history;if("object"==typeof s&&!s.projects)return t.pop();for(let s=t.length-1;s>=0;s--){const i=t[s];if("number"==typeof i){const o=e[i];if("$allBranches"===o[0].branchId||o[0].branchId===n)return t.splice(s,1)[0]}else if("$allBranches"===i.branchId||i.branchId===n)return t.splice(s,1)[0]}}setState(t,e){this._router.setState(t,e)}getSelection({sorted:t=!1}={}){let e=this.getState().selected;if(t){const t=this.getState().tasks,n={};for(const s of e)n[t.findIndex((t=>Ke(t.id,s)))]=s;e=Object.values(n)}return e}eachSelected(t,e=!1,n=!1){const s=this.getSelection({sorted:e});if(n){let e=0;for(let n=s.length-1;n>=0;n--)t(s[n],e++)}else for(let e=0;e<s.length;e++)t(s[e],e)}serialize(){const{tasks:t,projects:e,users:n,tags:s,activeProject:i,priorities:o}=this.getState();for(const e of t)delete e.selected,delete e.draggable;return{tasks:[...t],projects:[...e],users:[...n],tags:[...s],priorities:[...o],activeProject:i}}parse(t){if(!function(t){return null!==t&&"object"==typeof t&&!(t instanceof Date)}(t))return;const e=this.getState();if(t.tasks&&(t.tasks=function(t,e){const n=new Date;return kn(t).map((t=>{const s=t.id??Ye().toString();return delete t.selected,delete t.draggable,t.checked&&!t.completion_date&&(t.completion_date=n),t.creation_date||(t.creation_date=n),e.some((t=>Ke(t,s)))&&(t.selected=!0),{...t,id:s}}))}(t.tasks,e.selected)),t.tags){const e=(t.tags||[]).map((t=>t.startsWith("#")?t:`#${t}`));this.setState({defaultTags:[...new Set(e)]})}const n=t.tasks||e.tasks||[],s=t.projects||e.projects||[],i=t.users||e.users||[],o=Array.isArray(t.priorities)?t.priorities:e.priorities;let r=e.activeProject;void 0!==t?.activeProject&&s.find((e=>Ke(e.id,t.activeProject)))||en(t.activeProject)?r=t.activeProject:s.find((t=>Ke(t.id,e.activeProject)))||(r=s[0]?.id||null);const{treeTasks:a,childrenMap:c,filteredChildrenMap:l,usersMap:d,tags:u}=this.getInnerState(n,r);this.setState({treeTasks:a,childrenMap:c,filteredChildrenMap:l,usersMap:d,tags:u,tasks:n,projects:s,users:i,activeProject:r,priorities:o}),t.priorities&&qs(this,o),this._setTasksMap(n)}existsTask(t){return t in this.getState().tasksMap}existsProject(t){return tn(this.getState().projects.find((e=>Ke(e.id,t)))?.id)}updateTask(t){const{id:e,task:n,skipStateCalc:s=!1}=t;if(!this.existsTask(e))return;let i;const o=this.getState(),r=o.tasksMap,a=o.tasks.map((s=>{if(Ke(e,s.id)){i={...s};const e=t.task={...s,...n,id:s.id};return r[s.id]=e,e}return s}));if(s)return this.setState({tasks:a,tasksMap:r}),i;const{treeTasks:c,childrenMap:l,filteredChildrenMap:d,usersMap:u,tags:p}=this.getInnerState(a,o.activeProject);return this.setState({tasks:a,treeTasks:c,childrenMap:l,filteredChildrenMap:d,usersMap:u,tags:p,tasksMap:r}),i}moveTask({id:t,project:e,parent:n,targetId:s,reverse:i,silent:o=!1}){if(!this.existsTask(t)||Ke(t,n)||Ke(t,s))return null;const r=this.getState(),a=this.getTask(t),c=this.existsTask(n),l=this.existsTask(s),d={...a};d.parent=n??null,en(e)||this.existsProject(e)?d.project=e:d.project=l?this.getTask(s).project:c?this.getTask(n).project:r?.activeProject,o?this.updateTask({id:t,task:d}):this.in.exec("update-task",{id:t,task:d,skipProvider:!0,skipStateCalc:!0,$meta:{skipHistory:!0}});const u=this.getChildrenIds({id:t,tree:!0}),p=u.length;if(void 0!==e&&this.hasChildren(t))for(let t=0;t<p;t++){const e=this.getTask(u[t]);"project"in e&&(o?this.updateTask({id:e.id,task:{...this.getTask(e.id),project:d.project}}):this.in.exec("update-task",{id:e.id,task:{...this.getTask(e.id),project:d.project},skipProvider:!0,skipStateCalc:!0,$meta:{skipHistory:!0}}))}const h=r.tasks,f=h.findIndex((e=>Ke(e.id,t))),m=h.splice(f,p+1);let g=i?0:r.tasks.length+1;if(c&&!tn(s)){const e=this.getChildrenIds({id:n,tree:!0}),s=e.length&&!i?e.at(-1):n;g=Ke(t,s)?f:h.findIndex((t=>Ke(t.id,s)))+1}if(l){const e=this.getChildrenIds({id:s,tree:!0});if(i)Ke(n,s)&&e.length&&!Ke(t,e[0])&&(s=e[0]),g=h.findIndex((t=>Ke(t.id,s)));else{for(let n=e.length-1;n>=0;n--){const i=e[n];if(!Ke(i,t)&&!u.some((t=>Ke(t,i)))){s=i;break}}g=h.findIndex((t=>Ke(t.id,s)))+1}}h.splice(g,0,...m);const{treeTasks:$,childrenMap:k,filteredChildrenMap:y,usersMap:v}=this.getInnerState(h,r.activeProject);return this.setState({tasks:h,treeTasks:$,childrenMap:k,filteredChildrenMap:y,usersMap:v}),this._setTasksMap(h),a}pasteTask({targetId:t,parent:e,project:n,reverse:s}){const{copiedTasksId:i}=this.getState(),o=(t,e)=>{const n=rn(this.getTask(t)),s=this.getChildren({id:t});if(n.id=Qe().toString(),n.parent=e,"selected"in n&&delete n.selected,"draggable"in n&&delete n.draggable,r.push(n),s.length)for(let t=0;t<s.length;t++)o(s[t].id,n.id);return n.id},r=[],a=[];for(const t of i)a.push(o(t,e));for(let i=0;i<r.length;i++){const o=r[i];0===i?this.in.exec("add-task",{task:o,id:o.id,parent:e,targetId:t,reverse:s,project:n,skipProvider:!0,$meta:{skipHistory:!0}}):this.in.exec("add-task",{task:o,id:o.id,parent:o.parent,targetId:r[i-1]?.id,project:n,skipProvider:!0,$meta:{skipHistory:!0}})}return r.length&&this.in.exec("clone-task",{parent:e,targetId:t,project:n,reverse:s,batch:r}),a}getTask(t){return this.getState().tasksMap[t]}getProject(t){return this.getState().projects.find((e=>Ke(e.id,t)))}getChildren({id:t,tree:e=!1,filtered:n=!1,hideCompleted:s=!1}){if(!this.existsTask(t)&&tn(t))return;let i=[];if(tn(t)){const s=this.getState()[n?"filteredChildrenMap":"childrenMap"][t];if(i=[...i,...s],e)for(let t=0;t<s.length;t++){const e=s[t];e?.children?.length&&(i=[...i,...this.getChildren({id:e.id,tree:!0,filtered:n})])}}else i=this.getState().treeTasks;return s?i.filter((t=>!t.checked)):i}getChildrenIds({id:t,tree:e=!0,filtered:n=!1,hideCompleted:s=!1}){if(!this.existsTask(t)&&tn(t))return;let i=[];const o=this.getChildren({id:t,tree:!1,filtered:n,hideCompleted:s});for(let t=0;t<o.length;t++){const r=o[t];i.push(r.id),r?.children?.length&&e&&(i=[...i,...this.getChildrenIds({id:r.id,tree:e,filtered:n,hideCompleted:s})])}return i}getParentIds(t){if(!this.existsTask(t))return;const e=[],n=this.getTask(t)?.parent;return this.existsTask(n)&&e.push(n,...this.getParentIds(n)),e}getTailId(t,e=!1,n=!1){const s=this.getChildrenIds({id:t,filtered:e,hideCompleted:n});return s.length?s.at(-1):t}hasChildren(t,e,n=!1){const s=this.getState()[e?"filteredChildrenMap":"childrenMap"];return!!(n?s[t]?.filter((t=>!t.checked)):s[t])?.length}getTreeIndex(t,e=!1,n=!1){const s=this.getTask(t);return this.getChildren({id:s?.parent,filtered:e,hideCompleted:n}).findIndex((e=>Ke(e.id,t)))}getNearId({id:t,dir:e="next",flat:n=!1,filtered:s=!1,hideCompleted:i=!1}){if(this.existsTask(t))return"next"===e?this._getNextId(t,n,!1,s,i):this._getPrevId(t,n,s,i)}getNearProjectId(t){const e=this.getState().projects,n=e.findIndex((e=>e.id===t));return n>0?e[n-1].id:e[n+1]?.id||null}getInnerState(t,e,n){const{users:s,filter:i,taskShape:o,defaultTags:r}=this.getState(),a=rn(t),c=new Set(r),l=function(t){const e={};t=rn(t);for(let n=0;n<t?.length;n++){const s=t[n];s.color=s.color||ln[n%ln.length],e[s.id]=s}return e}(s),d={},u={};let p={},h=[];for(let t=0;t<a.length;t++){const e=a[t];if(e.assigned?.length&&s?.length&&(e.availableUsers=vn(l,e)),d[a[t].id]=t,a[t].children=[],u[e.id]=[],e.text){const t=e.text.matchAll(mn("#"));for(const e of t)c.add(e[0])}}for(let t=0;t<a.length;t++){const e=a[t];e.parent&&u[e.parent]?(a[d[e.parent]].children.push(e),u[e.parent].push(e)):tn(e.parent)||h.push(e)}if(h=h.filter((t=>Ke(t.project,e))),n){const e=h.at(0)?.id;zs(h,n);const s=an(h),i=t.findIndex((t=>Ke(t.id,e)));t.splice(i,s.length,...s),this.setState({tasks:t})}tn(i)&&(h=$n(h,i),p=function(t){const e={},n=t=>{for(let s=0;s<t.length;s++){const i=t[s];e[i.id]||(e[i.id]=[...i?.children]),i?.children?.length&&n(i.children)}};return n(t),e}(h));for(let t=0;t<h.length;t++)yn(h[t],u,o);return{treeTasks:h,childrenMap:u,usersMap:l,filteredChildrenMap:p,tags:[...c]}}_setTasksMap(t){const e={};for(const n of t)e[n.id]=n;this.setState({tasksMap:e})}_setHandlers(t){const{historyState:e}=this.getState();Object.keys(t).forEach((n=>{this.in.on(n,(s=>{var i,o;const r=t[n](this,s),a=s?.$meta;if(this.config.history&&r&&!a?.skipHistory){const t=this.getState().activeProject;a?.batch?((i=e.batches)[o=a.batch]??(i[o]=[]),e.batches[a.batch].push({undo:r,key:n,ev:s,branchId:a?.branchId||t}),e.undo.includes(a.batch)||e.undo.push(a.batch)):e.undo.push({undo:r,key:n,ev:s,branchId:a?.branchId||t}),"object"==typeof this.config.history&&e.undo.length>this.config.history.limit&&e.undo.shift(),e.redo.forEach((t=>{"string"==typeof t&&delete e.batches[t]})),e.redo=[],this.setState({historyState:e})}}))}))}_initStructure(){this.setState({id:null,selected:[],projects:[],tasks:[],users:[],tags:[],readonly:!1,taskShape:un,drag:pn,priorities:[],treeTasks:[],copiedTasksId:[],defaultTags:[],tasksMap:null,usersMap:null,childrenMap:null,priorityMap:null,filteredChildrenMap:null,stateEditableItem:null,stateSearch:null,stateDueDate:null,stateCombo:null,draggableIds:[],dragInfo:null,filter:null,menu:null,historyState:{undo:[],redo:[],batches:{}}})}_getNextId(t,e=!1,n=!1,s=!1,i=!1){const o=this.getTask(t),r=this.hasChildren(t,s,i);if(e||!r||o.collapsed||n){const n=this.getTask(o?.parent)?.id,r=this.getChildren({id:n,filtered:s,hideCompleted:i}),a=nn(r,(e=>Ke(e.id,t)));return a+1<r.length?r[a+1]?.id:tn(n)?this._getNextId(n,e,!0,s,i):null}return this.getChildren({id:t,filtered:s,hideCompleted:i})[0]?.id}_getPrevId(t,e=!1,n=!1,s=!1){const i=this.getTreeIndex(t,n,s),o=this.getTask(t)?.parent;if(i>0){let t=this.getChildren({id:o,filtered:n,hideCompleted:s})[i-1];if(!this.hasChildren(t.id,n,s)||t.collapsed)return t.id;for(;!e&&this.hasChildren(t.id,n,s)&&!t.collapsed;){const e=this.getChildren({id:t.id,filtered:n,hideCompleted:s});t=e[e.length-1]}return t.id}return tn(o)?o:null}}function Ys(t,e){return t.filter((t=>t.includes(e))).map((t=>({label:t,id:t})))}const Js=(t=[],e)=>t.map((t=>(t?.label&&(t.label=e(t.label)),t?.data&&Js(t.data,e),t))),Ws=t=>{const e={},n=["monthShort","monthFull","dayShort","dayFull"];for(const s of n)e[s]=t(s);return e};function Gs(t,e){if(!0===t)return!0;if(t){const n=t(e);return Array.isArray(n)?!!n.length:n}return!1}function Vs(t,e){let n;const s=e.api,i=e.readonly,o=t=>{n=t.target},r=t=>{const e=_s(n,"data-list-id"),o=n===t.target,{stateEditableItem:r}=s.getState();if(!Ke(r?.id,e)&&o){const o=_s(n,"data-menu-id"),r=2===t.button,a=s.getSelection();let c=t.ctrlKey||t.metaKey,l=t.shiftKey;if(i&&(c=l=!1),r&&a.some((t=>Ke(t,e)))||o&&a.some((t=>Ke(t,o))))return;!function({id:t,api:e,ctrlMode:n,shiftMode:s}){const{selected:i,treeTasks:o,taskShape:r}=e.getState();if(!tn(t))return void e.eachSelected((t=>{e.exec("unselect-task",{id:t})}));const a=e.getTask({id:t});if(n&&a?.selected){e.exec("unselect-task",{id:t});const n=e.getParentIds({id:t});for(const t of n){const n=e.getTask({id:t});n?.selected&&e.exec("unselect-task",{id:t})}return}if(a?.selected)return void(n||s||e.eachSelected((n=>{Ke(n,t)||e.exec("unselect-task",{id:n})})));e.exec("select-task",{id:t,join:n||s}),(n||s)&&Us(e,t);if(!n&&s&&i.length>1){const n=r?.completed?.taskHide,s=n?an(o).filter((t=>!t.checked)):an(o),a=i[0],c=s.findIndex((t=>Ke(t.id,a))),l=s.findIndex((e=>Ke(e.id,t)));if(c<0||l<0)return;if(c<l)for(let t=c+1;t<l;t++){const n=s[t];n?.selected||(e.exec("select-task",{id:n.id,join:!0}),Us(e,n.id))}else if(c>l)for(let t=c-1;t>l;t--){const n=s[t];n?.selected||(e.exec("select-task",{id:n.id,join:!0}),Us(e,n.id))}}}({id:e,api:s,ctrlMode:c,shiftMode:l}),t.stopPropagation(),document.getSelection().removeAllRanges()}};return t.addEventListener("mousedown",o),t.addEventListener("mouseup",r),{destroy(){t.removeEventListener("mousedown",o),t.removeEventListener("mouseup",r)}}}function Us(t,e){const n=t.getChildrenIds({id:e});for(const e of n){const n=t.getTask({id:e});!n?.selected&&t.exec("select-task",{id:e,join:!0})}}function Xs(t,e){if(e?.readonly)return;const n=e.api;let s,i,o,r=null,a=null,c=null,l=null,d=null,u=null,p=[],h=null,f=null,m=null,g={},$=null,k=!1,y=!1;const v={duration:500,timer:null,callback:null},x=t=>{if(i&&clearTimeout(i),a){const e=50,n=a.getBoundingClientRect(),s={x:a.scrollLeft,y:a.scrollTop},{x:o,y:r}=Zs(t);o>n.width+n.left-e&&a.scrollTo(s.x+e,s.y),o<n.left+e&&a.scrollTo(s.x-e,s.y),r>n.height+n.top-e&&a.scrollTo(s.x,s.y+e),r<n.top+e&&a.scrollTo(s.x,s.y-e),i=setTimeout((()=>{x(t)}),100)}},b=t=>{s=M(t),S(s),(t=>{const{x:e,y:s}=Zs(t),i=document.elementFromPoint(e,s);i&&i.dataset.separator||(d=i?ws(i,"data-drag-list-id"):null,f=d?_s(d,"data-drag-list-id"):null,"move"===$&&n.getTask({id:f})?.draggable&&(f=null))})(t),m=tn(f)?function(t,e){if(!e)return null;const{top:n,height:s}=e.getBoundingClientRect(),i=(Zs(t).y-n)/s;return i<=.25?"top":i>=.75?"bottom":"in"}(t,d):null,f?w(m):_(),n.exec("drag",{start:h,source:p,target:f,dropPosition:m})},w=t=>{r.contains(u)||(u=document.createElement("div"),u.classList.add("wx-todo_dropped-line"),r.appendChild(u));const e=d.getBoundingClientRect();if("in"===t)return u.style.opacity="0.5",u.style.width=e.width+"px",u.style.height=e.height+"px",u.style.left=e.x+"px",void(u.style.top=e.y+"px");const s=getComputedStyle(d),i=n.hasChildren({id:f,filtered:k,hideCompleted:y}),o=i?16:40,a=parseInt(d.dataset.listLevel),c=1===a?"top"===t?-6.5:6.5:0,l="top"===t?0:parseFloat(s.height),p=parseFloat(s.paddingLeft)-(1===a?o:0),h=e.width-p;u.style.opacity="1",u.style.width=h+"px",u.style.height="4px";let m=0;if("bottom"===t&&i){const t=d.parentElement.getBoundingClientRect();m=1===a?t.height-l-c-4-4:t.height-l}u.style.top=e.y+l+c+m-2+"px",u.style.left=e.x+p+"px"},_=()=>{r.contains(u)&&r.removeChild(u)},S=({x:t,y:e})=>{l.style.left=t+"px",l.style.top=e+"px"},j=t=>{const e=n.hasChildren({id:f,filtered:k,hideCompleted:y})?16:40;p.length>1&&r.style.setProperty("--wx-todo-dragged-tasks-count",JSON.stringify(p.length<99?`${p.length}`:"+99")),s=M(t),r.appendChild(l),l.classList.add("wx-todo__dragged-task"),l.style.paddingLeft=e+"px",l.style.left=s.x+"px",l.style.top=s.y+"px"},T=t=>{const{stateEditableItem:s,menuState:i,stateDueDate:d}=n.getState(),u=t.ctrlKey||t.metaKey,p=t.shiftKey,f=tn(s);if(!(u||p||f||d?.open||i||t.touches&&t.touches.length>1||"button"in t&&0!==t.button)){if(r=document.querySelector(".wx-todo"),a=document.querySelector(`[data-todo-wrapper-id="${e.id}"]`),c=ws(t.target,"data-drag-list-id"),h=_s(t.target,"data-drag-list-id"),o="touches"in t?{up:"touchend",move:"touchmove"}:{up:"pointerup",move:"mousemove"},c&&a){k=!!n.getState().filter?.match,y=n.getState().taskShape?.completed?.taskHide;const e=c.getBoundingClientRect(),s=getComputedStyle(c),i=n.hasChildren({id:h,filtered:k,hideCompleted:y})?16:40,r=parseInt(s.paddingLeft)-i;l=c.cloneNode(!0),l.style.width=e.width-r+"px",l.style.height=e.height+"px";const{x:a,y:d}=g=Zs(t);g.shiftX=a-e.x-r,g.shiftY=d-e.y,"touches"in t?(v.callback=()=>{document.addEventListener(o.move,C)},v.timer=setTimeout(v.callback,v.duration)):document.addEventListener(o.move,C)}document.addEventListener(o.up,I)}},C=t=>{g&&("touches"in t||t.preventDefault(),t.stopPropagation(),x(t),p?.length?b(t):(t=>{const{x:e,y:s}=Zs(t);g?.x===e&&g?.y===s||tn(h)&&($=t.altKey?"copy":"move",n.exec("start-drag",{start:h,mode:$}),p=n.getState().draggableIds,j(t),document.body.classList.add("wx-ondrag"),"touches"in t&&document.body.classList.add("wx-ondrag--touch"))})(t))},I=()=>{document.removeEventListener(o.move,C),document.removeEventListener(o.up,I),v.timer&&clearTimeout(v.timer),r.contains(l)&&(r.removeChild(l),r.style.removeProperty("--wx-todo-dragged-tasks-count")),_(),i&&clearTimeout(i),p.length&&(p=[],n.exec("end-drag",{target:f,dropPosition:m,mode:$})),document.body.classList.remove("wx-ondrag"),document.body.classList.remove("wx-ondrag--touch"),r=c=l=u=d=a=s=f=h=g=null},M=t=>{const{x:e,y:n}=Zs(t);return{x:e-g.shiftX,y:n-g.shiftY}};return t.addEventListener("mousedown",T),t.addEventListener("touchstart",T),{destroy(){t.removeEventListener("mousedown",T),t.removeEventListener("touchstart",T)}}}function Zs(t){const e={x:0,y:0};return"touches"in t?(e.x=t.touches[0].clientX,e.y=t.touches[0].clientY):(e.x=t.clientX,e.y=t.clientY),e}function Qs(t,e){if(e.readonly)return;const n=t=>{const n=t.target,s=2===t.button;if(n||s){!function({api:t,id:e,menuId:n,context:s}){const{menuState:i,menu:o}=t.getState(),r=t.getSelection({sorted:!0});i&&"task"===i.type&&t.exec("close-menu",{...i});if(r.length&&(s||tn(n))){Gs(o,{store:t.getStores().state,type:"task",source:r})&&t.exec("open-menu",{id:e,type:"task",source:r})}}({id:_s(n,"data-list-id"),menuId:_s(n,"data-menu-id"),api:e.api,context:s})}};return t.addEventListener("click",n),t.addEventListener("contextmenu",n),{destroy(){t.removeEventListener("click",n),t.removeEventListener("contextmenu",n)}}}function Ks(t,e){const n=t=>{const n=ws(t,"data-user-menu-id"),{menuState:s,draggableIds:i,menu:o}=e.api.getState();if(n&&!i.length){const i=_s(t,"data-user-menu-id");if((!s||s&&!Ke(s.id,i))&&(s&&e.api.exec("close-menu",{...s}),Gs(o,{type:"user"}))){const t=n.getBoundingClientRect();e.api.exec("open-menu",{id:i,type:"user",coords:{x:t.left,y:t.bottom}})}t.stopPropagation()}else s&&"user"===s.type&&e.api.exec("close-menu",{...s})};return t.addEventListener("pointerover",n),{destroy(){t.removeEventListener("pointerover",n)}}}function ti(t,e){const n=t=>{const n=_s(t.target,"data-tag");n&&(e.api.exec("set-filter",{match:n,highlight:!0,strict:!0}),e.api.exec("set-state-search",{value:n,open:!0,focus:!1,dropdown:{open:!1}}),t.stopPropagation())};return t.addEventListener("click",n),{destroy(){t.removeEventListener("click",n)}}}function ei(t,e){if(e.readonly)return;const n=e.api,s=t=>{const e=_s(t.target,"data-list-editor-id"),s=_s(t.target,"data-date"),{stateEditableItem:i}=n.getState();s&&!tn(i)&&n.exec("open-inline-editor",{id:e,type:"task",targetDate:s}),"task"!==i?.type||Ke(i?.id,e)||i?.dropdown||n.exec("close-inline-editor",{id:i.id,save:!0})},i=t=>{const e=_s(t.target,"data-list-editor-id"),{stateEditableItem:s}=n.getState();Ke(s?.id,e)||n.exec("open-inline-editor",{id:e,type:"task"})};return t.addEventListener("click",s),t.addEventListener("dblclick",i),{destroy(){t.removeEventListener("click",s),t.removeEventListener("dblclick",i)}}}function ni(t,e){let n;const s=t=>{n=_s(t,"data-todo-id")},i=t=>{Ke(e.widgetId,n)&&e.api.exec("keypress-on-todo",{code:si(t),event:t})};return t.addEventListener("mousedown",s),t.addEventListener("focusin",s),t.addEventListener("keydown",i),{destroy(){t.removeEventListener("mousedown",s),t.removeEventListener("focusin",s),t.removeEventListener("keydown",i)}}}function si(t){const e=[];let n=t?.code.toLowerCase();const s=t?.key.toLowerCase(),i=n.startsWith("key"),o=n.startsWith("digit"),r=n.startsWith("numpad");return(t.ctrlKey||t.metaKey)&&e.push("ctrl"),t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),i&&(n=n.replace("key","")),o&&(n=n.replace("digit","")),r&&(n=n.replace("numpad","")),["control","alt","shift"].includes(s)||e.push(n),e.join("+")}function ii(t,e){t.forEach((t=>{e(t),t.data&&t.data.length&&ii(t.data,e)}))}let oi=1;function ri(t){return ii(t,(t=>{t.id=t.id||oi++})),t}const ai={};function ci(t){return ai[t]}function li(t,e){ai[t]=e}function di(t){let e,n;return{c(){e=T("i"),E(e,"class",n="icon "+t[0].icon+" svelte-bbgn98")},m(t,n){_(t,e,n)},p(t,s){1&s&&n!==(n="icon "+t[0].icon+" svelte-bbgn98")&&E(e,"class",n)},d(t){t&&S(e)}}}function ui(t){let e,n,s=t[0].text+"";return{c(){e=T("span"),n=C(s),E(e,"class","value svelte-bbgn98")},m(t,s){_(t,e,s),w(e,n)},p(t,e){1&e&&s!==(s=t[0].text+"")&&N(n,s)},i:i,o:i,d(t){t&&S(e)}}}function pi(t){let e,n,s;var i=ci(t[0].type);function o(t){return{props:{item:t[0]}}}return i&&(e=F(i,o(t))),{c(){e&&$t(e.$$.fragment),n=M()},m(t,i){e&&kt(e,t,i),_(t,n,i),s=!0},p(t,s){const r={};if(1&s&&(r.item=t[0]),1&s&&i!==(i=ci(t[0].type))){if(e){lt();const t=e;pt(t.$$.fragment,1,0,(()=>{yt(t,1)})),dt()}i?(e=F(i,o(t)),$t(e.$$.fragment),ut(e.$$.fragment,1),kt(e,n.parentNode,n)):e=null}else i&&e.$set(r)},i(t){s||(e&&ut(e.$$.fragment,t),s=!0)},o(t){e&&pt(e.$$.fragment,t),s=!1},d(t){t&&S(n),e&&yt(e,t)}}}function hi(t){let e,n,s=t[0].subtext+"";return{c(){e=T("span"),n=C(s),E(e,"class","subtext svelte-bbgn98")},m(t,s){_(t,e,s),w(e,n)},p(t,e){1&e&&s!==(s=t[0].subtext+"")&&N(n,s)},d(t){t&&S(e)}}}function fi(t){let e;return{c(){e=T("i"),E(e,"class","sub-icon wxi-angle-right svelte-bbgn98")},m(t,n){_(t,e,n)},d(t){t&&S(e)}}}function mi(t){let e,n,s,i,o,r,a,l,d,u,p,h=t[0].icon&&di(t);const f=[pi,ui],m=[];function g(t,e){return t[0].type?0:1}s=g(t),i=m[s]=f[s](t);let $=t[0].subtext&&hi(t),k=t[0].data&&fi();return{c(){e=T("div"),h&&h.c(),n=I(),i.c(),o=I(),$&&$.c(),r=I(),k&&k.c(),E(e,"class",a="item "+(t[0].css||"")+" svelte-bbgn98"),E(e,"data-id",l=t[0].id)},m(i,a){_(i,e,a),h&&h.m(e,null),w(e,n),m[s].m(e,null),w(e,o),$&&$.m(e,null),w(e,r),k&&k.m(e,null),d=!0,u||(p=[D(e,"mouseenter",t[1]),D(e,"click",t[4])],u=!0)},p(t,[c]){t[0].icon?h?h.p(t,c):(h=di(t),h.c(),h.m(e,n)):h&&(h.d(1),h=null);let u=s;s=g(t),s===u?m[s].p(t,c):(lt(),pt(m[u],1,1,(()=>{m[u]=null})),dt(),i=m[s],i?i.p(t,c):(i=m[s]=f[s](t),i.c()),ut(i,1),i.m(e,o)),t[0].subtext?$?$.p(t,c):($=hi(t),$.c(),$.m(e,r)):$&&($.d(1),$=null),t[0].data?k||(k=fi(),k.c(),k.m(e,null)):k&&(k.d(1),k=null),(!d||1&c&&a!==(a="item "+(t[0].css||"")+" svelte-bbgn98"))&&E(e,"class",a),(!d||1&c&&l!==(l=t[0].id))&&E(e,"data-id",l)},i(t){d||(ut(i),d=!0)},o(t){pt(i),d=!1},d(t){t&&S(e),h&&h.d(),m[s].d(),$&&$.d(),k&&k.d(),u=!1,c(p)}}}function gi(t,e,n){let{item:s}=e,{showSub:i=!1}=e,{activeItem:o=null}=e;return t.$$set=t=>{"item"in t&&n(0,s=t.item),"showSub"in t&&n(2,i=t.showSub),"activeItem"in t&&n(3,o=t.activeItem)},[s,function(){n(2,i=!!s.data&&s.id),n(3,o=this)},i,o,function(e){V.call(this,t,e)}]}class $i extends bt{constructor(t){super(),xt(this,t,gi,mi,d,{item:0,showSub:2,activeItem:3})}}function ki(t,e,n){const s=t.slice();return s[27]=e[n],s}function yi(t){let e,n,s,i;function o(e){t[14](e)}function r(e){t[15](e)}let a={item:t[27]};return void 0!==t[5]&&(a.showSub=t[5]),void 0!==t[6]&&(a.activeItem=t[6]),e=new $i({props:a}),X.push((()=>gt(e,"showSub",o))),X.push((()=>gt(e,"activeItem",r))),e.$on("click",(function(...e){return t[16](t[27],...e)})),{c(){$t(e.$$.fragment)},m(t,n){kt(e,t,n),i=!0},p(i,o){t=i;const r={};4&o&&(r.item=t[27]),!n&&32&o&&(n=!0,r.showSub=t[5],nt((()=>n=!1))),!s&&64&o&&(s=!0,r.activeItem=t[6],nt((()=>s=!1))),e.$set(r)},i(t){i||(ut(e.$$.fragment,t),i=!0)},o(t){pt(e.$$.fragment,t),i=!1},d(t){yt(e,t)}}}function vi(t){let e;return{c(){e=T("div"),E(e,"class","separator svelte-mlcdop")},m(t,n){_(t,e,n)},p:i,i:i,o:i,d(t){t&&S(e)}}}function xi(t){let e,n;return e=new Si({props:{options:t[27].data,at:"right-overlap",parent:t[6]}}),e.$on("click",t[17]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.options=t[27].data),64&n&&(s.parent=t[6]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function bi(t,e){let n,s,i,o,r,a;const c=[vi,yi],l=[];function d(t,e){return"separator"===t[27].type?0:1}s=d(e),i=l[s]=c[s](e);let u=e[27].data&&e[5]===e[27].id&&xi(e);return{key:t,first:null,c(){n=M(),i.c(),o=I(),u&&u.c(),r=M(),this.first=n},m(t,e){_(t,n,e),l[s].m(t,e),_(t,o,e),u&&u.m(t,e),_(t,r,e),a=!0},p(t,n){let a=s;s=d(e=t),s===a?l[s].p(e,n):(lt(),pt(l[a],1,1,(()=>{l[a]=null})),dt(),i=l[s],i?i.p(e,n):(i=l[s]=c[s](e),i.c()),ut(i,1),i.m(o.parentNode,o)),e[27].data&&e[5]===e[27].id?u?(u.p(e,n),36&n&&ut(u,1)):(u=xi(e),u.c(),ut(u,1),u.m(r.parentNode,r)):u&&(lt(),pt(u,1,1,(()=>{u=null})),dt())},i(t){a||(ut(i),ut(u),a=!0)},o(t){pt(i),pt(u),a=!1},d(t){t&&S(n),l[s].d(t),t&&S(o),u&&u.d(t),t&&S(r)}}}function wi(e){let n,s,i,o,r=[],a=new Map,l=e[2];const d=t=>t[27].id;for(let t=0;t<l.length;t+=1){let n=ki(e,l,t),s=d(n);a.set(s,r[t]=bi(s,n))}return{c(){n=T("div");for(let t=0;t<r.length;t+=1)r[t].c();E(n,"data-wx-menu","true"),E(n,"class","menu svelte-mlcdop"),H(n,"top",e[1]+"px"),H(n,"left",e[0]+"px"),H(n,"width",e[4])},m(a,c){_(a,n,c);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(n,null);e[18](n),s=!0,i||(o=[x(t.call(null,n,e[10])),D(n,"mouseleave",e[9])],i=!0)},p(t,[e]){364&e&&(l=t[2],lt(),r=mt(r,e,d,1,t,l,a,n,ft,bi,null,ki),dt()),(!s||2&e)&&H(n,"top",t[1]+"px"),(!s||1&e)&&H(n,"left",t[0]+"px"),(!s||16&e)&&H(n,"width",t[4])},i(t){if(!s){for(let t=0;t<l.length;t+=1)ut(r[t]);s=!0}},o(t){for(let t=0;t<r.length;t+=1)pt(r[t]);s=!1},d(t){t&&S(n);for(let t=0;t<r.length;t+=1)r[t].d();e[18](null),i=!1,c(o)}}}function _i(t,e,n){const s=J();let i,o,r,a,c,l,d,u,p,h,f,{options:m}=e,{left:g=0}=e,{top:$=0}=e,{at:k="bottom"}=e,{parent:y=null}=e,{mount:v}=e,{context:x=null}=e;function b(){if(!f)return;const t=function(t){for(;t;){t=t.parentNode;const e=getComputedStyle(t).position;if(t===document.body||"relative"===e||"absolute"===e)return t}return null}(f),e=u?document.body:t;if(!t)return;const s=t.getBoundingClientRect(),p=f.getBoundingClientRect(),h=e.getBoundingClientRect();if(y&&"point"!==k){o=y.getBoundingClientRect();let t=u?0:1;n(0,g=l?o.right+t:o.left-t),n(1,$=r?o.bottom+1:o.top),n(4,i=c?o.width+"px":"auto")}let m=a;d&&n(1,$=o.top-p.height);const v=$+p.height-h.bottom;v>0&&n(1,$-=v);g+p.width-h.right>0&&(l?m=!0:n(0,g=o.right-p.width)),m&&n(0,g=o.left-p.width),g<0&&n(0,g="left"!==k?0:o.right),n(0,g+=e.scrollLeft-s.left),n(1,$+=e.scrollTop-s.top)}v&&v(b),B(b);return t.$$set=t=>{"options"in t&&n(2,m=t.options),"left"in t&&n(0,g=t.left),"top"in t&&n(1,$=t.top),"at"in t&&n(11,k=t.at),"parent"in t&&n(12,y=t.parent),"mount"in t&&n(13,v=t.mount),"context"in t&&n(3,x=t.context)},t.$$.update=()=>{4&t.$$.dirty&&ri(m),2048&t.$$.dirty&&(r=-1!==k.indexOf("bottom"),a=-1!==k.indexOf("left"),l=-1!==k.indexOf("right"),d=-1!==k.indexOf("top"),u=-1!==k.indexOf("overlap"),c=-1!==k.indexOf("fit")),4096&t.$$.dirty&&b()},[g,$,m,x,i,p,h,f,s,function(){n(5,p=!1)},function(){s("click",{action:null})},k,y,v,function(t){p=t,n(5,p)},function(t){h=t,n(6,h)},(t,e)=>{if(!t.data&&!e.defaultPrevented){const e={context:x,action:t};t.handler&&t.handler(e),s("click",e)}},function(e){V.call(this,t,e)},function(t){X[t?"unshift":"push"]((()=>{f=t,n(7,f)}))}]}class Si extends bt{constructor(t){super(),xt(this,t,_i,wi,d,{options:2,left:0,top:1,at:11,parent:12,mount:13,context:3})}}function ji(t){let e,n,s,o;return{c(){e=T("i"),E(e,"class",n="wx-todo_icon wxi wxi-"+t[0]+" "+(t[4]?t[4]:"wx-todo_icon--default")+" svelte-1dloatb"),H(e,"font-size",t[1]+"px"),H(e,"height",t[1]+"px"),H(e,"width",t[1]+"px"),L(e,"wx-todo_icon--clickable",t[2]),L(e,"wx-todo_icon--disabled",t[3])},m(n,i){_(n,e,i),s||(o=D(e,"click",t[5]),s=!0)},p(t,[s]){17&s&&n!==(n="wx-todo_icon wxi wxi-"+t[0]+" "+(t[4]?t[4]:"wx-todo_icon--default")+" svelte-1dloatb")&&E(e,"class",n),2&s&&H(e,"font-size",t[1]+"px"),2&s&&H(e,"height",t[1]+"px"),2&s&&H(e,"width",t[1]+"px"),21&s&&L(e,"wx-todo_icon--clickable",t[2]),25&s&&L(e,"wx-todo_icon--disabled",t[3])},i:i,o:i,d(t){t&&S(e),s=!1,o()}}}function Ti(t,e,n){let{name:s}=e,{size:i=20}=e,{clickable:o=!1}=e,{disabled:r=!1}=e,{css:a=""}=e;return t.$$set=t=>{"name"in t&&n(0,s=t.name),"size"in t&&n(1,i=t.size),"clickable"in t&&n(2,o=t.clickable),"disabled"in t&&n(3,r=t.disabled),"css"in t&&n(4,a=t.css)},[s,i,o,r,a,function(e){V.call(this,t,e)}]}class Ci extends bt{constructor(t){super(),xt(this,t,Ti,ji,d,{name:0,size:1,clickable:2,disabled:3,css:4})}}function Ii(t){let e,n;return e=new Ci({props:{name:t[1]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.name=t[1]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Mi(t){let e,n;return{c(){e=T("div"),n=C(t[2]),E(e,"class","wx-todo_item__hotkey svelte-18hs7sv")},m(t,s){_(t,e,s),w(e,n)},p(t,e){4&e&&N(n,t[2])},d(t){t&&S(e)}}}function Di(t){let e,n,s;return n=new Ci({props:{name:"menu-right"}}),{c(){e=T("div"),$t(n.$$.fragment),E(e,"class","wx-todo_item__sub-icon svelte-18hs7sv")},m(t,i){_(t,e,i),kt(n,e,null),s=!0},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&S(e),yt(n)}}}function Pi(t){let e,n,s,i,o,r,a,c=t[1]&&Ii(t),l=t[2]&&Mi(t),d=t[0]?.length&&Di();return{c(){e=T("div"),c&&c.c(),n=I(),s=T("div"),i=C(t[3]),o=I(),l&&l.c(),r=I(),d&&d.c(),E(s,"class","wx-todo_item__label svelte-18hs7sv"),E(e,"class","wx-todo_item svelte-18hs7sv")},m(t,u){_(t,e,u),c&&c.m(e,null),w(e,n),w(e,s),w(s,i),w(e,o),l&&l.m(e,null),w(e,r),d&&d.m(e,null),a=!0},p(t,[s]){t[1]?c?(c.p(t,s),2&s&&ut(c,1)):(c=Ii(t),c.c(),ut(c,1),c.m(e,n)):c&&(lt(),pt(c,1,1,(()=>{c=null})),dt()),(!a||8&s)&&N(i,t[3]),t[2]?l?l.p(t,s):(l=Mi(t),l.c(),l.m(e,r)):l&&(l.d(1),l=null),t[0]?.length?d?1&s&&ut(d,1):(d=Di(),d.c(),ut(d,1),d.m(e,null)):d&&(lt(),pt(d,1,1,(()=>{d=null})),dt())},i(t){a||(ut(c),ut(d),a=!0)},o(t){pt(c),pt(d),a=!1},d(t){t&&S(e),c&&c.d(),l&&l.d(),d&&d.d()}}}function Ei(t,e,n){let s,i,o,r,{item:a}=e;return t.$$set=t=>{"item"in t&&n(4,a=t.item)},t.$$.update=()=>{16&t.$$.dirty&&n(3,s=a.label),16&t.$$.dirty&&n(2,i=a.hotkey),16&t.$$.dirty&&n(1,o=a.icon),16&t.$$.dirty&&n(0,r=a.data)},[r,o,i,s,a]}class Ni extends bt{constructor(t){super(),xt(this,t,Ei,Pi,d,{item:4})}}function Ai(t){let e,n,s;return{c(){e=T("div"),n=C(t[0]),E(e,"class","wx-todo_avatar svelte-2w6inz"),E(e,"style",s=t[3](t[2],t[1]))},m(t,s){_(t,e,s),w(e,n)},p(t,[i]){1&i&&N(n,t[0]),6&i&&s!==(s=t[3](t[2],t[1]))&&E(e,"style",s)},i:i,o:i,d(t){t&&S(e)}}}function Hi(t,e,n){let{value:s=""}=e,{avatar:i=""}=e,{color:o="#0AB169"}=e;return t.$$set=t=>{"value"in t&&n(0,s=t.value),"avatar"in t&&n(1,i=t.avatar),"color"in t&&n(2,o=t.color)},[s,i,o,(t,e)=>{let n=`background-color: ${t};`;return e&&(n+=`background-image: url(${e});`),n}]}class Li extends bt{constructor(t){super(),xt(this,t,Hi,Ai,d,{value:0,avatar:1,color:2})}}function Ri(t){let e,n;return e=new Ci({props:{name:t[4]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};16&n&&(s.name=t[4]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Fi(t){let e,n,s,i,o,r,a,c,l=t[4]&&Ri(t);return i=new Li({props:{avatar:t[2],color:t[3]}}),{c(){e=T("div"),l&&l.c(),n=I(),s=T("div"),$t(i.$$.fragment),o=I(),r=T("div"),a=C(t[5]),E(s,"class","wx-todo_user-item__avatar svelte-2s0u9f"),E(r,"class","wx-todo_user-item__label svelte-2s0u9f"),E(e,"class","wx-todo_user-item svelte-2s0u9f"),L(e,"wx-todo_user-item--checked",t[1]),L(e,"wx-todo_user-item--clickable",t[0])},m(t,d){_(t,e,d),l&&l.m(e,null),w(e,n),w(e,s),kt(i,s,null),w(e,o),w(e,r),w(r,a),c=!0},p(t,[s]){t[4]?l?(l.p(t,s),16&s&&ut(l,1)):(l=Ri(t),l.c(),ut(l,1),l.m(e,n)):l&&(lt(),pt(l,1,1,(()=>{l=null})),dt());const o={};4&s&&(o.avatar=t[2]),8&s&&(o.color=t[3]),i.$set(o),(!c||32&s)&&N(a,t[5]),(!c||2&s)&&L(e,"wx-todo_user-item--checked",t[1]),(!c||1&s)&&L(e,"wx-todo_user-item--clickable",t[0])},i(t){c||(ut(l),ut(i.$$.fragment,t),c=!0)},o(t){pt(l),pt(i.$$.fragment,t),c=!1},d(t){t&&S(e),l&&l.d(),yt(i)}}}function Oi(t,e,n){let s,i,o,r,a,c,{item:l}=e;return t.$$set=t=>{"item"in t&&n(6,l=t.item)},t.$$.update=()=>{64&t.$$.dirty&&n(5,s=l.label),64&t.$$.dirty&&n(4,i=l.icon),64&t.$$.dirty&&n(3,o=l.color),64&t.$$.dirty&&n(2,r=l.avatar),64&t.$$.dirty&&n(1,a=l.checked),64&t.$$.dirty&&n(0,c=l.clickable)},[c,a,r,o,i,s,l]}class zi extends bt{constructor(t){super(),xt(this,t,Oi,Fi,d,{item:6})}}function qi(t){let e,n,s,i,o,r;function a(e){t[4](e)}let c={};return void 0!==t[0]&&(c.value=t[0]),n=new $e({props:c}),X.push((()=>gt(n,"value",a))),n.$on("change",t[2]),{c(){e=T("div"),$t(n.$$.fragment),E(e,"class","wx-todo_date-item svelte-1l2j6bx")},m(s,a){_(s,e,a),kt(n,e,null),i=!0,o||(r=D(e,"click",t[1]),o=!0)},p(t,[e]){const i={};!s&&1&e&&(s=!0,i.value=t[0],nt((()=>s=!1))),n.$set(i)},i(t){i||(ut(n.$$.fragment,t),i=!0)},o(t){pt(n.$$.fragment,t),i=!1},d(t){t&&S(e),yt(n),o=!1,r()}}}function Bi(t,e,n){let s,i;let{item:o}=e;return t.$$set=t=>{"item"in t&&n(3,o=t.item)},t.$$.update=()=>{8&t.$$.dirty&&(s=o.store),8&t.$$.dirty&&n(0,i=o.value)},[i,t=>t.preventDefault(),()=>{const{menuState:t}=s.getState(),e=s.getSelection().map((t=>({...s.getTask(t),due_date:i||null})));let n;e.length>1&&(n={batch:Ye()}),s.eachSelected(((t,o)=>{const r=s.getTask(t);s.in.exec("update-task",{id:t,task:{...r,due_date:i||null},skipProvider:!!o,batch:o?[]:e.slice(1),$meta:n})})),s.in.exec("close-menu",{...t})},o,function(t){i=t,n(0,i),n(3,o)}]}class Yi extends bt{constructor(t){super(),xt(this,t,Bi,qi,d,{item:3})}}function Ji(t){let e,n;return e=new Ci({props:{name:t[1]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.name=t[1]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Wi(t){let e,n;return{c(){e=T("div"),n=C(t[0]),E(e,"class","wx-todo_item__hotkey svelte-rqtk31")},m(t,s){_(t,e,s),w(e,n)},p(t,e){1&e&&N(n,t[0])},d(t){t&&S(e)}}}function Gi(t){let e,n,s,i,o,r,a,c,l=t[1]&&Ji(t),d=t[0]&&Wi(t);return{c(){e=T("div"),l&&l.c(),n=I(),s=T("div"),i=I(),o=T("div"),r=C(t[3]),a=I(),d&&d.c(),E(s,"class","wx-todo_item__priority-icon svelte-rqtk31"),H(s,"background-color",t[2]),E(o,"class","wx-todo_item__label svelte-rqtk31"),E(e,"class","wx-todo_item svelte-rqtk31")},m(t,u){_(t,e,u),l&&l.m(e,null),w(e,n),w(e,s),w(e,i),w(e,o),w(o,r),w(e,a),d&&d.m(e,null),c=!0},p(t,[i]){t[1]?l?(l.p(t,i),2&i&&ut(l,1)):(l=Ji(t),l.c(),ut(l,1),l.m(e,n)):l&&(lt(),pt(l,1,1,(()=>{l=null})),dt()),(!c||4&i)&&H(s,"background-color",t[2]),(!c||8&i)&&N(r,t[3]),t[0]?d?d.p(t,i):(d=Wi(t),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},i(t){c||(ut(l),c=!0)},o(t){pt(l),c=!1},d(t){t&&S(e),l&&l.d(),d&&d.d()}}}function Vi(t,e,n){let s,i,o,r,{item:a}=e;return t.$$set=t=>{"item"in t&&n(4,a=t.item)},t.$$.update=()=>{16&t.$$.dirty&&n(3,s=a.label),16&t.$$.dirty&&n(2,i=a.color),16&t.$$.dirty&&n(1,o=a.icon),16&t.$$.dirty&&n(0,r=a.hotkey)},[r,o,i,s,a]}class Ui extends bt{constructor(t){super(),xt(this,t,Vi,Gi,d,{item:4})}}function Xi(t){let e,n,s;return n=new Si({props:{options:t[0],parent:t[1],mount:t[8],at:t[2]}}),n.$on("click",t[7]),{c(){e=T("div"),$t(n.$$.fragment),E(e,"class","wx-todo_menu"),E(e,"data-todo-id",t[4])},m(t,i){_(t,e,i),kt(n,e,null),s=!0},p(t,i){const o={};1&i&&(o.options=t[0]),2&i&&(o.parent=t[1]),256&i&&(o.mount=t[8]),4&i&&(o.at=t[2]),n.$set(o),(!s||16&i)&&E(e,"data-todo-id",t[4])},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&S(e),yt(n)}}}function Zi(t){let e,n;return e=new je({props:{theme:"material",$$slots:{default:[Xi,({mount:t})=>({8:t}),({mount:t})=>t?256:0]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,[n]){const s={};791&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Qi(t,e,n){let s,o,r,a=i;t.$$.on_destroy.push((()=>a())),li("item",Ni),li("user",zi),li("datepicker",Yi),li("priority",Ui);let{options:c}=e,{parent:l}=e,{at:d="bottom-left"}=e,{api:p}=e;return t.$$set=t=>{"options"in t&&n(0,c=t.options),"parent"in t&&n(1,l=t.parent),"at"in t&&n(2,d=t.at),"api"in t&&n(5,p=t.api)},t.$$.update=()=>{32&t.$$.dirty&&n(6,s=p.getReactiveState()),64&t.$$.dirty&&(n(3,o=s.id),a(),a=u(o,(t=>n(4,r=t))))},[c,l,d,o,r,p,s,function(e){V.call(this,t,e)}]}class Ki extends bt{constructor(t){super(),xt(this,t,Qi,Zi,d,{options:0,parent:1,at:2,api:5})}}function to(t){let e,n;return e=new Ci({props:{name:"check",size:16}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function eo(t){let e,n,s,i,o,r,a,l=t[0]&&to();return{c(){e=T("label"),n=T("input"),s=I(),i=T("span"),l&&l.c(),E(n,"id",t[2]),n.disabled=t[1],E(n,"type","checkbox"),E(n,"class","wx-todo_checkbox__input svelte-1u2bz8m"),E(i,"class","wx-todo_checkbox__icon svelte-1u2bz8m"),L(i,"wx-todo_checkbox--checked",t[0]),E(e,"for",t[2]),E(e,"class","wx-todo_checkbox wx-todo_checkbox__label svelte-1u2bz8m"),L(e,"wx-todo_checkbox--disabled",t[1])},m(c,d){_(c,e,d),w(e,n),n.checked=t[0],w(e,s),w(e,i),l&&l.m(i,null),o=!0,r||(a=[D(n,"change",P(t[3])),D(n,"change",t[4])],r=!0)},p(t,[s]){(!o||4&s)&&E(n,"id",t[2]),(!o||2&s)&&(n.disabled=t[1]),1&s&&(n.checked=t[0]),t[0]?l?1&s&&ut(l,1):(l=to(),l.c(),ut(l,1),l.m(i,null)):l&&(lt(),pt(l,1,1,(()=>{l=null})),dt()),(!o||1&s)&&L(i,"wx-todo_checkbox--checked",t[0]),(!o||4&s)&&E(e,"for",t[2]),(!o||2&s)&&L(e,"wx-todo_checkbox--disabled",t[1])},i(t){o||(ut(l),o=!0)},o(t){pt(l),o=!1},d(t){t&&S(e),l&&l.d(),r=!1,c(a)}}}function no(t,e,n){let{disabled:s=!1}=e,{checked:i=!1}=e,{id:o=Qe().toString()}=e;return t.$$set=t=>{"disabled"in t&&n(1,s=t.disabled),"checked"in t&&n(0,i=t.checked),"id"in t&&n(2,o=t.id)},[i,s,o,function(e){V.call(this,t,e)},function(){i=this.checked,n(0,i)}]}class so extends bt{constructor(t){super(),xt(this,t,no,eo,d,{disabled:1,checked:0,id:2})}}function io(t){let e,n,s,i;const o=t[4].default,r=h(o,t,t[3],null);return{c(){e=T("button"),r&&r.c(),E(e,"class","wx-todo_button svelte-10n97i3"),H(e,"width","number"==typeof t[0]?`${t[0]}px`:t[0]),H(e,"height","number"==typeof t[1]?`${t[1]}px`:t[1]),L(e,"wx-todo_button--circle",t[2])},m(o,a){_(o,e,a),r&&r.m(e,null),n=!0,s||(i=D(e,"click",t[5]),s=!0)},p(t,[s]){r&&r.p&&(!n||8&s)&&g(r,o,t,t[3],n?m(o,t[3],s,null):$(t[3]),null),(!n||1&s)&&H(e,"width","number"==typeof t[0]?`${t[0]}px`:t[0]),(!n||2&s)&&H(e,"height","number"==typeof t[1]?`${t[1]}px`:t[1]),(!n||4&s)&&L(e,"wx-todo_button--circle",t[2])},i(t){n||(ut(r,t),n=!0)},o(t){pt(r,t),n=!1},d(t){t&&S(e),r&&r.d(t),s=!1,i()}}}function oo(t,e,n){let{$$slots:s={},$$scope:i}=e,{width:o=20}=e,{height:r=20}=e,{circle:a=!1}=e;return t.$$set=t=>{"width"in t&&n(0,o=t.width),"height"in t&&n(1,r=t.height),"circle"in t&&n(2,a=t.circle),"$$scope"in t&&n(3,i=t.$$scope)},[o,r,a,i,s,function(e){V.call(this,t,e)}]}class ro extends bt{constructor(t){super(),xt(this,t,oo,io,d,{width:0,height:1,circle:2})}}function ao(t){let e,n=fs(t[0],t[1])+"";return{c(){e=T("div"),E(e,"class","wx-todo_text svelte-1h03wzk"),E(e,"tabindex","0"),L(e,"wx-todo_text--completed",t[2])},m(t,s){_(t,e,s),e.innerHTML=n},p(t,[s]){3&s&&n!==(n=fs(t[0],t[1])+"")&&(e.innerHTML=n),4&s&&L(e,"wx-todo_text--completed",t[2])},i:i,o:i,d(t){t&&S(e)}}}function co(t,e,n){let{value:s=""}=e,{filter:i}=e,{completed:o=!1}=e;return t.$$set=t=>{"value"in t&&n(0,s=t.value),"filter"in t&&n(1,i=t.filter),"completed"in t&&n(2,o=t.completed)},[s,i,o]}class lo extends bt{constructor(t){super(),xt(this,t,co,ao,d,{value:0,filter:1,completed:2})}}function uo(t){let e,n;const s=t[4].default,i=h(s,t,t[6],null);return{c(){e=T("div"),i&&i.c(),E(e,"class","wx-todo_popup svelte-1thl4la"),H(e,"left",t[0].x+"px"),H(e,"top",t[0].y+"px")},m(s,o){_(s,e,o),i&&i.m(e,null),t[5](e),n=!0},p(t,o){i&&i.p&&(!n||64&o)&&g(i,s,t,t[6],n?m(s,t[6],o,null):$(t[6]),null),(!n||1&o)&&H(e,"left",t[0].x+"px"),(!n||1&o)&&H(e,"top",t[0].y+"px")},i(t){n||(ut(i,t),n=!0)},o(t){pt(i,t),n=!1},d(n){n&&S(e),i&&i.d(n),t[5](null)}}}function po(t){let e,n,s,i;return e=new je({props:{theme:"material",$$slots:{default:[uo]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(o,r){kt(e,o,r),n=!0,s||(i=D(window,"mousedown",t[2]),s=!0)},p(t,[n]){const s={};67&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t),s=!1,i()}}}function ho(t,e,n){let{$$slots:s={},$$scope:i}=e,{coords:o={x:0,y:0}}=e,{wrapper:r=document.body}=e,a=null;const c=J();return Y((function(){if(!a)return;const t=r.getBoundingClientRect(),e=a.getBoundingClientRect(),s=e.bottom-t.bottom;s>0&&n(0,o.y-=s,o);const i=e.right-t.right;i>0&&n(0,o.x-=i,o)})),t.$$set=t=>{"coords"in t&&n(0,o=t.coords),"wrapper"in t&&n(3,r=t.wrapper),"$$scope"in t&&n(6,i=t.$$scope)},[o,a,function(t){a.contains(t.target)||c("cancel",{event:t})},r,s,function(t){X[t?"unshift":"push"]((()=>{a=t,n(1,a)}))},i]}class fo extends bt{constructor(t){super(),xt(this,t,ho,po,d,{coords:0,wrapper:3})}}function mo(t){let e,n,s;function i(e){t[6](e)}let o={};return void 0!==t[0]&&(o.value=t[0]),e=new $e({props:o}),X.push((()=>gt(e,"value",i))),e.$on("change",t[2]),{c(){$t(e.$$.fragment)},m(t,n){kt(e,t,n),s=!0},p(t,s){const i={};!n&&1&s&&(n=!0,i.value=t[0],nt((()=>n=!1))),e.$set(i)},i(t){s||(ut(e.$$.fragment,t),s=!0)},o(t){pt(e.$$.fragment,t),s=!1},d(t){yt(e,t)}}}function go(t){let e,n;return e=new fo({props:{coords:t[1],$$slots:{default:[mo]},$$scope:{ctx:t}}}),e.$on("cancel",t[2]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,[n]){const s={};2&n&&(s.coords=t[1]),513&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function $o(t,e,n){let{coords:s}=e,{cancel:i=null}=e,{value:o=null}=e,{convert:r=!0}=e,{dateFormat:a="%d %M %Y"}=e;const c=J(),l=G("wx-i18n").getGroup("calendar");o="string"==typeof o?Un(o,a,!0,Ws(l)):o||null;return t.$$set=t=>{"coords"in t&&n(1,s=t.coords),"cancel"in t&&n(3,i=t.cancel),"value"in t&&n(0,o=t.value),"convert"in t&&n(4,r=t.convert),"dateFormat"in t&&n(5,a=t.dateFormat)},[o,s,()=>{o?c("change",{value:r?Vn(o,a,Ws(l)):o}):i&&i()},i,r,a,function(t){o=t,n(0,o)}]}class ko extends bt{constructor(t){super(),xt(this,t,$o,go,d,{coords:1,cancel:3,value:0,convert:4,dateFormat:5})}}function yo(t,e,n){const s=t.slice();return s[7]=e[n],s}const vo=t=>({item:1&t}),xo=t=>({item:t[7]});function bo(t,e){let n,s,i,o;const r=e[5].default,a=h(r,e,e[4],xo);return{key:t,first:null,c(){n=T("li"),a&&a.c(),s=I(),E(n,"class","wx-todo_list__item svelte-15dwoyv"),E(n,"data-list-id",i=e[7].id),L(n,"wx-todo_list__item--selected",Ke(e[7].id,e[1])),this.first=n},m(t,e){_(t,n,e),a&&a.m(n,null),w(n,s),o=!0},p(t,s){e=t,a&&a.p&&(!o||17&s)&&g(a,r,e,e[4],o?m(r,e[4],s,vo):$(e[4]),xo),(!o||1&s&&i!==(i=e[7].id))&&E(n,"data-list-id",i),(!o||3&s)&&L(n,"wx-todo_list__item--selected",Ke(e[7].id,e[1]))},i(t){o||(ut(a,t),o=!0)},o(t){pt(a,t),o=!1},d(t){t&&S(n),a&&a.d(t)}}}function wo(t){let e,n,s,i,o=[],r=new Map,a=t[0];const l=t=>t[7].id;for(let e=0;e<a.length;e+=1){let n=yo(t,a,e),s=l(n);r.set(s,o[e]=bo(s,n))}return{c(){e=T("ul");for(let t=0;t<o.length;t+=1)o[t].c();E(e,"class","wx-todo_list svelte-15dwoyv")},m(r,a){_(r,e,a);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,null);n=!0,s||(i=[D(window,"keydown",t[3]),D(e,"click",t[2])],s=!0)},p(t,[n]){19&n&&(a=t[0],lt(),o=mt(o,n,l,1,t,a,r,e,ft,bo,null,yo),dt())},i(t){if(!n){for(let t=0;t<a.length;t+=1)ut(o[t]);n=!0}},o(t){for(let t=0;t<o.length;t+=1)pt(o[t]);n=!1},d(t){t&&S(e);for(let t=0;t<o.length;t+=1)o[t].d();s=!1,c(i)}}}function _o(t,e,n){let s,{$$slots:i={},$$scope:o}=e,{options:r=[]}=e;const a=J();return t.$$set=t=>{"options"in t&&n(0,r=t.options),"$$scope"in t&&n(4,o=t.$$scope)},t.$$.update=()=>{1&t.$$.dirty&&n(1,s=r.find((t=>"check"===t.icon))?.id)},[r,s,t=>{n(1,s=_s(t,"data-list-id")),a("click",{id:s})},t=>{const e=r.findIndex((t=>Ke(t.id,s)));let i;switch(t.code){case"ArrowUp":t.preventDefault(),i=r[e-1]?.id,n(1,s=void 0!==i?i:r.at(-1).id);break;case"ArrowDown":t.preventDefault(),i=r[e+1]?.id,n(1,s=void 0!==i?i:r[0].id);break;case"Enter":if(t.preventDefault(),void 0===s)return;a("click",{id:s})}},o,i]}class So extends bt{constructor(t){super(),xt(this,t,_o,wo,d,{options:0})}}function jo(t){let e,n,s,i="menu"===t[5].type&&To(t),o="datepicker"===t[5].type&&Mo(t);return{c(){i&&i.c(),e=I(),o&&o.c(),n=M()},m(t,r){i&&i.m(t,r),_(t,e,r),o&&o.m(t,r),_(t,n,r),s=!0},p(t,s){"menu"===t[5].type?i?(i.p(t,s),32&s&&ut(i,1)):(i=To(t),i.c(),ut(i,1),i.m(e.parentNode,e)):i&&(lt(),pt(i,1,1,(()=>{i=null})),dt()),"datepicker"===t[5].type?o?(o.p(t,s),32&s&&ut(o,1)):(o=Mo(t),o.c(),ut(o,1),o.m(n.parentNode,n)):o&&(lt(),pt(o,1,1,(()=>{o=null})),dt())},i(t){s||(ut(i),ut(o),s=!0)},o(t){pt(i),pt(o),s=!1},d(t){i&&i.d(t),t&&S(e),o&&o.d(t),t&&S(n)}}}function To(t){let e,n;return e=new fo({props:{coords:t[5].coords,$$slots:{default:[Io]},$$scope:{ctx:t}}}),e.$on("cancel",t[6]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};32&n&&(s.coords=t[5].coords),2097184&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Co(t){let e,n;return e=new Ni({props:{item:t[20]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1048576&n&&(s.item=t[20]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Io(t){let e,n;return e=new So({props:{options:t[5].options,$$slots:{default:[Co,({item:t})=>({20:t}),({item:t})=>t?1048576:0]},$$scope:{ctx:t}}}),e.$on("click",t[10]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};32&n&&(s.options=t[5].options),3145728&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Mo(t){let e,n;return e=new ko({props:{dateFormat:t[2].date.format,coords:t[5].coords,cancel:t[7],value:t[3].targetDate}}),e.$on("change",t[11]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.dateFormat=t[2].date.format),32&n&&(s.coords=t[5].coords),8&n&&(s.value=t[3].targetDate),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Do(t){let e,n,s,i,o,r,a,l=t[5]&&jo(t);return{c(){e=T("div"),n=C(t[0]),s=I(),l&&l.c(),i=M(),E(e,"class","wx-todo_editor svelte-124gm4f"),E(e,"contenteditable","true"),E(e,"data-placeholder",t[1]),E(e,"tabindex","0")},m(c,d){_(c,e,d),w(e,n),t[13](e),_(c,s,d),l&&l.m(c,d),_(c,i,d),o=!0,r||(a=[D(e,"input",t[8]),D(e,"keyup",t[9])],r=!0)},p(t,[s]){(!o||1&s)&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(n,t[0]),(!o||2&s)&&E(e,"data-placeholder",t[1]),t[5]?l?(l.p(t,s),32&s&&ut(l,1)):(l=jo(t),l.c(),ut(l,1),l.m(i.parentNode,i)):l&&(lt(),pt(l,1,1,(()=>{l=null})),dt())},i(t){o||(ut(l),o=!0)},o(t){pt(l),o=!1},d(n){n&&S(e),t[13](null),n&&S(s),l&&l.d(n),n&&S(i),r=!1,c(a)}}}function Po(t,e,n){let s,{value:i=""}=e,{placeholder:o=""}=e,{tags:r=[]}=e,{shape:a}=e,{editor:c}=e,l=null,d=null,u=null;const p=J();function h(t){const{x:e,y:n}=function(){const t=window.getSelection().getRangeAt(0).getBoundingClientRect();return{x:t.x,y:t.y}}();p("editing",{value:d,dropdown:{type:t,coords:{x:e+window.scrollX,y:n+window.scrollY+20},options:"menu"===t?Ys(r,""):[]},targetDate:c.targetDate})}function f(){p("editing",{dropdown:null,value:d})}function m(t,e,s){const i=t[u+1],o=t;if(e=s+e,i)if(sn(i)){const n=new RegExp(String.raw`${s}\s`,"gm");t=t.replace(n,((t,n)=>n===u?`${e} `:t))}else if("!"===s){const n=new RegExp(/!\((.+?)\)/gm);t=t.replace(n,((t,n,s)=>s===u?e:t))}else t=t.replace(mn(s),((t,n)=>n===u?e:t));else t+=e.substring(1);d=t,n(4,l.innerHTML=hs(t),l),Ss(l,u+(o!==d?e.length:1)),f()}return B((function(){d=i,c.targetDate?(u=d.indexOf(c.targetDate)-2,Ss(l,u),h("datepicker")):Ss(l)})),t.$$set=t=>{"value"in t&&n(0,i=t.value),"placeholder"in t&&n(1,o=t.placeholder),"tags"in t&&n(12,r=t.tags),"shape"in t&&n(2,a=t.shape),"editor"in t&&n(3,c=t.editor)},t.$$.update=()=>{8&t.$$.dirty&&n(5,s=c?.dropdown)},[i,o,a,c,l,s,f,function(){m(d,"","!"),f()},function(){d=l?.textContent||"",p("editing",{value:d,dropdown:c.dropdown})},function(t){if("Enter"===t.code)return;const e="#",n="!",s=function(t){const e=window.getSelection(),n=document.createRange();return n.setStart(t,0),n.setEnd(e.anchorNode,e.anchorOffset),n.toString().length}(l)-1,i=d[s],o=d[s-1],a=!tn(o)||sn(o),m=(i===e||t.key===e)&&a,g=(i===n||t.key===n)&&a;if(m)h("menu"),u=s;else if(g)h("datepicker"),u=s;else if(c.dropdown){const t=[],n=new RegExp(/^\s*$/gm);for(let i=s;i>0;i--){const s=d[i];if(s===e){const e=t.reverse().join(""),n=Ys(r,e);if(!n.length)break;return void p("editing",{dropdown:{...c.dropdown,options:n},value:d})}if(t.push(s),n.test(s))break}f()}},function(t){const e=t.detail.id;tn(e)?m(d,e.substring(1),"#"):f()},function(t){const e=t.detail.value;m(d,`(${e})`,"!")},r,function(t){X[t?"unshift":"push"]((()=>{l=t,n(4,l)}))}]}class Eo extends bt{constructor(t){super(),xt(this,t,Po,Do,d,{value:0,placeholder:1,tags:12,shape:2,editor:3})}}function No(t){let e,n,s,i,o,r,a,c,l;function d(t,e){return t[0]instanceof Date?Ho:Ao}n=new Ci({props:{name:"calendar",css:t[4],size:14}});let u=d(t),p=u(t),h=t[1]&&Lo(t);return{c(){e=T("div"),$t(n.$$.fragment),s=I(),i=T("span"),p.c(),r=I(),h&&h.c(),E(i,"class",o=v(t[4])+" svelte-1tdglu5"),E(e,"class","wx-todo_due-date svelte-1tdglu5"),L(e,"completed",t[3])},m(o,d){_(o,e,d),kt(n,e,null),w(e,s),w(e,i),p.m(i,null),w(e,r),h&&h.m(e,null),t[16](e),a=!0,c||(l=D(e,"click",t[9]),c=!0)},p(t,s){const r={};16&s&&(r.css=t[4]),n.$set(r),u===(u=d(t))&&p?p.p(t,s):(p.d(1),p=u(t),p&&(p.c(),p.m(i,null))),(!a||16&s&&o!==(o=v(t[4])+" svelte-1tdglu5"))&&E(i,"class",o),t[1]?h?(h.p(t,s),2&s&&ut(h,1)):(h=Lo(t),h.c(),ut(h,1),h.m(e,null)):h&&(lt(),pt(h,1,1,(()=>{h=null})),dt()),(!a||8&s)&&L(e,"completed",t[3])},i(t){a||(ut(n.$$.fragment,t),ut(h),a=!0)},o(t){pt(n.$$.fragment,t),pt(h),a=!1},d(s){s&&S(e),yt(n),p.d(),h&&h.d(),t[16](null),c=!1,l()}}}function Ao(t){let e,n=t[7]("Set due date")+"";return{c(){e=C(n)},m(t,n){_(t,e,n)},p:i,d(t){t&&S(e)}}}function Ho(t){let e,n=Vn(t[0],t[2],Ws(t[8]))+"";return{c(){e=C(n)},m(t,n){_(t,e,n)},p(t,s){5&s&&n!==(n=Vn(t[0],t[2],Ws(t[8]))+"")&&N(e,n)},d(t){t&&S(e)}}}function Lo(t){let e,n;return e=new je({props:{$$slots:{default:[Fo,({mount:t})=>({18:t}),({mount:t})=>t?262144:0]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};786497&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Ro(t){let e,n,s;function i(e){t[15](e)}let o={};return void 0!==t[0]&&(o.value=t[0]),e=new $e({props:o}),X.push((()=>gt(e,"value",i))),e.$on("change",t[11]),{c(){$t(e.$$.fragment)},m(t,n){kt(e,t,n),s=!0},p(t,s){const i={};!n&&1&s&&(n=!0,i.value=t[0],nt((()=>n=!1))),e.$set(i)},i(t){s||(ut(e.$$.fragment,t),s=!0)},o(t){pt(e.$$.fragment,t),s=!1},d(t){yt(e,t)}}}function Fo(t){let e,n;return e=new xe({props:{mount:t[18],area:t[6],cancel:t[10],$$slots:{default:[Ro]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};262144&n&&(s.mount=t[18]),64&n&&(s.area=t[6]),524289&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Oo(t){let e,n,s=t[0]&&No(t);return{c(){s&&s.c(),e=M()},m(t,i){s&&s.m(t,i),_(t,e,i),n=!0},p(t,[n]){t[0]?s?(s.p(t,n),1&n&&ut(s,1)):(s=No(t),s.c(),ut(s,1),s.m(e.parentNode,e)):s&&(lt(),pt(s,1,1,(()=>{s=null})),dt())},i(t){n||(ut(s),n=!0)},o(t){pt(s),n=!1},d(t){s&&s.d(t),t&&S(e)}}}function zo(t,e,n){let{id:s}=e,{format:i="%d %M %Y"}=e,{value:o=null}=e,{validate:r=!0}=e,{completed:a=!1}=e,{open:c=!1}=e,{readonly:l=!1}=e;const d=G("wx-i18n").getGroup("todo"),u=G("wx-i18n").getGroup("calendar"),p=J();let h="wx-todo_date",f=null,m=null;const g=()=>{n(1,c=!1),n(6,m=null),p("action",{action:"set-state-due-date",data:{open:!1,id:s}})};return t.$$set=t=>{"id"in t&&n(12,s=t.id),"format"in t&&n(2,i=t.format),"value"in t&&n(0,o=t.value),"validate"in t&&n(13,r=t.validate),"completed"in t&&n(3,a=t.completed),"open"in t&&n(1,c=t.open),"readonly"in t&&n(14,l=t.readonly)},t.$$.update=()=>{8197&t.$$.dirty&&o&&("string"==typeof o&&n(0,o=Un(o,i,!1,Ws(u))),o?.getTime()||n(0,o=null),r&&o instanceof Date&&n(4,h=function(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n.getTime()<=s.getTime()}(o)?"wx-todo_date--current":"wx-todo_date--expired"))},[o,c,i,a,h,f,m,d,u,()=>{l||(n(6,m=f.getBoundingClientRect()),n(1,c=!0),p("action",{action:"set-state-due-date",data:{open:!0,id:s}}))},g,()=>{p("action",{action:"update-task",data:{id:s,task:{due_date:o||null}}}),g()},s,r,l,function(t){o=t,n(0,o),n(2,i),n(13,r)},function(t){X[t?"unshift":"push"]((()=>{f=t,n(5,f)}))}]}class qo extends bt{constructor(t){super(),xt(this,t,zo,Oo,d,{id:12,format:2,value:0,validate:13,completed:3,open:1,readonly:14})}}function Bo(t){let e;return{c(){e=T("div"),E(e,"class","wx-todo_list__priority-label svelte-12quozm"),H(e,"background",t[0][t[1].priority]?.color)},m(t,n){_(t,e,n)},p(t,n){3&n&&H(e,"background",t[0][t[1].priority]?.color)},d(t){t&&S(e)}}}function Yo(t){let e;return{c(){e=T("div"),E(e,"class","wx-todo_list__priority-cover svelte-12quozm"),H(e,"background",t[0][t[1].priority]?.color)},m(t,n){_(t,e,n)},p(t,n){3&n&&H(e,"background",t[0][t[1].priority]?.color)},d(t){t&&S(e)}}}function Jo(t){let e,n,s=t[2]?.label&&Bo(t),o=t[2]?.cover&&Yo(t);return{c(){e=T("div"),s&&s.c(),n=I(),o&&o.c(),E(e,"class","wx-todo_list__priority svelte-12quozm")},m(t,i){_(t,e,i),s&&s.m(e,null),w(e,n),o&&o.m(e,null)},p(t,[i]){t[2]?.label?s?s.p(t,i):(s=Bo(t),s.c(),s.m(e,n)):s&&(s.d(1),s=null),t[2]?.cover?o?o.p(t,i):(o=Yo(t),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i:i,o:i,d(t){t&&S(e),s&&s.d(),o&&o.d()}}}function Wo(t,e,n){let{priority:s}=e,{task:i}=e,{config:o}=e;return t.$$set=t=>{"priority"in t&&n(0,s=t.priority),"task"in t&&n(1,i=t.task),"config"in t&&n(2,o=t.config)},[s,i,o]}class Go extends bt{constructor(t){super(),xt(this,t,Wo,Jo,d,{priority:0,task:1,config:2})}}function Vo(t,e,n){const s=t.slice();return s[52]=e[n],s[54]=n,s}function Uo(t){let e,n,s;return n=new ro({props:{circle:!0,$$slots:{default:[Xo]},$$scope:{ctx:t}}}),n.$on("click",t[31]),{c(){e=T("div"),$t(n.$$.fragment),E(e,"class","wx-todo_list-toggle-button svelte-yd416y")},m(t,i){_(t,e,i),kt(n,e,null),s=!0},p(t,e){const s={};2&e[0]|16777216&e[1]&&(s.$$scope={dirty:e,ctx:t}),n.$set(s)},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&S(e),yt(n)}}}function Xo(t){let e,n;return e=new Ci({props:{name:t[1].collapsed?"menu-right":"menu-down"}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};2&n[0]&&(s.name=t[1].collapsed?"menu-right":"menu-down"),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Zo(t){let e,n;return e=new Go({props:{priority:t[14],task:t[1],config:t[17]?.priority}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};16384&n[0]&&(s.priority=t[14]),2&n[0]&&(s.task=t[1]),131072&n[0]&&(s.config=t[17]?.priority),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Qo(t){let e,n;return e=new lo({props:{value:t[1].text||"",completed:t[1].checked,filter:t[19]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};2&n[0]&&(s.value=t[1].text||""),2&n[0]&&(s.completed=t[1].checked),524288&n[0]&&(s.filter=t[19]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Ko(t){let e,n;return e=new Eo({props:{value:t[1].text||"",placeholder:t[20]("Type what you want"),shape:t[17],editor:t[4],tags:t[18]}}),e.$on("editing",t[32]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};2&n[0]&&(s.value=t[1].text||""),131072&n[0]&&(s.shape=t[17]),16&n[0]&&(s.editor=t[4]),262144&n[0]&&(s.tags=t[18]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function tr(t){let e;function n(t,e){return"number"===t[1].counter.type?nr:"percentage"===t[1].counter.type?er:void 0}let s=n(t),i=s&&s(t);return{c(){e=T("div"),i&&i.c(),E(e,"class","wx-todo_list__counter svelte-yd416y")},m(t,n){_(t,e,n),i&&i.m(e,null)},p(t,o){s===(s=n(t))&&i?i.p(t,o):(i&&i.d(1),i=s&&s(t),i&&(i.c(),i.m(e,null)))},d(t){t&&S(e),i&&i.d()}}}function er(t){let e,n,s=Math.round(t[1].counter.done/t[1].counter.total*100)+"";return{c(){e=C(s),n=C("%")},m(t,s){_(t,e,s),_(t,n,s)},p(t,n){2&n[0]&&s!==(s=Math.round(t[1].counter.done/t[1].counter.total*100)+"")&&N(e,s)},d(t){t&&S(e),t&&S(n)}}}function nr(t){let e,n,s,i=t[1].counter.done+"",o=t[1].counter.total+"";return{c(){e=C(i),n=C("/"),s=C(o)},m(t,i){_(t,e,i),_(t,n,i),_(t,s,i)},p(t,n){2&n[0]&&i!==(i=t[1].counter.done+"")&&N(e,i),2&n[0]&&o!==(o=t[1].counter.total+"")&&N(s,o)},d(t){t&&S(e),t&&S(n),t&&S(s)}}}function sr(t){let e,n,s,i,o=t[12],r=[];for(let e=0;e<o.length;e+=1)r[e]=or(Vo(t,o,e));const a=t=>pt(r[t],1,1,(()=>{r[t]=null}));let c=t[12].length>3&&rr(t);return{c(){e=T("div");for(let t=0;t<r.length;t+=1)r[t].c();n=I(),c&&c.c(),E(e,"class","wx-todo_user-menu svelte-yd416y"),H(e,"width",(t[12].length>=3?60:16*t[12].length+14)+"px"),E(e,"data-user-menu-id",s=t[1].id)},m(s,o){_(s,e,o);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,null);w(e,n),c&&c.m(e,null),t[47](e),i=!0},p(t,l){if(4096&l[0]){let s;for(o=t[12],s=0;s<o.length;s+=1){const i=Vo(t,o,s);r[s]?(r[s].p(i,l),ut(r[s],1)):(r[s]=or(i),r[s].c(),ut(r[s],1),r[s].m(e,n))}for(lt(),s=o.length;s<r.length;s+=1)a(s);dt()}t[12].length>3?c?(c.p(t,l),4096&l[0]&&ut(c,1)):(c=rr(t),c.c(),ut(c,1),c.m(e,null)):c&&(lt(),pt(c,1,1,(()=>{c=null})),dt()),(!i||4096&l[0])&&H(e,"width",(t[12].length>=3?60:16*t[12].length+14)+"px"),(!i||2&l[0]&&s!==(s=t[1].id))&&E(e,"data-user-menu-id",s)},i(t){if(!i){for(let t=0;t<o.length;t+=1)ut(r[t]);ut(c),i=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)pt(r[t]);pt(c),i=!1},d(n){n&&S(e),j(r,n),c&&c.d(),t[47](null)}}}function ir(t){let e,n,s;return n=new Li({props:{color:t[52].color,avatar:t[52].avatar}}),{c(){e=T("div"),$t(n.$$.fragment),E(e,"class","wx-todo_user-menu__avatar svelte-yd416y"),H(e,"left",16*t[54]+"px")},m(t,i){_(t,e,i),kt(n,e,null),s=!0},p(t,e){const s={};4096&e[0]&&(s.color=t[52].color),4096&e[0]&&(s.avatar=t[52].avatar),n.$set(s)},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&S(e),yt(n)}}}function or(t){let e,n,s=(3===t[12].length&&t[54]<3||t[54]<2)&&ir(t);return{c(){s&&s.c(),e=M()},m(t,i){s&&s.m(t,i),_(t,e,i),n=!0},p(t,n){3===t[12].length&&t[54]<3||t[54]<2?s?(s.p(t,n),4096&n[0]&&ut(s,1)):(s=ir(t),s.c(),ut(s,1),s.m(e.parentNode,e)):s&&(lt(),pt(s,1,1,(()=>{s=null})),dt())},i(t){n||(ut(s),n=!0)},o(t){pt(s),n=!1},d(t){s&&s.d(t),t&&S(e)}}}function rr(t){let e,n,s;return n=new Li({props:{value:"+"+(t[12].length-2)}}),{c(){e=T("div"),$t(n.$$.fragment),E(e,"class","wx-todo_user-menu__avatar svelte-yd416y"),H(e,"left","32px")},m(t,i){_(t,e,i),kt(n,e,null),s=!0},p(t,e){const s={};4096&e[0]&&(s.value="+"+(t[12].length-2)),n.$set(s)},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&S(e),yt(n)}}}function ar(t){let e,n,s,i;return n=new Ci({props:{name:"dots-v"}}),{c(){e=T("button"),$t(n.$$.fragment),E(e,"data-menu-id",s=t[1].id),E(e,"class","wx-todo_list-menu-button svelte-yd416y")},m(s,o){_(s,e,o),kt(n,e,null),t[48](e),i=!0},p(t,n){(!i||2&n[0]&&s!==(s=t[1].id))&&E(e,"data-menu-id",s)},i(t){i||(ut(n.$$.fragment,t),i=!0)},o(t){pt(n.$$.fragment,t),i=!1},d(s){s&&S(e),yt(n),t[48](null)}}}function cr(t){let e,n,s,i="user"===t[3].type&&lr(t),o="task"===t[3].type&&dr(t);return{c(){i&&i.c(),e=I(),o&&o.c(),n=M()},m(t,r){i&&i.m(t,r),_(t,e,r),o&&o.m(t,r),_(t,n,r),s=!0},p(t,s){"user"===t[3].type?i?(i.p(t,s),8&s[0]&&ut(i,1)):(i=lr(t),i.c(),ut(i,1),i.m(e.parentNode,e)):i&&(lt(),pt(i,1,1,(()=>{i=null})),dt()),"task"===t[3].type?o?(o.p(t,s),8&s[0]&&ut(o,1)):(o=dr(t),o.c(),ut(o,1),o.m(n.parentNode,n)):o&&(lt(),pt(o,1,1,(()=>{o=null})),dt())},i(t){s||(ut(i),ut(o),s=!0)},o(t){pt(i),pt(o),s=!1},d(t){i&&i.d(t),t&&S(e),o&&o.d(t),t&&S(n)}}}function lr(t){let e,n;return e=new Ki({props:{api:t[0],options:t[12],parent:t[7]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n[0]&&(s.api=t[0]),4096&n[0]&&(s.options=t[12]),128&n[0]&&(s.parent=t[7]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function dr(t){let e,n;return e=new Ki({props:{api:t[0],options:t[13],parent:t[8]}}),e.$on("click",t[33]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n[0]&&(s.api=t[0]),8192&n[0]&&(s.options=t[13]),256&n[0]&&(s.parent=t[8]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ur(t){let e,n,s,i,o,r,a,c,l,d,u,p,h,f,m,g,$,k,y,v,x,b,j=t[3]&&Ke(t[3].id,t[1].id),C=t[5]&&Uo(t);i=new so({props:{checked:t[1].checked}}),i.$on("change",t[30]);let D=t[14][t[1].priority]&&Zo(t);const P=[Ko,Qo],N=[];function A(t,e){return t[10]&&!t[16]?0:1}l=A(t),d=N[l]=P[l](t),p=new qo({props:{id:t[1].id,open:t[15]?.open&&Ke(t[1].id,t[15]?.id),format:t[17]?.date?.format,validate:t[17]?.date?.validate,completed:t[1].checked,value:t[1].due_date,readonly:t[16]}}),p.$on("action",t[46]);let R=t[5]&&tr(t),F=t[12]?.length&&sr(t),O=!t[16]&&t[9]&&ar(t),z=j&&cr(t);return{c(){e=T("div"),n=T("div"),C&&C.c(),s=I(),$t(i.$$.fragment),o=I(),r=T("div"),D&&D.c(),a=I(),c=T("div"),d.c(),u=I(),$t(p.$$.fragment),f=I(),m=T("div"),R&&R.c(),g=I(),F&&F.c(),$=I(),O&&O.c(),v=I(),z&&z.c(),x=M(),E(n,"class","wx-todo_list__controls wx-todo_list__controls-manual svelte-yd416y"),E(c,"class","wx-todo_list__text svelte-yd416y"),E(r,"class","wx-todo_list__content svelte-yd416y"),E(r,"data-list-editor-id",h=t[1].id),E(m,"class","wx-todo_list__controls svelte-yd416y"),E(e,"tabindex","0"),E(e,"data-list-level",t[2]),E(e,"data-list-id",k=t[1].id),E(e,"data-drag-list-id",y=t[1].id),E(e,"class","wx-todo_list svelte-yd416y"),H(e,"padding-left",t[11]+"px"),L(e,"wx-todo_list--selected",t[1].selected&&!t[10]),L(e,"wx-todo_list--draggable",t[1].draggable&&!t[10])},m(d,h){_(d,e,h),w(e,n),C&&C.m(n,null),w(n,s),kt(i,n,null),w(e,o),w(e,r),D&&D.m(r,null),w(r,a),w(r,c),N[l].m(c,null),w(r,u),kt(p,r,null),w(e,f),w(e,m),R&&R.m(m,null),w(m,g),F&&F.m(m,null),w(m,$),O&&O.m(m,null),t[49](e),_(d,v,h),z&&z.m(d,h),_(d,x,h),b=!0},p(t,o){t[5]?C?(C.p(t,o),32&o[0]&&ut(C,1)):(C=Uo(t),C.c(),ut(C,1),C.m(n,s)):C&&(lt(),pt(C,1,1,(()=>{C=null})),dt());const u={};2&o[0]&&(u.checked=t[1].checked),i.$set(u),t[14][t[1].priority]?D?(D.p(t,o),16386&o[0]&&ut(D,1)):(D=Zo(t),D.c(),ut(D,1),D.m(r,a)):D&&(lt(),pt(D,1,1,(()=>{D=null})),dt());let f=l;l=A(t),l===f?N[l].p(t,o):(lt(),pt(N[f],1,1,(()=>{N[f]=null})),dt(),d=N[l],d?d.p(t,o):(d=N[l]=P[l](t),d.c()),ut(d,1),d.m(c,null));const v={};2&o[0]&&(v.id=t[1].id),32770&o[0]&&(v.open=t[15]?.open&&Ke(t[1].id,t[15]?.id)),131072&o[0]&&(v.format=t[17]?.date?.format),131072&o[0]&&(v.validate=t[17]?.date?.validate),2&o[0]&&(v.completed=t[1].checked),2&o[0]&&(v.value=t[1].due_date),65536&o[0]&&(v.readonly=t[16]),p.$set(v),(!b||2&o[0]&&h!==(h=t[1].id))&&E(r,"data-list-editor-id",h),t[5]?R?R.p(t,o):(R=tr(t),R.c(),R.m(m,g)):R&&(R.d(1),R=null),t[12]?.length?F?(F.p(t,o),4096&o[0]&&ut(F,1)):(F=sr(t),F.c(),ut(F,1),F.m(m,$)):F&&(lt(),pt(F,1,1,(()=>{F=null})),dt()),!t[16]&&t[9]?O?(O.p(t,o),66048&o[0]&&ut(O,1)):(O=ar(t),O.c(),ut(O,1),O.m(m,null)):O&&(lt(),pt(O,1,1,(()=>{O=null})),dt()),(!b||4&o[0])&&E(e,"data-list-level",t[2]),(!b||2&o[0]&&k!==(k=t[1].id))&&E(e,"data-list-id",k),(!b||2&o[0]&&y!==(y=t[1].id))&&E(e,"data-drag-list-id",y),(!b||2048&o[0])&&H(e,"padding-left",t[11]+"px"),(!b||1026&o[0])&&L(e,"wx-todo_list--selected",t[1].selected&&!t[10]),(!b||1026&o[0])&&L(e,"wx-todo_list--draggable",t[1].draggable&&!t[10]),10&o[0]&&(j=t[3]&&Ke(t[3].id,t[1].id)),j?z?(z.p(t,o),10&o[0]&&ut(z,1)):(z=cr(t),z.c(),ut(z,1),z.m(x.parentNode,x)):z&&(lt(),pt(z,1,1,(()=>{z=null})),dt())},i(t){b||(ut(C),ut(i.$$.fragment,t),ut(D),ut(d),ut(p.$$.fragment,t),ut(F),ut(O),ut(z),b=!0)},o(t){pt(C),pt(i.$$.fragment,t),pt(D),pt(d),pt(p.$$.fragment,t),pt(F),pt(O),pt(z),b=!1},d(n){n&&S(e),C&&C.d(),yt(i),D&&D.d(),N[l].d(),yt(p),R&&R.d(),F&&F.d(),O&&O.d(),t[49](null),n&&S(v),z&&z.d(n),n&&S(x)}}}function pr(t,e,n){let s,i,o,r,a,c,l,d,u,h,f,m,g,$,k,y,v,x,b,w,_,S,j,T,C;const I=J(),M=G("wx-i18n").getGroup("todo");let{store:D}=e,{api:P}=e,{task:E}=e,{level:N=0}=e,A=null,H=null,L=null;const R=P.getReactiveState(),{stateDueDate:F,stateEditableItem:O,menuState:z,filter:q,tags:Y,taskShape:W,readonly:U,priorityMap:Z,menu:Q}=R;return p(t,F,(t=>n(39,b=t))),p(t,O,(t=>n(45,C=t))),p(t,z,(t=>n(44,T=t))),p(t,q,(t=>n(43,j=t))),p(t,Y,(t=>n(42,S=t))),p(t,W,(t=>n(41,_=t))),p(t,U,(t=>n(40,w=t))),p(t,Z,(t=>n(38,x=t))),p(t,Q,(t=>n(37,v=t))),E.selected&&B((()=>A?.focus())),t.$$set=t=>{"store"in t&&n(34,D=t.store),"api"in t&&n(0,P=t.api),"task"in t&&n(1,E=t.task),"level"in t&&n(2,N=t.level)},t.$$.update=()=>{16384&t.$$.dirty[1]&&n(4,s=C),8192&t.$$.dirty[1]&&n(3,i=T),4096&t.$$.dirty[1]&&n(19,o=j),2048&t.$$.dirty[1]&&n(18,r=S),1024&t.$$.dirty[1]&&n(17,a=_),512&t.$$.dirty[1]&&n(16,c=w),256&t.$$.dirty[1]&&n(15,l=b),128&t.$$.dirty[1]&&n(14,d=x),64&t.$$.dirty[1]&&n(35,u=v),8&t.$$.dirty[0]&&n(13,h=Js(i?.options?.length?i?.options:[],M)),2&t.$$.dirty[0]&&n(12,f=Js(E?.availableUsers,M)),2&t.$$.dirty[0]&&n(5,m=E?.children?.length),32&t.$$.dirty[0]&&n(36,g=m?16:40),4&t.$$.dirty[0]|32&t.$$.dirty[1]&&n(11,$=g+(N>1?24*(N-1):0)),18&t.$$.dirty[0]&&n(10,k="task"===s?.type&&Ke(s?.id,E.id)),3&t.$$.dirty[0]|16&t.$$.dirty[1]&&n(9,y=Gs(u,{store:P,type:"task",source:[E.id]}))},[P,E,N,i,s,m,A,H,L,y,k,$,f,h,d,l,c,a,r,o,M,F,O,z,q,Y,W,U,Z,Q,function(){E?.checked?P.exec("uncheck-task",{id:E.id}):js({store:D,id:E.id})},function(){I("action",{action:E.collapsed?"expand-task":"collapse-task",data:{id:E.id}})},function(t){const{value:e,dropdown:n,targetDate:s}=t.detail;I("action",{action:"edit-item",data:{id:E.id,currentValue:e,dropdown:n,targetDate:s}})},function(t){const e=t.detail.action?.id??t.detail.action;e?I("action",{action:"click-menu-item",data:{id:i.id,action:e,type:"task"}}):P.exec("close-menu")},D,u,g,v,x,b,w,_,S,j,T,C,function(e){V.call(this,t,e)},function(t){X[t?"unshift":"push"]((()=>{H=t,n(7,H)}))},function(t){X[t?"unshift":"push"]((()=>{L=t,n(8,L)}))},function(t){X[t?"unshift":"push"]((()=>{A=t,n(6,A)}))}]}class hr extends bt{constructor(t){super(),xt(this,t,pr,ur,d,{store:34,api:0,task:1,level:2},null,[-1,-1])}}function fr(t){let e,n;return{c(){e=T("div"),n=T("div"),E(n,"class","wx-todo_separator__line svelte-1go2pdj"),E(e,"class","wx-todo_separator svelte-1go2pdj"),H(e,"padding",t[0]),E(e,"data-separator",!0)},m(t,s){_(t,e,s),w(e,n)},p(t,[n]){1&n&&H(e,"padding",t[0])},i:i,o:i,d(t){t&&S(e)}}}function mr(t,e,n){let{padding:s="6px 16px"}=e;return t.$$set=t=>{"padding"in t&&n(0,s=t.padding)},[s]}class gr extends bt{constructor(t){super(),xt(this,t,mr,fr,d,{padding:0})}}function $r(t,e,n){const s=t.slice();return s[13]=e[n],s}function kr(t){let e,n,s,i,o,r,a;n=new hr({props:{store:t[2],api:t[0],task:t[13],level:t[4]+1}}),n.$on("action",t[11]);const c=t[10].default,l=h(c,t,t[9],null);let d=t[13].children.length&&!t[13].collapsed&&yr(t),u=0===t[4]&&vr();return{c(){e=T("li"),$t(n.$$.fragment),s=I(),l&&l.c(),i=I(),d&&d.c(),o=I(),u&&u.c(),r=I(),E(e,"class","wx-todo_tree__row svelte-142wxj")},m(t,c){_(t,e,c),kt(n,e,null),w(e,s),l&&l.m(e,null),w(e,i),d&&d.m(e,null),w(e,o),u&&u.m(e,null),w(e,r),a=!0},p(t,s){const i={};4&s&&(i.store=t[2]),1&s&&(i.api=t[0]),8&s&&(i.task=t[13]),16&s&&(i.level=t[4]+1),n.$set(i),l&&l.p&&(!a||512&s)&&g(l,c,t,t[9],a?m(c,t[9],s,null):$(t[9]),null),t[13].children.length&&!t[13].collapsed?d?(d.p(t,s),8&s&&ut(d,1)):(d=yr(t),d.c(),ut(d,1),d.m(e,o)):d&&(lt(),pt(d,1,1,(()=>{d=null})),dt()),0===t[4]?u?16&s&&ut(u,1):(u=vr(),u.c(),ut(u,1),u.m(e,r)):u&&(lt(),pt(u,1,1,(()=>{u=null})),dt())},i(t){a||(ut(n.$$.fragment,t),ut(l,t),ut(d),ut(u),a=!0)},o(t){pt(n.$$.fragment,t),pt(l,t),pt(d),pt(u),a=!1},d(t){t&&S(e),yt(n),l&&l.d(t),d&&d.d(),u&&u.d()}}}function yr(t){let e,n;return e=new _r({props:{state:t[1],store:t[2],api:t[0],level:t[4]+1,data:t[13].children}}),e.$on("action",t[12]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.state=t[1]),4&n&&(s.store=t[2]),1&n&&(s.api=t[0]),16&n&&(s.level=t[4]+1),8&n&&(s.data=t[13].children),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function vr(t){let e,n;return e=new gr({}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function xr(t,e){let n,s,i,o=!(e[6]&&e[13].checked)&&kr(e);return{key:t,first:null,c(){n=M(),o&&o.c(),s=M(),this.first=n},m(t,e){_(t,n,e),o&&o.m(t,e),_(t,s,e),i=!0},p(t,n){(e=t)[6]&&e[13].checked?o&&(lt(),pt(o,1,1,(()=>{o=null})),dt()):o?(o.p(e,n),72&n&&ut(o,1)):(o=kr(e),o.c(),ut(o,1),o.m(s.parentNode,s))},i(t){i||(ut(o),i=!0)},o(t){pt(o),i=!1},d(t){t&&S(n),o&&o.d(t),t&&S(s)}}}function br(t){let e,n,s=[],i=new Map,o=t[3];const r=t=>t[13].id;for(let e=0;e<o.length;e+=1){let n=$r(t,o,e),a=r(n);i.set(a,s[e]=xr(a,n))}return{c(){e=T("ul");for(let t=0;t<s.length;t+=1)s[t].c();E(e,"class","wx-todo_tree svelte-142wxj"),E(e,"data-todo-wrapper-id",t[5]),L(e,"wx-todo_tree--root",!t[4])},m(t,i){_(t,e,i);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(e,null);n=!0},p(t,[a]){607&a&&(o=t[3],lt(),s=mt(s,a,r,1,t,o,i,e,ft,xr,null,$r),dt()),(!n||32&a)&&E(e,"data-todo-wrapper-id",t[5]),(!n||16&a)&&L(e,"wx-todo_tree--root",!t[4])},i(t){if(!n){for(let t=0;t<o.length;t+=1)ut(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)pt(s[t]);n=!1},d(t){t&&S(e);for(let t=0;t<s.length;t+=1)s[t].d()}}}function wr(t,e,n){let s,i,{$$slots:o={},$$scope:r}=e,{api:a}=e,{state:c}=e,{store:l}=e,{data:d}=e,{level:u=0}=e,{id:h}=e;const f=c.taskShape;return p(t,f,(t=>n(8,i=t))),t.$$set=t=>{"api"in t&&n(0,a=t.api),"state"in t&&n(1,c=t.state),"store"in t&&n(2,l=t.store),"data"in t&&n(3,d=t.data),"level"in t&&n(4,u=t.level),"id"in t&&n(5,h=t.id),"$$scope"in t&&n(9,r=t.$$scope)},t.$$.update=()=>{256&t.$$.dirty&&n(6,s=i?.completed?.taskHide)},[a,c,l,d,u,h,s,f,i,r,o,function(e){V.call(this,t,e)},function(e){V.call(this,t,e)}]}class _r extends bt{constructor(t){super(),xt(this,t,wr,br,d,{api:0,state:1,store:2,data:3,level:4,id:5})}}function Sr(t){let e,n;return e=new _r({props:{data:t[2],id:t[3],state:t[4],store:t[1],api:t[0]}}),e.$on("action",t[7]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,[n]){const s={};4&n&&(s.data=t[2]),8&n&&(s.id=t[3]),2&n&&(s.store=t[1]),1&n&&(s.api=t[0]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function jr(t,e,n){let s,i,{api:o}=e,{store:r}=e;const a=r.getReactive(),c=a.treeTasks;p(t,c,(t=>n(2,s=t)));const l=a.id;return p(t,l,(t=>n(3,i=t))),t.$$set=t=>{"api"in t&&n(0,o=t.api),"store"in t&&n(1,r=t.store)},[o,r,s,i,a,c,l,function(e){V.call(this,t,e)}]}class Tr extends bt{constructor(t){super(),xt(this,t,jr,Sr,d,{api:0,store:1})}}function Cr(t){let e,n,s,o,r,a;return s=new Ci({props:{name:"plus",size:16}}),{c(){e=T("div"),n=T("div"),$t(s.$$.fragment),o=I(),r=T("span"),r.textContent=`${t[1]("Add task")}`,E(n,"class","wx-todo_button-add__icon svelte-1c08e70"),E(r,"class","wx-todo_button-add__text svelte-1c08e70"),E(e,"class","wx-todo_button-add__content svelte-1c08e70")},m(t,i){_(t,e,i),w(e,n),kt(s,n,null),w(e,o),w(e,r),a=!0},p:i,i(t){a||(ut(s.$$.fragment,t),a=!0)},o(t){pt(s.$$.fragment,t),a=!1},d(t){t&&S(e),yt(s)}}}function Ir(t){let e;return{c(){e=T("mark"),e.textContent=`${window.atob("VHJpYWw=")}`,E(e,"class","wx-todo_mark svelte-1c08e70"),L(e,"wx-todo_mark--error",1772585103000<new Date)},m(t,n){_(t,e,n)},p(t,e){0},d(t){t&&S(e)}}}function Mr(t){let e,n,s,i,o,r,a=!t[0]();n=new ro({props:{height:36,width:"100%",$$slots:{default:[Cr]},$$scope:{ctx:t}}}),n.$on("click",t[2]),i=new gr({});let c=a&&Ir();return{c(){e=T("div"),$t(n.$$.fragment),s=I(),$t(i.$$.fragment),o=I(),c&&c.c(),E(e,"class","wx-todo_button-add svelte-1c08e70")},m(t,a){_(t,e,a),kt(n,e,null),w(e,s),kt(i,e,null),w(e,o),c&&c.m(e,null),r=!0},p(t,[s]){const i={};8&s&&(i.$$scope={dirty:s,ctx:t}),n.$set(i),1&s&&(a=!t[0]()),a?c?c.p(t,s):(c=Ir(),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},i(t){r||(ut(n.$$.fragment,t),ut(i.$$.fragment,t),r=!0)},o(t){pt(n.$$.fragment,t),pt(i.$$.fragment,t),r=!1},d(t){t&&S(e),yt(n),yt(i),c&&c.d()}}}function Dr(t,e,n){let s;return s=()=>{if("undefined"==typeof window)return!0;const t=location.hostname,e=["ZGh0bWx4LmNvbQ==","ZGh0bWx4Y29kZS5jb20=","d2ViaXhjb2RlLmNvbQ==","d2ViaXguaW8=","cmVwbC5jbw==","Y3NiLmFwcA==","cmVwbGl0LmRldg=="];for(let n=0;n<e.length;n++){const s=window.atob(e[n]);if(s===t||t.endsWith("."+s))return!0}return!1},[s,G("wx-i18n").getGroup("todo"),function(e){V.call(this,t,e)}]}class Pr extends bt{constructor(t){super(),xt(this,t,Dr,Mr,d,{})}}const Er=[];function Nr(t,e=i){let n;const s=new Set;function o(e){if(d(t,e)&&(t=e,n)){const e=!Er.length;for(const e of s)e[1](),Er.push(e,t);if(e){for(let t=0;t<Er.length;t+=2)Er[t][0](Er[t+1]);Er.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(r,a=i){const c=[r,a];return s.add(c),1===s.size&&(n=e(o)||i),r(t),()=>{s.delete(c),0===s.size&&n&&(n(),n=null)}}}}function Ar(t){let e,n;return e=new Pr({}),e.$on("click",t[6]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p:i,i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Hr(t){let e,n,s,i,o,r,a,d,u,p,h=!t[1]&&Ar(t);return i=new Tr({props:{api:t[3],store:t[4]}}),i.$on("action",t[5]),{c(){e=T("div"),h&&h.c(),n=I(),s=T("div"),$t(i.$$.fragment),E(s,"class","wx-todo__wrapper svelte-1u9lx38"),E(e,"class","wx-todo svelte-1u9lx38"),E(e,"data-todo-id",t[0])},m(c,l){_(c,e,l),h&&h.m(e,null),w(e,n),w(e,s),kt(i,s,null),d=!0,u||(p=[D(s,"contextmenu",Fr),x(ti.call(null,s,{api:t[3]})),x(o=Vs.call(null,s,{api:t[3],readonly:t[1]})),x(r=Qs.call(null,s,{api:t[3],readonly:t[1]})),x(a=Xs.call(null,s,{api:t[3],readonly:!t[2]||t[1],id:t[0]})),x(Ks.call(null,s,{api:t[3]}))],u=!0)},p(t,s){t[1]?h&&(lt(),pt(h,1,1,(()=>{h=null})),dt()):h?(h.p(t,s),2&s&&ut(h,1)):(h=Ar(t),h.c(),ut(h,1),h.m(e,n)),o&&l(o.update)&&2&s&&o.update.call(null,{api:t[3],readonly:t[1]}),r&&l(r.update)&&2&s&&r.update.call(null,{api:t[3],readonly:t[1]}),a&&l(a.update)&&7&s&&a.update.call(null,{api:t[3],readonly:!t[2]||t[1],id:t[0]}),(!d||1&s)&&E(e,"data-todo-id",t[0])},i(t){d||(ut(h),ut(i.$$.fragment,t),d=!0)},o(t){pt(h),pt(i.$$.fragment,t),d=!1},d(t){t&&S(e),h&&h.d(),yt(i),u=!1,c(p)}}}function Lr(t){let e,n;return e=new Oe({props:{$$slots:{default:[Hr]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};524295&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Rr(t){let e,n,s,i,o,r;return s=new He({props:{words:{...qe,...ze},optional:!0,$$slots:{default:[Lr]},$$scope:{ctx:t}}}),{c(){$t(s.$$.fragment)},m(a,c){kt(s,a,c),i=!0,o||(r=[x(e=ni.call(null,window,{api:t[3],widgetId:t[0]})),x(n=ei.call(null,window,{api:t[3],readonly:t[1]}))],o=!0)},p(t,[i]){e&&l(e.update)&&1&i&&e.update.call(null,{api:t[3],widgetId:t[0]}),n&&l(n.update)&&2&i&&n.update.call(null,{api:t[3],readonly:t[1]});const o={};524295&i&&(o.$$scope={dirty:i,ctx:t}),s.$set(o)},i(t){i||(ut(s.$$.fragment,t),i=!0)},o(t){pt(s.$$.fragment,t),i=!1},d(t){yt(s,t),o=!1,c(r)}}}const Fr=t=>t.preventDefault();function Or(t,e,n){let{id:s=Qe()}=e,{tasks:i=[]}=e,{projects:o=[]}=e,{users:r=[]}=e,{tags:a=[]}=e,{selected:c=[]}=e,{activeProject:l}=e,{readonly:d=!1}=e,{taskShape:u=un}=e,{drag:p=pn}=e,{priorities:h=null}=e,{menu:f=!0}=e,{history:m=!0}=e;const g=J(),$=new Bs(Nr,{history:m});let k=new Xe(g);const y=function(t,e){let n=e;return{exec:t.in.exec,getState:t.getState.bind(t),getReactiveState:t.getReactive.bind(t),setNext:t=>{n.setNext(t.exec),n=t},getStores:()=>({state:t}),intercept:t.in.on.bind(t.in),on:t.out.on.bind(t.out),getSelection:e=>t.getSelection(e),eachSelected:(e,n,s)=>t.eachSelected(e,n,s),serialize:()=>t.serialize(),parse:e=>t.parse(e),existsTask:({id:e})=>t.existsTask(e),existsProject:({id:e})=>t.existsProject(e),getTask:({id:e})=>t.getTask(e),getProject:({id:e})=>t.getProject(e),hasChildren:({id:e,filtered:n,hideCompleted:s})=>t.hasChildren(e,n,s),getChildrenIds:e=>t.getChildrenIds(e),getParentIds:({id:e})=>t.getParentIds(e),undo:()=>t.undo(),redo:()=>t.redo()}}($,k);return $.out.setNext(k.exec),t.$$set=t=>{"id"in t&&n(0,s=t.id),"tasks"in t&&n(7,i=t.tasks),"projects"in t&&n(8,o=t.projects),"users"in t&&n(9,r=t.users),"tags"in t&&n(10,a=t.tags),"selected"in t&&n(11,c=t.selected),"activeProject"in t&&n(12,l=t.activeProject),"readonly"in t&&n(1,d=t.readonly),"taskShape"in t&&n(13,u=t.taskShape),"drag"in t&&n(2,p=t.drag),"priorities"in t&&n(14,h=t.priorities),"menu"in t&&n(15,f=t.menu),"history"in t&&n(16,m=t.history)},t.$$.update=()=>{65415&t.$$.dirty&&$.init({tasks:i,users:r,tags:a,selected:c,taskShape:{...un,...u},drag:p?{...pn,...p}:p,priorities:Array.isArray(h)&&h||hn,projects:o,activeProject:l,readonly:d,id:s,menu:f})},[s,d,p,y,$,function(t){const{action:e,data:n}=t.detail;$.in.exec(e,n)},function(t){tn($.getState().filter)||(t.stopPropagation(),is({store:$,reverse:!0}))},i,o,r,a,c,l,u,h,f,m]}class zr extends bt{constructor(t){super(),xt(this,t,Or,Rr,d,{id:0,tasks:7,projects:8,users:9,tags:10,selected:11,activeProject:12,readonly:1,taskShape:13,drag:2,priorities:14,menu:15,history:16,api:3})}get api(){return this.$$.ctx[3]}}function qr(t){let e;const n=t[1].default,s=h(n,t,t[2],null);return{c(){s&&s.c()},m(t,n){s&&s.m(t,n),e=!0},p(t,i){s&&s.p&&(!e||4&i)&&g(s,n,t,t[2],e?m(n,t[2],i,null):$(t[2]),null)},i(t){e||(ut(s,t),e=!0)},o(t){pt(s,t),e=!1},d(t){s&&s.d(t)}}}function Br(t){let e,n,s=t[0]&&qr(t);return{c(){e=T("div"),s&&s.c(),E(e,"class","wx-todo_toolbar svelte-18c2a5y")},m(t,i){_(t,e,i),s&&s.m(e,null),n=!0},p(t,n){t[0]?s?(s.p(t,n),1&n&&ut(s,1)):(s=qr(t),s.c(),ut(s,1),s.m(e,null)):s&&(lt(),pt(s,1,1,(()=>{s=null})),dt())},i(t){n||(ut(s),n=!0)},o(t){pt(s),n=!1},d(t){t&&S(e),s&&s.d()}}}function Yr(t){let e,n;return e=new He({props:{words:{...qe,...ze},optional:!0,$$slots:{default:[Br]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,[n]){const s={};5&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Jr(t,e,n){let{$$slots:s={},$$scope:i}=e,{api:o}=e;return t.$$set=t=>{"api"in t&&n(0,o=t.api),"$$scope"in t&&n(2,i=t.$$scope)},[o,s,i]}class Wr extends bt{constructor(t){super(),xt(this,t,Jr,Yr,d,{api:0})}}function Gr(t){let e,n,s;return n=new Ci({props:{name:"dots-v"}}),n.$on("click",t[11]),{c(){e=T("button"),$t(n.$$.fragment),E(e,"class","wx-todo_toolbar-menu-button svelte-r66yne"),E(e,"tabindex","0"),E(e,"data-toolbar-icon",!0),E(e,"data-todo-id",t[9])},m(i,o){_(i,e,o),kt(n,e,null),t[15](e),s=!0},p(t,n){(!s||512&n)&&E(e,"data-todo-id",t[9])},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(s){s&&S(e),yt(n),t[15](null)}}}function Vr(t){let e,n;return e=new Ki({props:{api:t[0],options:t[4],parent:t[2]}}),e.$on("click",t[10]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),16&n&&(s.options=t[4]),4&n&&(s.parent=t[2]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Ur(t){let e,n,s,i=t[3]&&Gr(t),o="toolbar"===t[1]?.type&&Vr(t);return{c(){i&&i.c(),e=I(),o&&o.c(),n=M()},m(t,r){i&&i.m(t,r),_(t,e,r),o&&o.m(t,r),_(t,n,r),s=!0},p(t,[s]){t[3]?i?(i.p(t,s),8&s&&ut(i,1)):(i=Gr(t),i.c(),ut(i,1),i.m(e.parentNode,e)):i&&(lt(),pt(i,1,1,(()=>{i=null})),dt()),"toolbar"===t[1]?.type?o?(o.p(t,s),2&s&&ut(o,1)):(o=Vr(t),o.c(),ut(o,1),o.m(n.parentNode,n)):o&&(lt(),pt(o,1,1,(()=>{o=null})),dt())},i(t){s||(ut(i),ut(o),s=!0)},o(t){pt(i),pt(o),s=!1},d(t){i&&i.d(t),t&&S(e),o&&o.d(t),t&&S(n)}}}function Xr(t,e,n){let s,o,r,a,c,l,d,p,h,f,m,g=i,$=i,k=i,y=i;t.$$.on_destroy.push((()=>g())),t.$$.on_destroy.push((()=>$())),t.$$.on_destroy.push((()=>k())),t.$$.on_destroy.push((()=>y()));let{api:v}=e;const x=G("wx-i18n").getGroup("todo");let b=null;return t.$$set=t=>{"api"in t&&n(0,v=t.api)},t.$$.update=()=>{1&t.$$.dirty&&n(12,s=v.getReactiveState()),4096&t.$$.dirty&&(n(8,o=s.id),y(),y=u(o,(t=>n(9,m=t)))),4096&t.$$.dirty&&(n(7,r=s.menuState),k(),k=u(r,(t=>n(1,f=t)))),4096&t.$$.dirty&&(n(6,a=s.activeProject),g(),g=u(a,(t=>n(13,p=t)))),4096&t.$$.dirty&&(n(5,c=s.menu),$(),$=u(c,(t=>n(14,h=t)))),2&t.$$.dirty&&n(4,l=Js(f?.options?.length?f?.options:[],x)),24577&t.$$.dirty&&n(3,d=Gs(h,{store:v.getStores().state,type:"toolbar",id:p}))},[v,f,b,d,l,c,a,r,o,m,function(t){const e=t.detail.action?.id??t.detail.action;e?v.exec("click-menu-item",{id:p,type:"toolbar",action:e,params:{locale:x}}):v.exec("close-menu")},function(){const{menuState:t,activeProject:e}=v.getState();t?.open&&"toolbar"===t.type?v.exec("close-menu",{...t}):v.exec("open-menu",{id:e,type:"toolbar"})},s,p,h,function(t){X[t?"unshift":"push"]((()=>{b=t,n(2,b)}))}]}class Zr extends bt{constructor(t){super(),xt(this,t,Xr,Ur,d,{api:0})}}function Qr(t){let e,n;return e=new Ci({props:{name:"close",clickable:!0}}),e.$on("click",t[3]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p:i,i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Kr(t){let e,n,s,i,o,r,a=t[0]&&Qr(t);return{c(){e=T("div"),n=T("input"),s=I(),a&&a.c(),E(n,"class","wx-todo_input__value svelte-4g7y4h"),E(n,"placeholder",t[1]),E(e,"class","wx-todo_input svelte-4g7y4h")},m(c,l){_(c,e,l),w(e,n),t[7](n),A(n,t[0]),w(e,s),a&&a.m(e,null),i=!0,o||(r=[D(n,"input",t[8]),D(n,"keypress",t[4]),D(n,"focus",t[5]),D(n,"blur",t[6])],o=!0)},p(t,[s]){(!i||2&s)&&E(n,"placeholder",t[1]),1&s&&n.value!==t[0]&&A(n,t[0]),t[0]?a?(a.p(t,s),1&s&&ut(a,1)):(a=Qr(t),a.c(),ut(a,1),a.m(e,null)):a&&(lt(),pt(a,1,1,(()=>{a=null})),dt())},i(t){i||(ut(a),i=!0)},o(t){pt(a),i=!1},d(n){n&&S(e),t[7](null),a&&a.d(),o=!1,c(r)}}}function ta(t,e,n){let{placeholder:s=""}=e,{value:i=""}=e,o=null;const r=J();return t.$$set=t=>{"placeholder"in t&&n(1,s=t.placeholder),"value"in t&&n(0,i=t.value)},t.$$.update=()=>{5&t.$$.dirty&&(o||i)&&setTimeout((()=>Ss(o)))},[i,s,o,function(){n(0,i=""),r("clear"),o?.focus()},function(e){V.call(this,t,e)},function(e){V.call(this,t,e)},function(e){V.call(this,t,e)},function(t){X[t?"unshift":"push"]((()=>{o=t,n(2,o)}))},function(){i=this.value,n(0,i)}]}class ea extends bt{constructor(t){super(),xt(this,t,ta,Kr,d,{placeholder:1,value:0})}}function na(t){let e,n,s,i,o;function r(e){t[19](e)}let a={placeholder:t[8]("Search")};void 0!==t[1].value&&(a.value=t[1].value),n=new ea({props:a}),X.push((()=>gt(n,"value",r))),n.$on("focus",t[10]),n.$on("blur",t[11]);let c=t[0]&&t[2]?.open&&t[1].value&&sa(t);return{c(){e=T("div"),$t(n.$$.fragment),i=I(),c&&c.c(),E(e,"class","wx-todo_search__input svelte-1fjg0pe")},m(t,s){_(t,e,s),kt(n,e,null),w(e,i),c&&c.m(e,null),o=!0},p(t,i){const o={};!s&&2&i&&(s=!0,o.value=t[1].value,nt((()=>s=!1))),n.$set(o),t[0]&&t[2]?.open&&t[1].value?c?(c.p(t,i),7&i&&ut(c,1)):(c=sa(t),c.c(),ut(c,1),c.m(e,null)):c&&(lt(),pt(c,1,1,(()=>{c=null})),dt())},i(t){o||(ut(n.$$.fragment,t),ut(c),o=!0)},o(t){pt(n.$$.fragment,t),pt(c),o=!1},d(t){t&&S(e),yt(n),c&&c.d()}}}function sa(t){let e,n;return e=new Pt({props:{width:"fit-content",cancel:t[13],$$slots:{default:[oa]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};8388612&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ia(t){let e,n;return e=new Ni({props:{item:t[22]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};4194304&n&&(s.item=t[22]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function oa(t){let e,n;return e=new So({props:{options:t[2].options,$$slots:{default:[ia,({item:t})=>({22:t}),({item:t})=>t?4194304:0]},$$scope:{ctx:t}}}),e.$on("click",t[12]),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.options=t[2].options),12582912&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ra(t){let e,n,s,i;n=new Ci({props:{name:"search",clickable:!0}}),n.$on("click",t[9]);let o=t[1]?.open&&na(t);return{c(){e=T("div"),$t(n.$$.fragment),s=I(),o&&o.c(),E(e,"data-todo-id",t[7]),E(e,"class","wx-todo_search svelte-1fjg0pe"),L(e,"wx-todo_search--opened",t[1]?.open)},m(r,a){_(r,e,a),kt(n,e,null),w(e,s),o&&o.m(e,null),t[20](e),i=!0},p(t,[n]){t[1]?.open?o?(o.p(t,n),2&n&&ut(o,1)):(o=na(t),o.c(),ut(o,1),o.m(e,null)):o&&(lt(),pt(o,1,1,(()=>{o=null})),dt()),(!i||128&n)&&E(e,"data-todo-id",t[7]),(!i||2&n)&&L(e,"wx-todo_search--opened",t[1]?.open)},i(t){i||(ut(n.$$.fragment,t),ut(o),i=!0)},o(t){pt(n.$$.fragment,t),pt(o),i=!1},d(s){s&&S(e),yt(n),o&&o.d(),t[20](null)}}}function aa(t,e,n){let s,o,r,a,c,l,d,p,h,f,m=i,g=i,$=i,k=i;t.$$.on_destroy.push((()=>m())),t.$$.on_destroy.push((()=>g())),t.$$.on_destroy.push((()=>$())),t.$$.on_destroy.push((()=>k()));let{api:y}=e,v=null,x=null;const b=G("wx-i18n").getGroup("todo");function w(){y?.exec("set-state-search",{...d,dropdown:{open:!1}}),n(15,x=null)}return t.$$set=t=>{"api"in t&&n(14,y=t.api)},t.$$.update=()=>{16384&t.$$.dirty&&n(16,s=y.getReactiveState()),65536&t.$$.dirty&&(n(6,o=s.id),k(),k=u(o,(t=>n(7,f=t)))),65536&t.$$.dirty&&(n(5,r=s.filter),$(),$=u(r,(t=>n(18,h=t)))),65536&t.$$.dirty&&(n(4,a=s.tags),g(),g=u(a,(t=>n(17,p=t)))),65536&t.$$.dirty&&(n(3,c=s.stateSearch),m(),m=u(c,(t=>n(1,d=t)))),2&t.$$.dirty&&n(2,l=d?.dropdown),442371&t.$$.dirty&&tn(d?.value)&&d.value!==(h?.match||"")&&d.focus&&(d.value?.length?y.exec("set-filter",{match:d.value,highlight:!0,strict:d.value?.startsWith("#")&&p.includes(d.value)}):y.exec("set-filter",{match:null}),v&&d.value?.startsWith("#")&&x!==d?.value?function(){const t=Ys(p,d.value);setTimeout((()=>{y.exec("set-state-search",{...d,open:!0,dropdown:{open:!0,options:t}})}),d?.open?0:250)}():w())},[v,d,l,c,a,r,o,f,b,function(){y.exec("set-state-search",{...d,open:!d?.open})},function(){y.exec("set-state-search",{...d,focus:!0})},function(){y.exec("set-state-search",{...d,focus:!1,open:!!d.value?.length})},function(t){n(15,x=t.detail.id),y.exec("set-state-search",{...d,value:x?.length?x:d?.value,dropdown:{open:!1}})},w,y,x,s,p,h,function(e){t.$$.not_equal(d.value,e)&&(d.value=e,c.set(d))},function(t){X[t?"unshift":"push"]((()=>{v=t,n(0,v)}))}]}class ca extends bt{constructor(t){super(),xt(this,t,aa,ra,d,{api:14})}}function la(t){let e,n;return{c(){e=T("div"),n=C(t[2]),E(e,"class","wx-todo_text__value svelte-ti50q3"),E(e,"tabindex","0")},m(t,s){_(t,e,s),w(e,n)},p(t,e){4&e&&N(n,t[2])},d(t){t&&S(e)}}}function da(t){let e,n,s,i;return{c(){e=T("div"),n=C(t[2]),E(e,"class","wx-todo_text__value svelte-ti50q3"),E(e,"contenteditable",!0),E(e,"data-placeholder",t[1]),E(e,"tabindex","0"),L(e,"wx-todo_text__value--editing",t[0])},m(o,r){_(o,e,r),w(e,n),t[9](e),s||(i=[D(e,"blur",t[7]),D(e,"input",t[5])],s=!0)},p(t,s){4&s&&N(n,t[2]),2&s&&E(e,"data-placeholder",t[1]),1&s&&L(e,"wx-todo_text__value--editing",t[0])},d(n){n&&S(e),t[9](null),s=!1,c(i)}}}function ua(t){let e,n,s;function o(t,e){return t[0]&&t[3]?da:la}let r=o(t),a=r(t);return{c(){e=T("div"),a.c(),E(e,"class","wx-todo_text svelte-ti50q3")},m(i,o){_(i,e,o),a.m(e,null),n||(s=D(e,"dblclick",P(t[6])),n=!0)},p(t,[n]){r===(r=o(t))&&a?a.p(t,n):(a.d(1),a=r(t),a&&(a.c(),a.m(e,null)))},i:i,o:i,d(t){t&&S(e),a.d(),n=!1,s()}}}function pa(t,e,n){let{placeholder:s=""}=e,{value:i=""}=e,{editable:o=!0}=e,{editing:r=!1}=e,{enableRange:a=!1}=e,c=null;const l=J();return t.$$set=t=>{"placeholder"in t&&n(1,s=t.placeholder),"value"in t&&n(2,i=t.value),"editable"in t&&n(3,o=t.editable),"editing"in t&&n(0,r=t.editing),"enableRange"in t&&n(8,a=t.enableRange)},t.$$.update=()=>{272&t.$$.dirty&&c&&(a?function(t){if(!t)return;const e=document.createRange(),n=window.getSelection();e.setStart(t,0),e.setEnd(t,t?.childNodes?.length||0),n.removeAllRanges(),n.addRange(e)}(c):Ss(c))},[r,s,i,o,c,function(){l("editing",{value:c?.textContent||""})},function(){o&&!r&&(n(0,r=!0),l("open",{value:i}))},function(){r&&(n(0,r=!1),l("close",{value:i}))},a,function(t){X[t?"unshift":"push"]((()=>{c=t,n(4,c)}))}]}class ha extends bt{constructor(t){super(),xt(this,t,pa,ua,d,{placeholder:1,value:2,editable:3,editing:0,enableRange:8})}}function fa(t){let e,n;return e=new Pt({props:{width:"fit-content",cancel:t[18],$$slots:{default:[ga]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};3&n[0]|2&n[1]&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ma(t){let e,n;return e=new Ni({props:{item:t[31]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n[1]&&(s.item=t[31]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ga(t){let e,n,s,i,o,r,a,c,l,d,u,p;function h(e){t[30](e)}i=new Ci({props:{name:"search"}});let f={placeholder:t[16]("Search project")};return void 0!==t[0]&&(f.value=t[0]),r=new ea({props:f}),X.push((()=>gt(r,"value",h))),l=new gr({props:{padding:"0"}}),u=new So({props:{options:t[1],$$slots:{default:[ma,({item:t})=>({31:t}),({item:t})=>[0,t?1:0]]},$$scope:{ctx:t}}}),u.$on("click",t[19]),{c(){e=T("div"),n=T("div"),s=T("div"),$t(i.$$.fragment),o=I(),$t(r.$$.fragment),c=I(),$t(l.$$.fragment),d=I(),$t(u.$$.fragment),E(s,"class","wx-todo_combo-search__icon svelte-1fotihc"),E(n,"class","wx-todo_combo-search svelte-1fotihc"),E(e,"class","wx-todo_combo-dropdown")},m(t,a){_(t,e,a),w(e,n),w(n,s),kt(i,s,null),w(n,o),kt(r,n,null),w(e,c),kt(l,e,null),w(e,d),kt(u,e,null),p=!0},p(t,e){const n={};!a&&1&e[0]&&(a=!0,n.value=t[0],nt((()=>a=!1))),r.$set(n);const s={};2&e[0]&&(s.options=t[1]),3&e[1]&&(s.$$scope={dirty:e,ctx:t}),u.$set(s)},i(t){p||(ut(i.$$.fragment,t),ut(r.$$.fragment,t),ut(l.$$.fragment,t),ut(u.$$.fragment,t),p=!0)},o(t){pt(i.$$.fragment,t),pt(r.$$.fragment,t),pt(l.$$.fragment,t),pt(u.$$.fragment,t),p=!1},d(t){t&&S(e),yt(i),yt(r),yt(l),yt(u)}}}function $a(t){let e,n,s,i,o,r,a,c,l,d;s=new ha({props:{editing:t[5],value:t[4],enableRange:!0,placeholder:t[16]("Type what you want"),editable:tn(t[2])&&!t[15]}}),s.$on("close",t[21]),s.$on("open",t[20]),s.$on("editing",t[22]),r=new Ci({props:{name:"menu-down",clickable:!0}});let u=t[13]?.open&&!t[5]&&fa(t);return{c(){e=T("div"),n=T("div"),$t(s.$$.fragment),i=I(),o=T("div"),$t(r.$$.fragment),a=I(),u&&u.c(),E(o,"class","wx-todo_combo__icon"),E(n,"class","wx-todo_combo__wrapper svelte-1fotihc"),E(e,"data-todo-id",t[14]),E(e,"class","wx-todo_combo svelte-1fotihc")},m(p,h){_(p,e,h),w(e,n),kt(s,n,null),w(n,i),w(n,o),kt(r,o,null),t[29](n),w(e,a),u&&u.m(e,null),c=!0,l||(d=D(n,"click",t[17]),l=!0)},p(t,n){const i={};32&n[0]&&(i.editing=t[5]),16&n[0]&&(i.value=t[4]),32772&n[0]&&(i.editable=tn(t[2])&&!t[15]),s.$set(i),t[13]?.open&&!t[5]?u?(u.p(t,n),8224&n[0]&&ut(u,1)):(u=fa(t),u.c(),ut(u,1),u.m(e,null)):u&&(lt(),pt(u,1,1,(()=>{u=null})),dt()),(!c||16384&n[0])&&E(e,"data-todo-id",t[14])},i(t){c||(ut(s.$$.fragment,t),ut(r.$$.fragment,t),ut(u),c=!0)},o(t){pt(s.$$.fragment,t),pt(r.$$.fragment,t),pt(u),c=!1},d(n){n&&S(e),yt(s),yt(r),t[29](null),u&&u.d(),l=!1,d()}}}function ka(t,e,n){let s,o,r,a,c,l,d,p,h,f,m,g,$,k,y,v,x,b,w=i,_=i,S=i,j=i,T=i,C=i,I=i;t.$$.on_destroy.push((()=>w())),t.$$.on_destroy.push((()=>_())),t.$$.on_destroy.push((()=>S())),t.$$.on_destroy.push((()=>j())),t.$$.on_destroy.push((()=>T())),t.$$.on_destroy.push((()=>C())),t.$$.on_destroy.push((()=>I()));let{api:M}=e;const D=G("wx-i18n").getGroup("todo");let P=null,E=null,N=[];function A(t){n(0,E=null),y.open&&!P.contains(t?.target)&&M.exec("set-state-combo",{open:!1})}return t.$$set=t=>{"api"in t&&n(23,M=t.api)},t.$$.update=()=>{8388608&t.$$.dirty[0]&&n(25,s=M.getReactiveState()),33554432&t.$$.dirty[0]&&(n(12,o=s.stateEditableItem),w(),w=u(o,(t=>n(26,g=t)))),33554432&t.$$.dirty[0]&&(n(11,r=s.activeProject),S(),S=u(r,(t=>n(2,k=t)))),33554432&t.$$.dirty[0]&&(n(10,a=s.projects),_(),_=u(a,(t=>n(27,$=t)))),33554432&t.$$.dirty[0]&&(n(9,c=s.tasks),T(),T=u(c,(t=>n(28,v=t)))),33554432&t.$$.dirty[0]&&(n(8,l=s.id),C(),C=u(l,(t=>n(14,x=t)))),33554432&t.$$.dirty[0]&&(n(7,d=s.readonly),I(),I=u(d,(t=>n(15,b=t)))),33554432&t.$$.dirty[0]&&(n(6,p=s.stateCombo),j(),j=u(p,(t=>n(13,y=t)))),67108868&t.$$.dirty[0]&&n(5,h=Ke(g?.id,k)&&"project"===g?.type),402653184&t.$$.dirty[0]&&n(24,f=$.every((t=>tn(t.id)))&&v.some((t=>!tn(t.project)&&!tn(t.parent)))?[{id:null,label:D("No project")},...$]:[...$]),16777220&t.$$.dirty[0]&&n(4,m=(f.find((t=>Ke(k,t?.id)))?.label||D("No project")).trim()),16777223&t.$$.dirty[0]&&(tn(E)?n(1,N=f.filter((({label:t})=>t.toLowerCase().includes(E.toLowerCase())))):n(1,N=f),n(1,N=N.map((t=>{const e=Ke(t.id,k)?"check":"empty";return{...t,icon:e}}))))},[E,N,k,P,m,h,p,d,l,c,a,r,o,y,x,b,D,function(t){n(0,E=null),P.contains(t?.target)&&M.exec("set-state-combo",{open:!y?.open})},A,function(t){M.exec("set-project",{id:t.detail.id}),A(t)},function(){M.exec("open-inline-editor",{id:k,type:"project"})},function(){tn(g?.id)&&M.exec("close-inline-editor",{id:g.id})},function(t){const e=t.detail.value.trim(),n=$.filter((({label:t})=>t!==m));M.exec("edit-item",{id:g.id,currentValue:e.length?e:ms("Untilted",n,D)})},M,f,s,g,$,v,function(t){X[t?"unshift":"push"]((()=>{P=t,n(3,P)}))},function(t){E=t,n(0,E)}]}class ya extends bt{constructor(t){super(),xt(this,t,ka,$a,d,{api:23},null,[-1,-1])}}function va(t){let e,n,s;return n=new Ci({props:{name:"undo",disabled:!t[0],clickable:!0}}),n.$on("click",t[4]),{c(){e=T("div"),$t(n.$$.fragment),E(e,"class","wx-todo_undo svelte-1yvsws5")},m(t,i){_(t,e,i),kt(n,e,null),s=!0},p(t,[e]){const s={};1&e&&(s.disabled=!t[0]),n.$set(s)},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&S(e),yt(n)}}}function xa(t,e,n){let s,o,r,a,c,l,d,p=i,h=i,f=i;t.$$.on_destroy.push((()=>p())),t.$$.on_destroy.push((()=>h())),t.$$.on_destroy.push((()=>f()));let m,{api:g}=e;return t.$$set=t=>{"api"in t&&n(5,g=t.api)},t.$$.update=()=>{if(32&t.$$.dirty&&n(6,s=g.getReactiveState()),64&t.$$.dirty&&(n(3,o=s.historyState),f(),f=u(o,(t=>n(9,d=t)))),64&t.$$.dirty&&(n(2,r=s.activeProject),p(),p=u(r,(t=>n(7,c=t)))),64&t.$$.dirty&&(n(1,a=s.historyState),h(),h=u(a,(t=>n(8,l=t)))),896&t.$$.dirty){const t=d.undo?.filter((t=>{if("object"==typeof t)return"$allBranches"===t.branchId||t.branchId===c;const e=l.batches[t][0];return"$allBranches"===e.branchId||e.branchId===c}));n(0,m=t.length>0)}},[m,a,r,o,function(){g.getStores().state.undo()},g,s,c,l,d]}class ba extends bt{constructor(t){super(),xt(this,t,xa,va,d,{api:5})}}function wa(t){let e,n,s;return n=new Ci({props:{name:"redo",disabled:!t[0],clickable:!0}}),n.$on("click",t[4]),{c(){e=T("div"),$t(n.$$.fragment),E(e,"class","wx-todo_redo svelte-19w14hv")},m(t,i){_(t,e,i),kt(n,e,null),s=!0},p(t,[e]){const s={};1&e&&(s.disabled=!t[0]),n.$set(s)},i(t){s||(ut(n.$$.fragment,t),s=!0)},o(t){pt(n.$$.fragment,t),s=!1},d(t){t&&S(e),yt(n)}}}function _a(t,e,n){let s,o,r,a,c,l,d,p=i,h=i,f=i;t.$$.on_destroy.push((()=>p())),t.$$.on_destroy.push((()=>h())),t.$$.on_destroy.push((()=>f()));let m,{api:g}=e;return t.$$set=t=>{"api"in t&&n(5,g=t.api)},t.$$.update=()=>{if(32&t.$$.dirty&&n(6,s=g.getReactiveState()),64&t.$$.dirty&&(n(3,o=s.historyState),f(),f=u(o,(t=>n(9,d=t)))),64&t.$$.dirty&&(n(2,r=s.activeProject),p(),p=u(r,(t=>n(7,c=t)))),64&t.$$.dirty&&(n(1,a=s.historyState),h(),h=u(a,(t=>n(8,l=t)))),896&t.$$.dirty){const t=d.redo?.filter((t=>{if("object"==typeof t)return"$allBranches"===t.branchId||t.branchId===c;const e=l.batches[t][0];return"$allBranches"===e.branchId||e.branchId===c}));n(0,m=t.length>0)}},[m,a,r,o,function(){g?.getStores().state.redo()},g,s,c,l,d]}class Sa extends bt{constructor(t){super(),xt(this,t,_a,wa,d,{api:5})}}class ja{constructor(t){this._api=t}on(t,e){this._api.on(t,e)}exec(t,e){this._api.exec(t,e)}}class Ta{constructor(t,e){this.container="string"==typeof t?document.querySelector(t):t,this.config=e,this._init()}destructor(){this._widget.$destroy(),this._widget=this.api=this.events=null}setConfig(t){t&&(this.config=Object.assign(Object.assign({},this.config),t),this._init())}parse(t){this.api.parse(t)}serialize(){return this.api.serialize()}existsTask(t){return this.api.existsTask(t)}existsProject(t){return this.api.existsProject(t)}getTask(t){return this.api.getTask(t)}getProject(t){return this.api.getProject(t)}hasChildren(t){return this.api.hasChildren(t)}getChildrenIds(t){return this.api.getChildrenIds(t)}getParentIds(t){return this.api.getParentIds(t)}setLocale(t){t&&this.setConfig({locale:t})}setFilter(t){this.api.exec("set-filter",t)}setSort(t){this.api.exec("set-sort",t)}selectTask(t){this.api.exec("select-task",t)}unselectTask(t){this.api.exec("unselect-task",t)}getSelection(t){return this.api.getSelection(t)}eachSelected(t,e,n){this.api.eachSelected(t,e,n)}addTask(t){this.api.exec("add-task",t)}copyTask(t){this.api.exec("copy-task",t)}pasteTask(t){this.api.exec("paste-task",t)}moveTask(t){this.api.exec("move-task",t)}updateTask(t){this.api.exec("update-task",t)}deleteTask(t){this.api.exec("delete-task",t)}indentTask(t){this.api.exec("indent-task",t)}unindentTask(t){this.api.exec("unindent-task",t)}checkTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.checked)||this.api.exec("check-task",t)}uncheckTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.checked)&&this.api.exec("uncheck-task",t)}expandTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.collapsed)&&this.api.exec("expand-task",t)}collapseTask(t){var e;(null===(e=this.getTask({id:t.id}))||void 0===e?void 0:e.collapsed)||this.api.exec("collapse-task",t)}showCompletedTasks(){this.api.exec("show-completed-tasks",null)}hideCompletedTasks(){this.api.exec("hide-completed-tasks",null)}openInlineEditor(t){this.api.exec("open-inline-editor",t)}closeInlineEditor(t){this.api.exec("close-inline-editor",t)}assignUser(t){this.api.exec("assign-user",t)}unassignUser(t){this.api.exec("unassign-user",t)}addProject(t){this.api.exec("add-project",t)}updateProject(t){this.api.exec("update-project",t)}setProject(t){this.api.exec("set-project",t)}deleteProject(t){this.api.exec("delete-project",t)}undo(){this.api.undo()}redo(){this.api.redo()}_init(){var t;this._widget&&this.destructor();const e=new Map([["wx-i18n",s(null===(t=this.config)||void 0===t?void 0:t.locale)]]);this._widget=new zr({target:this.container,props:Object.assign({},this.config),context:e}),this.api=this._widget.api,this.events=new ja(this.api)}}function Ca(t){let e,n;return{c(){e=new R(!1),n=M(),e.a=n},m(s,i){e.m(t[0],s,i),_(s,n,i)},p(t,n){1&n&&e.p(t[0])},d(t){t&&S(n),t&&e.d()}}}function Ia(t){let e,n=t[0]&&Ca(t);return{c(){n&&n.c(),e=M()},m(t,s){n&&n.m(t,s),_(t,e,s)},p(t,[s]){t[0]?n?n.p(t,s):(n=Ca(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:i,o:i,d(t){n&&n.d(t),t&&S(e)}}}function Ma(t,e,n){let s;const i=["template"];let r=y(e,i),{template:a}=e;return t.$$set=t=>{e=o(o({},e),k(t)),n(2,r=y(e,i)),"template"in t&&n(1,a=t.template)},t.$$.update=()=>{n(0,s="function"==typeof a?a(Object.assign({},r)):a)},[s,a]}class Da extends bt{constructor(t){super(),xt(this,t,Ma,Ia,d,{template:1})}}function Pa(t,e,n){const s=t.slice();return s[2]=e[n],s}function Ea(t){let e,n;return e=new Da({props:{template:t[2].type}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.template=t[2].type),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Na(t){let e,n;return e=new Da({props:{template:t[2].template}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.template=t[2].template),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Aa(t){let e,n;return e=new Sa({props:{api:t[0]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Ha(t){let e,n;return e=new ba({props:{api:t[0]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function La(t){let e,n;return e=new ya({props:{api:t[0]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Ra(t){let e,n;return e=new Zr({props:{api:t[0]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Fa(t){let e,n;return e=new ca({props:{api:t[0]}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Oa(t){let e,n,s,i;const o=[Fa,Ra,La,Ha,Aa,Na,Ea],r=[];function a(t,e){return"search"===t[2].type?0:"menu"===t[2].type?1:"combo"===t[2].type?2:"undo"===t[2].type?3:"redo"===t[2].type?4:t[2].template?5:t[2].type?6:-1}return~(e=a(t))&&(n=r[e]=o[e](t)),{c(){n&&n.c(),s=M()},m(t,n){~e&&r[e].m(t,n),_(t,s,n),i=!0},p(t,i){let c=e;e=a(t),e===c?~e&&r[e].p(t,i):(n&&(lt(),pt(r[c],1,1,(()=>{r[c]=null})),dt()),~e?(n=r[e],n?n.p(t,i):(n=r[e]=o[e](t),n.c()),ut(n,1),n.m(s.parentNode,s)):n=null)},i(t){i||(ut(n),i=!0)},o(t){pt(n),i=!1},d(t){~e&&r[e].d(t),t&&S(s)}}}function za(t){let e,n,s=t[1],i=[];for(let e=0;e<s.length;e+=1)i[e]=Oa(Pa(t,s,e));const o=t=>pt(i[t],1,1,(()=>{i[t]=null}));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=M()},m(t,s){for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,s);_(t,e,s),n=!0},p(t,n){if(3&n){let r;for(s=t[1],r=0;r<s.length;r+=1){const o=Pa(t,s,r);i[r]?(i[r].p(o,n),ut(i[r],1)):(i[r]=Oa(o),i[r].c(),ut(i[r],1),i[r].m(e.parentNode,e))}for(lt(),r=s.length;r<i.length;r+=1)o(r);dt()}},i(t){if(!n){for(let t=0;t<s.length;t+=1)ut(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)pt(i[t]);n=!1},d(t){j(i,t),t&&S(e)}}}function qa(t){let e,n;return e=new Wr({props:{api:t[0],$$slots:{default:[za]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.api=t[0]),35&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Ba(t){let e,n;return e=new Oe({props:{$$slots:{default:[qa]},$$scope:{ctx:t}}}),{c(){$t(e.$$.fragment)},m(t,s){kt(e,t,s),n=!0},p(t,[n]){const s={};35&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Ya(t,e,n){let{api:s}=e,{items:i}=e;return t.$$set=t=>{"api"in t&&n(0,s=t.api),"items"in t&&n(1,i=t.items)},[s,i]}class Ja extends bt{constructor(t){super(),xt(this,t,Ya,Ba,d,{api:0,items:1})}}class Wa{constructor(t,e){this.container="string"==typeof t?document.querySelector(t):t,this.config=e,this._init()}destructor(){this._toolbar.$destroy(),this._toolbar=this.api=this.events=null}setConfig(t){t&&(this.config=Object.assign(Object.assign({},this.config),t),this._init())}setLocale(t,e){t&&this.setConfig({locale:t,api:e})}_init(){var t;this._toolbar&&this.destructor();const e=new Map([["wx-i18n",s(null===(t=this.config)||void 0===t?void 0:t.locale)]]);this._toolbar=new Ja({target:this.container,props:this._configToProps(this.config),context:e}),this.events=new ja(this.api)}_configToProps(t){let e=[{type:"combo"},{type:"search"},{type:"menu"}];return(null==t?void 0:t.items)&&(e=this._normalizeItems(t.items)),Object.assign(Object.assign({},t),{items:e})}_normalizeItems(t){return t.map((t=>"string"==typeof t?{type:t}:"function"==typeof t?{type:"template",template:t}:t))}}const Ga=Symbol();class Va{constructor(){this._awaitAddingQueue=[],this._queue={},this._idPool={},this._batchPull={},this._backId=[],this.add=this.add.bind(this)}resolve(t,e){const n=this._backId[e];if(void 0===n)return t;const s=n[t];return void 0===s?t:s}add(t,e,n){if(n.debounce){const s=e.batchID;delete e.batchID;const i=`${t}"/"${s||e.id}`;s&&(this._batchPull[s]||(this._batchPull[s]=[]),this._batchPull[s].push(e));const o=this._queue[i];return o&&clearTimeout(o),void(this._queue[i]=setTimeout((()=>{const i=this._batchPull[s];i&&i.length>1&&(e={opbatch:i}),this.add(t,e,{...n,debounce:!1})}),n.debounce))}const s=this.tryExec(t,e,n);null===s?this._awaitAddingQueue.push({action:t,data:e,proc:n}):s.then((t=>{t&&t.id&&t.id!=e.id&&this.isTempID(e.id)&&(this._idPool[e.id]=t.id,this.execQueue())}))}tryExec(t,e,n){const s=this.exec(t,e,n);return null===s?this._awaitAddingQueue.push({action:t,data:e,proc:n}):s.then((t=>{if(t&&t.id&&t.id!=e.id&&this.isTempID(e.id)){if(this._idPool[e.id]=t.id,n.kind){let s=this._backId[n.kind];s||(s=this._backId[n.kind]={}),s[t.id]=e.id}this.execQueue()}})),s}exec(t,e,n){const s=this.correctID(e,n.ignoreID?e.id:null,n.skipCorrect);return s===Ga?null:n.handler(s,t,e)}isTempID(t){return"string"==typeof t&&20===t.length&&parseInt(t.substr(7))>1e12}correctID(t,e,n){let s=null;for(const i in t){if(n&&n.includes(i))continue;const o=t[i];if("object"==typeof o){const r=this.correctID(o,e,n);if(r!==o){if(r===Ga)return Ga;null===s&&(s=Array.isArray(t)?[...t]:{...t}),s[i]=r}}else if(this.isTempID(o)){const n=this._idPool[o];if(o!==e&&!n)return Ga;null===s&&(s=Array.isArray(t)?[...t]:{...t}),s[i]=n}}return s||t}execQueue(){this._awaitAddingQueue=this._awaitAddingQueue.map((t=>this.tryExec(t.action,t.data,t.proc)?null:t)).filter((t=>null!==t))}setID(t,e,n){if(this._idPool[t]=e,n){let s=this._backId[n];s||(s=this._backId[n]={}),s[e]=t}}}class Ua extends Ve{constructor(t,e){super(),this._url=t,this._api=e,this._queue=new Va;const n={"add-task":{ignoreID:!0,kind:1,handler:t=>this.send("tasks","POST",t)},"update-task":{handler:t=>(t.task.batch=this.toArray(t?.batch),this.send(`tasks/${t.id}`,"PUT",t.task))},"delete-task":{handler:t=>t?.batch?this.send("tasks","DELETE",{batch:t.batch}):this.send(`tasks/${t.id}`,"DELETE")},"add-project":{kind:2,ignoreID:!0,handler:t=>this.send("projects","POST",t.project)},"update-project":{handler:t=>this.send(`projects/${t.id}`,"PUT",t.project)},"delete-project":{handler:t=>this.send(`projects/${t.id}`,"DELETE")},"set-project":{handler:t=>{let e="";return null===t.id&&(e="?timeout=true"),this.send(`tasks/projects/${t.id}${e}`,"GET").then((e=>{const n=this._api.getState().activeProject;return n!==t.id&&e.forEach((t=>{t.project=n})),this._api.parse({tasks:e}),Promise.resolve()}))}},"move-task":{debounce:300,handler:t=>this.send(`move/${t.id}`,"PUT",{...t,id:t.batch?0:t.id})},"clone-task":{skipCorrect:["batch"],handler:t=>this.send("clone","POST",t).then((e=>{const n=e;for(let e=0;e<t.batch.length;e++){const s=t.batch[e].id,i=n[e];this._queue.setID(s,i,1)}}))},"set-sort":{handler:t=>{const e=this._api.getState().activeProject;return this.send(`sort/${e}`,"PUT",t)}}},s=this.getHandlers(n);for(const t in s)this.on(t,(e=>{e.skipProvider||this._queue.add(t,e,s[t])}))}getTasks(){return this.send("tasks","GET")}getProjectTasks(t){return this.send("tasks/projects/"+t,"GET")}getUsers(){return this.send("users","GET")}getProjects(){return this.send("projects","GET")}getTags(){return this.send("tags","GET")}setAPI(t){this._api=t}setHeaders(t){this._customHeaders=t}getIDResolver(){return this._queue.resolve.bind(this._queue)}getHandlers(t){return t}send(t,e,n,s={}){const i={method:e,headers:{"Content-Type":"application/json",...s,...this._customHeaders}};return n&&(i.body="object"==typeof n?JSON.stringify(n):n),fetch(`${this._url}/${t}`,i).then((async t=>{if(500==t.status){const e=await t.text();return Promise.reject(e)}return await t.json()}))}toArray(t){return t?Array.isArray(t)?t:Object.values(t):[]}}class Xa{constructor(t){const{url:e,token:n}=t;this._url=e,this._token=n,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:"application/json","Content-Type":"application/json","Remote-Token":this._token}}fetch(t,e){const n={credentials:"include",headers:this.headers()};return e&&(n.method="POST",n.body=e),fetch(t,n).then((t=>t.json()))}load(t){return t&&(this._url=t),this.fetch(this._url).then((t=>this.parse(t)))}parse(t){const{key:e,websocket:n}=t;e&&(this._token=t.key);for(const e in t.data)this.data[e]=t.data[e];for(const e in t.api){const n=this.api[e]={},s=t.api[e];for(const t in s)n[t]=this._wrapper(e+"."+t)}return n&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(t,e,n,s){let i=e;"/"===i[0]&&(i=document.location.protocol+"//"+document.location.host+e),i=i.replace(/^http(s|):/,"ws$1:");const o=-1!=i.indexOf("?")?"&":"?";i=`${i}${o}token=${n}&ws=1`;const r=new WebSocket(i);return r.onclose=()=>setTimeout((()=>t.connect()),2e3),r.onmessage=e=>{const n=JSON.parse(e.data);switch(n.action){case"result":t.result(n.body,[]);break;case"event":t.fire(n.body.name,n.body.value);break;case"start":s();break;default:t.onError(n.data)}},r}(this,this._url,this._token,(()=>(this._mode=3,this._send(),this._resubscribe(),this)))}_wrapper(t){return function(){const e=[].slice.call(arguments);let n=null;const s=new Promise(((s,i)=>{n={data:{id:this._uid(),name:t,args:e},status:1,resolve:s,reject:i},this._queue.push(n)}));return this.onCall(n,s),3===this._mode?this._send(n):setTimeout((()=>this._send()),1),s}.bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(2==this._mode)return void setTimeout((()=>this._send()),100);const e=t?[t]:this._queue.filter((t=>1===t.status));if(!e.length)return;const n=e.map((t=>(t.status=2,t.data)));3!==this._mode?this.fetch(this._url,JSON.stringify(n)).catch((t=>this.onError(t))).then((t=>this.result(t,n))):this._socket.send(JSON.stringify({action:"call",body:n}))}result(t,e){const n={};if(t)for(let e=0;e<t.length;e++)n[t[e].id]=t[e];else for(let t=0;t<e.length;t++)n[e[t].id]={id:e[t].id,error:"Network Error",data:null};for(let t=this._queue.length-1;t>=0;t--){const e=this._queue[t],s=n[e.data.id];s&&(this.onResponse(e,s),s.error?e.reject(s.error):e.resolve(s.data),this._queue.splice(t,1))}}on(t,e){const n=this._uid();let s=this._events[t];const i=!!s;return i||(s=this._events[t]=[]),s.push({id:n,handler:e}),i||3!=this._mode||this._socket.send(JSON.stringify({action:"subscribe",name:t})),{name:t,id:n}}_resubscribe(){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:"subscribe",name:t}))}detach(t){if(!t){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:"unsubscribe",key:t}));return void(this._events={})}const{id:e,name:n}=t,s=this._events[n];if(s){const t=s.filter((t=>t.id!=e));t.length?this._events[n]=t:(delete this._events[n],3==this._mode&&this._socket.send(JSON.stringify({action:"unsubscribe",name:n})))}}fire(t,e){const n=this._events[t];if(n)for(let t=0;t<n.length;t++)n[t].handler(e)}onError(t){return null}onCall(t,e){}onResponse(t,e){}}class Za{constructor(t,e){const n=new Xa({url:t,token:e});n.fetch=function(t,e){const n={headers:this.headers()};return e&&(n.method="POST",n.body=e),fetch(t,n).then((t=>t.json()))},this._ready=n.load().then((t=>this._remote=t))}ready(){return this._ready}on(t,e){this.ready().then((n=>{if("string"==typeof t)n.on(t,e);else for(const e in t)n.on(e,t[e])}))}}function Qa(t,e){function n(t){if(!t)return null;for(const s in t)if("object"!=typeof t[s])switch(s){case"id":case"targetId":case"parent":t[s]=e(t[s],1)||null;break;case"project":t[s]=e(t[s],2)||null}else n(t[s]);return t}return{tasks:function(s){n(s);const{id:i}=s,{reverse:o,parent:r,project:a,targetId:c}=s.data||{};switch(s.type){case"add-task":t.exec("add-task",{id:i,project:void 0===a?null:a,parent:r,targetId:c,reverse:o,task:{...s.data.task},skipProvider:!0,$meta:{skipHistory:!0}});break;case"update-task":t.exec("update-task",{id:i,task:{...s.data},skipProvider:!0,$meta:{skipHistory:!0}}),s?.data?.batch?.forEach((e=>{t.exec("update-task",{id:e.id,task:e,skipProvider:!0,$meta:{skipHistory:!0}})}));break;case"delete-task":s.data?.batch?s.data.batch.forEach((e=>{t.exec("delete-task",{id:e,skipProvider:!0,$meta:{skipHistory:!0}})})):t.exec("delete-task",{id:i,skipProvider:!0,$meta:{skipHistory:!0}});break;case"move-task":if(s.data?.opbatch?.length)s.data.opbatch?.forEach((e=>{t.exec("move-task",{...e,skipProvider:!0,$meta:{skipHistory:!0}})}));else if(s?.data?.batch?.length)s.data.batch?.forEach((n=>{n=e(n,1),t.exec("move-task",{id:n,project:a,parent:r,targetId:c,reverse:o,skipProvider:!0,$meta:{skipHistory:!0}})}));else{const{id:e}=s.data;t.exec("move-task",{id:e,project:a,parent:r,targetId:c,reverse:o,skipProvider:!0,$meta:{skipHistory:!0}})}break;case"clone-task":for(let e=0;e<s?.data?.batch?.length;e++){const n=s.data.batch[e];0===e?t.exec("add-task",{id:n.id,project:a,parent:r,targetId:c,task:n,reverse:o,skipProvider:!0,$meta:{skipHistory:!0}}):t.exec("add-task",{id:n.id,project:a,parent:n.parent,targetId:s.data.batch[e-1]?.id,task:n,skipProvider:!0,$meta:{skipHistory:!0}})}}},projects:function(n){const s=e(n.data.id,2);switch(n.type){case"add-project":t.exec("add-project",{id:s,project:{label:n.data.label},skipProvider:!0,$meta:{skipHistory:!0}});break;case"update-project":t.exec("update-project",{id:s,project:{label:n.data.label},skipProvider:!0,$meta:{skipHistory:!0}});break;case"delete-project":t.exec("delete-project",{id:s,skipProvider:!0,$meta:{skipHistory:!0}});break;case"set-sort":if(n.data.project=e(n.data.project,2),t.getState().activeProject===n.data.project){const{by:e,dir:s}=n.data;t.exec("set-sort",{by:e,dir:s,tree:!0,skipProvider:!0,$meta:{skipHistory:!0}})}}}}}export{Za as RemoteEvents,Ua as RestDataProvider,Ta as ToDo,Wa as Toolbar,Zn as getMenuOptions,Qa as todoUpdates,Ye as uid};
